<!DOCTYPE html><!--05bjYGyiAumoEMBrfWHih--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4bd7a24b7976d4e6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js"/><script src="/_next/static/chunks/4bd1b696-deba172d32c79f82.js" async=""></script><script src="/_next/static/chunks/794-275dc9ebd3a29fbf.js" async=""></script><script src="/_next/static/chunks/main-app-1fa5b694e5d36a75.js" async=""></script><script src="/_next/static/chunks/app/layout-7e9963bf811be36b.js" async=""></script><script src="/_next/static/chunks/758-3cb69ce377cde046.js" async=""></script><script src="/_next/static/chunks/121-aece4f809b101dc1.js" async=""></script><script src="/_next/static/chunks/830-dbae36b1030f3d7c.js" async=""></script><script src="/_next/static/chunks/689-4fcf9680fdc90283.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-a68506d98e2282cb.js" async=""></script><meta name="next-size-adjust" content=""/><title>InputLayer - A symbolic reasoning engine for AI agents</title><meta name="description" content="Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."/><link rel="icon" href="/icon.svg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="flex flex-col min-h-dvh"><header class="sticky top-0 z-50 w-full border-b border-border/50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="flex h-14 items-center px-6"><a class="mr-8" href="/"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-lg">InputLayer</span></span></a><nav class="hidden md:flex items-center gap-6 text-sm"><a class="text-muted-foreground transition-colors hover:text-foreground" href="/docs/">Docs</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/blog/">Blog</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/use-cases/">Use Cases</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/compare/">Compare</a><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></nav><div class="ml-auto flex items-center gap-3"><div class="inline-flex items-center gap-1.5"><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-3.5 w-3.5"><path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path></svg><span>Star</span></a><a href="https://github.com/inputlayer/inputlayer/fork" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-fork h-3.5 w-3.5"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg><span>Fork</span></a></div><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9 h-9 w-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-4 w-4"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></button><div class="md:hidden"><button class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></header><main class="flex-1"><section class="border-b border-border/50"><div class="relative overflow-hidden"><div class="absolute inset-0 bg-gradient-to-b from-primary/5 to-transparent"></div><div class="relative mx-auto max-w-6xl px-6 py-16 lg:py-20"><nav class="mb-4 flex items-center gap-2 text-sm text-muted-foreground"><span class="flex items-center gap-2"><a class="hover:text-foreground transition-colors" href="/blog/">Blog</a></span></nav><h1 class="text-3xl font-extrabold tracking-tight sm:text-4xl lg:text-5xl max-w-3xl">Policy-Filtered Semantic Search: Access Control Meets Vector Similarity</h1><p class="mt-4 text-lg text-muted-foreground max-w-2xl">February 10, 2026 Â· InputLayer Team</p></div></div></section><article class="mx-auto max-w-3xl px-6 py-12"><div class="docs-prose"><h1 id="policy-filtered-semantic-search-access-control-meets-vector-similarity" node="[object Object]">Policy-Filtered Semantic Search: Access Control Meets Vector Similarity</h1>
<p>Every enterprise RAG application eventually runs into the same problem. The semantic search works great - it finds relevant documents. But then you need to check whether the user is actually allowed to see those documents. And suddenly you&#x27;re maintaining two systems, writing glue code between them, and dealing with consistency bugs that only show up in production.</p>
<p>This post is about what happens when you stop treating authorization and retrieval as separate concerns and combine them into a single operation.</p>
<h2 id="how-it-usually-works-and-where-it-breaks" node="[object Object]">How it usually works (and where it breaks)</h2>
<p>The typical architecture looks like this:</p>
<div class="my-8 flex flex-col items-center gap-0"><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">User sends a query</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">calls auth service</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">Auth service returns permissions (e.g. department: &quot;engineering&quot;, level: &quot;L5+&quot;)</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">passes filters to vector database</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">Vector database runs query with metadata filters</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">returns results</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-emerald-50 dark:bg-emerald-950/30 border-emerald-300 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200">Filtered results</div></div>
<p>The application calls an auth service to figure out the user&#x27;s permissions, translates those permissions into metadata filters, and passes those filters to the vector database along with the query. It works. For simple permission models - &quot;engineering can see engineering docs&quot; - it works fine.</p>
<p>But here&#x27;s where it falls apart. Most real organizations don&#x27;t have flat permission models. They have hierarchies. And hierarchies are recursive.</p>
<h2 id="the-recursion-problem" node="[object Object]">The recursion problem</h2>
<p>Consider Sarah, a VP of Engineering at a 500-person company. Her reporting chain looks like this:</p>
<div class="my-8 space-y-2"><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-primary/10 border-primary/60">Sarah (VP Engineering)</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Marcus (Dir. Platform)</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Team Alpha (8 people)</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Team Beta (6 people)</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Priya (Dir. AI/ML)</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Team Gamma (10 people)</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Team Delta (5 people)</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">James (Dir. DevOps)</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Team Epsilon (7 people)</div></div></div></div></div></div></div></div></div>
<p>Sarah should be able to see documents from everyone in her org - all 36 people across 5 teams. Marcus should see documents from Alpha and Beta (14 people). A team lead in Alpha should see only Alpha&#x27;s documents (8 people).</p>
<p>How do you express &quot;Sarah can see documents from everyone beneath her in the org chart&quot; as a metadata filter? You can&#x27;t hardcode the list of 36 people - that becomes stale the moment someone joins, leaves, or transfers. You can&#x27;t say <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">department = &quot;engineering&quot;</code> because that doesn&#x27;t respect the sub-hierarchies (Marcus shouldn&#x27;t see Priya&#x27;s team&#x27;s confidential documents unless the policy says so).</p>
<p>What you actually need is a recursive walk of the reporting structure, starting from Sarah and going down through every layer. And that walk needs to happen at query time, against the current state of the org chart, every single time.</p>
<p>That&#x27;s not something a metadata filter can do.</p>
<h2 id="combining-authorization-and-search-in-one-pass" node="[object Object]">Combining authorization and search in one pass</h2>
<p>In InputLayer, you describe your org structure as facts (who reports to whom) and your access policy as a rule (managers can see documents from their entire reporting chain). The engine handles both the authorization logic and the semantic search in a single query.</p>
<p>Here&#x27;s what happens when Sarah searches for &quot;deployment best practices&quot;:</p>
<div class="my-8"><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-primary/20 text-primary ring-primary/40">1</div><div class="w-px flex-1 min-h-5 bg-border/60"></div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">Resolve authorization (recursive): start from Sarah, walk her full reporting chain</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">Sarah can see docs from 36 people</p></div></div><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-muted text-muted-foreground ring-border">2</div><div class="w-px flex-1 min-h-5 bg-border/60"></div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">Find documents: filter to documents authored by those 36 people</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">847 documents in scope</p></div></div><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300 ring-emerald-300 dark:ring-emerald-700">3</div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">Rank by similarity: compare each document&#x27;s embedding to the query</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">Top 10 results, all authorized, ranked by relevance</p></div></div></div>
<div class="my-8 rounded-r-lg border border-l-4 px-5 py-4 border-l-primary bg-primary/5"><p class="text-sm leading-relaxed whitespace-pre-line">All three steps happen in one pass. No separate auth service call, no metadata filter translation, no consistency gap.</p></div>
<p>The authorization is evaluated against the current state of the org chart, right now, as part of the query.</p>
<h2 id="the-consistency-problem-most-teams-dont-notice" node="[object Object]">The consistency problem most teams don&#x27;t notice</h2>
<p>Here&#x27;s a subtle bug that exists in nearly every two-system auth+search setup.</p>
<p>Monday: Bob reports to Sarah. Sarah can see Bob&#x27;s documents. The auth service knows this, the metadata filters reflect it.</p>
<p>Tuesday morning: Bob transfers from Engineering to Product. The auth service updates immediately. But the metadata on Bob&#x27;s documents in the vector database? That gets updated in a batch job that runs at midnight.</p>
<p>Tuesday afternoon: Sarah searches for something. The auth service says she can&#x27;t see Bob&#x27;s docs anymore (correct). But what about documents authored by someone who reported to Bob, whose metadata filter was set to <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">org: &quot;engineering&quot;</code> and hasn&#x27;t been updated yet? That depends on how your metadata propagation works. And these edge cases multiply with every layer of hierarchy and every type of permission grant.</p>
<div class="my-8 flex flex-col items-center gap-0"><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">Bob transfers at 9am</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">15-hour consistency gap begins</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-red-50 dark:bg-red-950/30 border-red-300 dark:border-red-800 text-red-800 dark:text-red-200 font-medium">Auth says NO, but vector database says YES</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">batch job runs at midnight</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-emerald-50 dark:bg-emerald-950/30 border-emerald-300 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200">Gap finally closes the next day</div></div>
<p>With InputLayer, this gap doesn&#x27;t exist. Authorization is computed from the current facts at query time. Update the reporting structure at 9am, and the 9:01am query reflects the change. No propagation delay, no batch job, no stale permissions.</p>
<h2 id="it-also-works-in-reverse-retraction" node="[object Object]">It also works in reverse: retraction</h2>
<p>When Bob leaves the company entirely, you retract the fact that Bob reports to Sarah.</p>
<p>InputLayer automatically retracts everything that was derived through that relationship. Sarah loses access to Bob&#x27;s documents. She also loses access to documents from anyone who reported through Bob - if Bob managed a team, that entire branch of Sarah&#x27;s permission tree disappears.</p>
<p>But here&#x27;s the important part: if any of those people also report to Sarah through a different path (say, a dotted-line relationship), those permissions survive. The engine tracks how many independent paths support each access grant and only retracts when all paths are gone.</p>
<p>In an append-only system, Bob&#x27;s documents just sit there in the index until someone manually cleans them up. In InputLayer, the cleanup is automatic and precise.</p>
<h2 id="performance-can-you-actually-do-this-at-query-time" node="[object Object]">Performance: can you actually do this at query time?</h2>
<p>Evaluating a recursive org chart walk on every search request sounds expensive. In practice, it&#x27;s not.</p>
<p>InputLayer&#x27;s incremental computation engine means the recursive authorization isn&#x27;t recomputed from scratch on every query. The first time Sarah queries, the engine walks her reporting chain. After that, it maintains the result incrementally. When the org chart changes, only the affected portion recomputes.</p>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Operation</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Time</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]">Initial authority computation (2,000-node org)</td><td class="border px-4 py-2" node="[object Object]">~200ms</td></tr><tr><td class="border px-4 py-2" node="[object Object]">Incremental update after one org change</td><td class="border px-4 py-2" node="[object Object]">&lt;7ms</td></tr><tr><td class="border px-4 py-2" node="[object Object]">Subsequent queries (cached derivations)</td><td class="border px-4 py-2" node="[object Object]">&lt;1ms for auth + vector search time</td></tr></tbody></table></div>
<p>InputLayer also evaluates demand-driven. When Sarah queries, it doesn&#x27;t compute the authorization chain for every person in the organization. It starts from Sarah and follows only her reporting paths. Query time scales with the size of Sarah&#x27;s org, not the total company size.</p>
<p>For a VP with 100 reports (direct and transitive), the authorization adds negligible overhead to the vector search. For a CEO of a 10,000-person company - the most extreme case - it&#x27;s still in the low tens of milliseconds.</p>
<h2 id="getting-started" node="[object Object]">Getting started</h2>
<p>If you&#x27;re dealing with authorization that&#x27;s more complex than flat metadata filters - and most enterprise applications are - this pattern is worth exploring.</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-bash text-sm"><span class="syn-builtin">docker</span> run <span class="syn-meta">-p</span> 8080:8080 ghcr.io/inputlayer/inputlayer</code></pre>
<p>The <a node="[object Object]" href="/docs/guides/quickstart/">quickstart guide</a> gets you running in about 5 minutes. The <a node="[object Object]" href="/docs/guides/recursion/">recursion documentation</a> explains how recursive rules work, which is the foundation for hierarchical authorization.</p></div></article><section class="border-t border-border/50"><div class="mx-auto max-w-6xl px-6 py-16"><div class="relative rounded-2xl border border-border bg-gradient-to-br from-primary/10 via-transparent to-primary/5 p-12 text-center space-y-6"><h2 class="text-3xl font-bold tracking-tight">Ready to get started?</h2><p class="text-muted-foreground text-lg max-w-xl mx-auto">InputLayer is open-source. Pull the Docker image and start building.</p><div class="flex flex-wrap justify-center gap-3 pt-2"><a class="inline-flex items-center gap-2 rounded-md bg-primary px-6 py-3 text-sm font-medium text-primary-foreground hover:bg-primary/90 transition-colors" href="/docs/">Read the docs<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right h-4 w-4"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg></a><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded-md border border-border bg-background px-6 py-3 text-sm font-medium hover:bg-secondary transition-colors">View on GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3.5 w-3.5"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></div></div></div></section></main><footer class="border-t border-border/50 bg-card/50"><div class="mx-auto max-w-6xl px-6 py-12"><div class="grid grid-cols-2 gap-8 md:grid-cols-4 lg:gap-12"><div><h3 class="text-sm font-semibold text-foreground mb-3">Product</h3><ul class="space-y-2"><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/#features">Features</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/use-cases/">Use Cases</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/compare/">Compare</a></li><li><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Resources</h3><ul class="space-y-2"><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/">Documentation</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/blog/">Blog</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/guides/quickstart/">Quickstart</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/guides/python-sdk/">Python SDK</a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Company</h3><ul class="space-y-2"><li><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li><li><a href="https://github.com/inputlayer/inputlayer/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">License<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Community</h3><ul class="space-y-2"><li><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Star on GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li><li><a href="https://github.com/inputlayer/inputlayer/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Contributing<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div></div><div class="mt-10 flex flex-col sm:flex-row items-center justify-between gap-4 border-t border-border/50 pt-8"><div class="flex items-center gap-4"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-base">InputLayer</span></span><span class="text-sm text-muted-foreground">AGPL-3.0 License</span></div><p class="text-xs text-muted-foreground">A symbolic reasoning engine for AI agents.</p></div></div></footer></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1942,[\"177\",\"static/chunks/app/layout-7e9963bf811be36b.js\"],\"ThemeProvider\"]\n3:I[7121,[],\"\"]\n4:I[4581,[],\"\"]\n6:I[484,[],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[484,[],\"ViewportBoundary\"]\nb:I[484,[],\"MetadataBoundary\"]\nd:I[7123,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4bd7a24b7976d4e6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"05bjYGyiAumoEMBrfWHih\",\"c\":[\"\",\"blog\",\"policy-filtered-semantic-search\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"policy-filtered-semantic-search\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4bd7a24b7976d4e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 font-sans antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[1268,[\"758\",\"static/chunks/758-3cb69ce377cde046.js\",\"121\",\"static/chunks/121-aece4f809b101dc1.js\",\"830\",\"static/chunks/830-dbae36b1030f3d7c.js\",\"689\",\"static/chunks/689-4fcf9680fdc90283.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-a68506d98e2282cb.js\"],\"BlogPostClient\"]\nf:T1d6b,"])</script><script>self.__next_f.push([1,"\n# Policy-Filtered Semantic Search: Access Control Meets Vector Similarity\n\nEvery enterprise RAG application eventually runs into the same problem. The semantic search works great - it finds relevant documents. But then you need to check whether the user is actually allowed to see those documents. And suddenly you're maintaining two systems, writing glue code between them, and dealing with consistency bugs that only show up in production.\n\nThis post is about what happens when you stop treating authorization and retrieval as separate concerns and combine them into a single operation.\n\n## How it usually works (and where it breaks)\n\nThe typical architecture looks like this:\n\n```chain\nUser sends a query\n-- calls auth service\nAuth service returns permissions (e.g. department: \"engineering\", level: \"L5+\")\n-- passes filters to vector database\nVector database runs query with metadata filters\n-- returns results\nFiltered results [success]\n```\n\nThe application calls an auth service to figure out the user's permissions, translates those permissions into metadata filters, and passes those filters to the vector database along with the query. It works. For simple permission models - \"engineering can see engineering docs\" - it works fine.\n\nBut here's where it falls apart. Most real organizations don't have flat permission models. They have hierarchies. And hierarchies are recursive.\n\n## The recursion problem\n\nConsider Sarah, a VP of Engineering at a 500-person company. Her reporting chain looks like this:\n\n```tree\nSarah (VP Engineering) [primary]\n  Marcus (Dir. Platform)\n    Team Alpha (8 people)\n    Team Beta (6 people)\n  Priya (Dir. AI/ML)\n    Team Gamma (10 people)\n    Team Delta (5 people)\n  James (Dir. DevOps)\n    Team Epsilon (7 people)\n```\n\nSarah should be able to see documents from everyone in her org - all 36 people across 5 teams. Marcus should see documents from Alpha and Beta (14 people). A team lead in Alpha should see only Alpha's documents (8 people).\n\nHow do you express \"Sarah can see documents from everyone beneath her in the org chart\" as a metadata filter? You can't hardcode the list of 36 people - that becomes stale the moment someone joins, leaves, or transfers. You can't say `department = \"engineering\"` because that doesn't respect the sub-hierarchies (Marcus shouldn't see Priya's team's confidential documents unless the policy says so).\n\nWhat you actually need is a recursive walk of the reporting structure, starting from Sarah and going down through every layer. And that walk needs to happen at query time, against the current state of the org chart, every single time.\n\nThat's not something a metadata filter can do.\n\n## Combining authorization and search in one pass\n\nIn InputLayer, you describe your org structure as facts (who reports to whom) and your access policy as a rule (managers can see documents from their entire reporting chain). The engine handles both the authorization logic and the semantic search in a single query.\n\nHere's what happens when Sarah searches for \"deployment best practices\":\n\n```steps\nResolve authorization (recursive): start from Sarah, walk her full reporting chain :: Sarah can see docs from 36 people [primary]\nFind documents: filter to documents authored by those 36 people :: 847 documents in scope\nRank by similarity: compare each document's embedding to the query :: Top 10 results, all authorized, ranked by relevance [success]\n```\n\n```note\ntype: tip\nAll three steps happen in one pass. No separate auth service call, no metadata filter translation, no consistency gap.\n```\n\nThe authorization is evaluated against the current state of the org chart, right now, as part of the query.\n\n## The consistency problem most teams don't notice\n\nHere's a subtle bug that exists in nearly every two-system auth+search setup.\n\nMonday: Bob reports to Sarah. Sarah can see Bob's documents. The auth service knows this, the metadata filters reflect it.\n\nTuesday morning: Bob transfers from Engineering to Product. The auth service updates immediately. But the metadata on Bob's documents in the vector database? That gets updated in a batch job that runs at midnight.\n\nTuesday afternoon: Sarah searches for something. The auth service says she can't see Bob's docs anymore (correct). But what about documents authored by someone who reported to Bob, whose metadata filter was set to `org: \"engineering\"` and hasn't been updated yet? That depends on how your metadata propagation works. And these edge cases multiply with every layer of hierarchy and every type of permission grant.\n\n```chain\nBob transfers at 9am\n-- 15-hour consistency gap begins\nAuth says NO, but vector database says YES [highlight]\n-- batch job runs at midnight\nGap finally closes the next day [success]\n```\n\nWith InputLayer, this gap doesn't exist. Authorization is computed from the current facts at query time. Update the reporting structure at 9am, and the 9:01am query reflects the change. No propagation delay, no batch job, no stale permissions.\n\n## It also works in reverse: retraction\n\nWhen Bob leaves the company entirely, you retract the fact that Bob reports to Sarah.\n\nInputLayer automatically retracts everything that was derived through that relationship. Sarah loses access to Bob's documents. She also loses access to documents from anyone who reported through Bob - if Bob managed a team, that entire branch of Sarah's permission tree disappears.\n\nBut here's the important part: if any of those people also report to Sarah through a different path (say, a dotted-line relationship), those permissions survive. The engine tracks how many independent paths support each access grant and only retracts when all paths are gone.\n\nIn an append-only system, Bob's documents just sit there in the index until someone manually cleans them up. In InputLayer, the cleanup is automatic and precise.\n\n## Performance: can you actually do this at query time?\n\nEvaluating a recursive org chart walk on every search request sounds expensive. In practice, it's not.\n\nInputLayer's incremental computation engine means the recursive authorization isn't recomputed from scratch on every query. The first time Sarah queries, the engine walks her reporting chain. After that, it maintains the result incrementally. When the org chart changes, only the affected portion recomputes.\n\n| Operation | Time |\n|---|---|\n| Initial authority computation (2,000-node org) | ~200ms |\n| Incremental update after one org change | \u003c7ms |\n| Subsequent queries (cached derivations) | \u003c1ms for auth + vector search time |\n\nInputLayer also evaluates demand-driven. When Sarah queries, it doesn't compute the authorization chain for every person in the organization. It starts from Sarah and follows only her reporting paths. Query time scales with the size of Sarah's org, not the total company size.\n\nFor a VP with 100 reports (direct and transitive), the authorization adds negligible overhead to the vector search. For a CEO of a 10,000-person company - the most extreme case - it's still in the low tens of milliseconds.\n\n## Getting started\n\nIf you're dealing with authorization that's more complex than flat metadata filters - and most enterprise applications are - this pattern is worth exploring.\n\n```bash\ndocker run -p 8080:8080 ghcr.io/inputlayer/inputlayer\n```\n\nThe [quickstart guide](/docs/guides/quickstart/) gets you running in about 5 minutes. The [recursion documentation](/docs/guides/recursion/) explains how recursive rules work, which is the foundation for hierarchical authorization."])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Le\",null,{\"post\":{\"slug\":\"policy-filtered-semantic-search\",\"title\":\"Policy-Filtered Semantic Search: Access Control Meets Vector Similarity\",\"date\":\"2026-02-10\",\"author\":\"InputLayer Team\",\"category\":\"Architecture\",\"excerpt\":\"Most systems handle access control and semantic search as separate concerns. Here's what happens when you combine them into a single query.\",\"content\":\"$f\",\"toc\":[{\"level\":2,\"text\":\"How it usually works (and where it breaks)\",\"id\":\"how-it-usually-works-and-where-it-breaks\"},{\"level\":2,\"text\":\"The recursion problem\",\"id\":\"the-recursion-problem\"},{\"level\":2,\"text\":\"Combining authorization and search in one pass\",\"id\":\"combining-authorization-and-search-in-one-pass\"},{\"level\":2,\"text\":\"The consistency problem most teams don't notice\",\"id\":\"the-consistency-problem-most-teams-dont-notice\"},{\"level\":2,\"text\":\"It also works in reverse: retraction\",\"id\":\"it-also-works-in-reverse-retraction\"},{\"level\":2,\"text\":\"Performance: can you actually do this at query time?\",\"id\":\"performance-can-you-actually-do-this-at-query-time\"},{\"level\":2,\"text\":\"Getting started\",\"id\":\"getting-started\"}]},\"slug\":\"policy-filtered-semantic-search\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[6869,[],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"InputLayer - A symbolic reasoning engine for AI agents\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.svg\"}],[\"$\",\"$L10\",\"3\",{}]]\n8:null\n"])</script></body></html>