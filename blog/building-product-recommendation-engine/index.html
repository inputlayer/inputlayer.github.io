<!DOCTYPE html><!--05bjYGyiAumoEMBrfWHih--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4bd7a24b7976d4e6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js"/><script src="/_next/static/chunks/4bd1b696-deba172d32c79f82.js" async=""></script><script src="/_next/static/chunks/794-275dc9ebd3a29fbf.js" async=""></script><script src="/_next/static/chunks/main-app-1fa5b694e5d36a75.js" async=""></script><script src="/_next/static/chunks/app/layout-7e9963bf811be36b.js" async=""></script><script src="/_next/static/chunks/758-3cb69ce377cde046.js" async=""></script><script src="/_next/static/chunks/121-aece4f809b101dc1.js" async=""></script><script src="/_next/static/chunks/830-dbae36b1030f3d7c.js" async=""></script><script src="/_next/static/chunks/689-4fcf9680fdc90283.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-a68506d98e2282cb.js" async=""></script><meta name="next-size-adjust" content=""/><title>InputLayer - A symbolic reasoning engine for AI agents</title><meta name="description" content="Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."/><link rel="icon" href="/icon.svg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="flex flex-col min-h-dvh"><header class="sticky top-0 z-50 w-full border-b border-border/50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="flex h-14 items-center px-6"><a class="mr-8" href="/"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-lg">InputLayer</span></span></a><nav class="hidden md:flex items-center gap-6 text-sm"><a class="text-muted-foreground transition-colors hover:text-foreground" href="/docs/">Docs</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/blog/">Blog</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/use-cases/">Use Cases</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/compare/">Compare</a><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></nav><div class="ml-auto flex items-center gap-3"><div class="inline-flex items-center gap-1.5"><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-3.5 w-3.5"><path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path></svg><span>Star</span></a><a href="https://github.com/inputlayer/inputlayer/fork" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-fork h-3.5 w-3.5"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg><span>Fork</span></a></div><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9 h-9 w-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-4 w-4"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></button><div class="md:hidden"><button class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></header><main class="flex-1"><section class="border-b border-border/50"><div class="relative overflow-hidden"><div class="absolute inset-0 bg-gradient-to-b from-primary/5 to-transparent"></div><div class="relative mx-auto max-w-6xl px-6 py-16 lg:py-20"><nav class="mb-4 flex items-center gap-2 text-sm text-muted-foreground"><span class="flex items-center gap-2"><a class="hover:text-foreground transition-colors" href="/blog/">Blog</a></span></nav><h1 class="text-3xl font-extrabold tracking-tight sm:text-4xl lg:text-5xl max-w-3xl">Building a Product Recommendation Engine with InputLayer</h1><p class="mt-4 text-lg text-muted-foreground max-w-2xl">February 5, 2026 Â· InputLayer Team</p></div></div></section><article class="mx-auto max-w-3xl px-6 py-12"><div class="docs-prose"><h1 id="building-a-product-recommendation-engine-with-inputlayer" node="[object Object]">Building a Product Recommendation Engine with InputLayer</h1>
<p>A customer just bought a DSLR camera. Your recommendation engine suggests... more cameras. Three other DSLRs in slightly different price ranges.</p>
<p>The customer doesn&#x27;t need another camera. They need a lens, a memory card, and a bag to carry it all in. But those items look nothing like a camera in embedding space. The connection between &quot;camera&quot; and &quot;camera bag&quot; is <em>logical</em> (one is an accessory for the other), not <em>semantic</em> (their product descriptions have little overlap).</p>
<p>This is the gap between similarity-based recommendations and reasoning-based recommendations. In this tutorial, we&#x27;ll build an engine that handles both - and a few other things that traditional recommenders struggle with.</p>
<h2 id="what-were-building" node="[object Object]">What we&#x27;re building</h2>
<p>By the end of this tutorial, you&#x27;ll have a recommendation engine with four distinct signals:</p>
<div class="my-8 space-y-2"><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-primary/10 border-primary/60">Recommendation Engine</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Collaborative Filtering</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">&quot;users who bought X also bought Y&quot;</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Category Affinity (recursive)</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">&quot;related product categories, at any depth&quot;</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Semantic Similarity</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">&quot;products with similar descriptions&quot;</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Accessory Relationships</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">&quot;this product goes with that one&quot;</div></div></div></div></div></div></div></div></div>
<div class="my-8 rounded-r-lg border border-l-4 px-5 py-4 border-l-blue-400 dark:border-l-blue-500 bg-blue-50/60 dark:bg-blue-950/20"><p class="text-sm leading-relaxed whitespace-pre-line">Results are combined, de-duplicated, and filtered: already purchased items are excluded, out-of-stock items are excluded, and discontinued items are removed automatically.</p></div>
<p>Each signal is expressed as a simple, readable rule. The engine combines them automatically. And because this runs on a knowledge graph with incremental computation, the recommendations stay fresh without model retraining or index rebuilding.</p>
<h2 id="step-1-model-your-product-catalog" node="[object Object]">Step 1: Model your product catalog</h2>
<p>Everything starts with your product data. In InputLayer, this means storing structured facts about products, their categories, and how categories relate to each other.</p>
<p>You store each product with its name and direct category. Then you describe the category hierarchy - running shoes fall under athletic footwear, which falls under footwear, which falls under apparel. This hierarchy is the backbone for one of our recommendation signals.</p>
<p>You also store embedding vectors for each product, generated from product descriptions using a text embedding model. These power the semantic similarity signal.</p>
<div class="my-8 space-y-2"><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-primary/10 border-primary/60">Sports</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Athletic</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Footwear</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">SKU_001 &quot;Running Shoes&quot;</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">SKU_002 &quot;Trail Shoes&quot;</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Accessories</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">SKU_003 &quot;Running Socks&quot;</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">SKU_004 &quot;Hydration Pack&quot;</div></div></div></div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Electronics</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">SKU_005 &quot;GPS Watch&quot;</div></div></div></div></div></div></div></div></div></div></div></div>
<h2 id="step-2-feed-in-user-behavior" node="[object Object]">Step 2: Feed in user behavior</h2>
<p>Next, purchase history and browsing data. Who bought what, and what have they been looking at recently. In production, you&#x27;d ingest this from your transaction database as events happen.</p>
<div class="my-8 space-y-2"><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Purchase History</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">user_1: Running Shoes, Running Socks</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">user_2: Running Shoes, Hydration Pack</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">user_3: Trail Shoes, GPS Watch</div></div></div></div></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Browsing Data</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-muted/50 border-border text-muted-foreground">user_1 viewed: Trail Shoes, GPS Watch</div></div></div></div></div></div>
<p>The important thing: these aren&#x27;t just rows in a table. They&#x27;re facts in a knowledge graph that the reasoning engine can combine with other facts through rules. That&#x27;s the key difference from a traditional recommendation database.</p>
<h2 id="step-3-define-recommendation-rules" node="[object Object]">Step 3: Define recommendation rules</h2>
<p>This is where the approach diverges from traditional ML recommendations. Instead of training a model, we express recommendation logic as rules. Each rule captures a different signal, and each rule is readable in plain English.</p>
<p><strong>Rule 1 - Collaborative filtering:</strong> &quot;If two users bought the same product, the other products each user bought become recommendations for the other.&quot; This is the classic &quot;customers who bought X also bought Y&quot; pattern. But it&#x27;s expressed as a rule, not a matrix factorization - which means you can read it, debug it, and explain exactly why a recommendation appeared.</p>
<p>What this looks like in practice for user_1:</p>
<div class="my-8 flex flex-col items-center gap-0"><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">user_1 bought Running Shoes</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">who else bought Running Shoes?</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-primary/10 border-primary/60">user_2 also bought Running Shoes</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">what else did user_2 buy?</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">user_2 also bought Hydration Pack</div><div class="rounded-lg px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-primary/10 border-2 border-primary font-medium">Recommend Hydration Pack to user_1</div></div>
<p><strong>Rule 2 - Category affinity (recursive):</strong> &quot;If a user bought something in one category, recommend products from related categories.&quot; This rule is recursive - it follows the category hierarchy to find related categories at any depth.</p>
<div class="my-8 flex flex-col items-center gap-0"><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">user_1 bought Running Shoes (in footwear)</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">walk up the category tree</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-primary/10 border-primary/60">Footwear is under Athletic</div><div class="flex flex-col items-center py-0.5"><div class="w-px h-2.5 bg-border"></div><span class="text-[11px] text-muted-foreground leading-tight py-px">what else is under Athletic?</span><div class="w-px h-2.5 bg-border"></div><div class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[6px] border-l-transparent border-r-transparent border-t-border"></div></div><div class="rounded-lg border px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-card border-border">Accessories and Electronics are also under Athletic</div><div class="rounded-lg px-5 py-2.5 text-sm text-center max-w-xs w-full shadow-sm bg-primary/10 border-2 border-primary font-medium">Recommend from related categories: Hydration Pack, GPS Watch</div></div>
<p>Buying running shoes surfaces recommendations not just from footwear, but from accessories and electronics too, because they share a parent category. And this works no matter how deep or wide your category tree goes.</p>
<p><strong>Rule 3 - Semantic similarity:</strong> Products with similar descriptions (as measured by their embedding vectors) become recommendations. This catches relationships that the category hierarchy misses - two products from completely different categories that people tend to use together.</p>
<p><strong>Rule 4 - Accessory relationships:</strong> &quot;When a customer buys a product, recommend its accessories - but only if they haven&#x27;t already bought them and they&#x27;re in stock.&quot; This is the explicit knowledge that a camera bag goes with a camera, expressed directly rather than inferred statistically.</p>
<h2 id="step-4-combine-and-query" node="[object Object]">Step 4: Combine and query</h2>
<p>Now you ask: &quot;What should we recommend to user_1?&quot;</p>
<p>The engine evaluates all four rules, combines their results, filters out products user_1 has already bought, checks stock availability, and returns the final list:</p>
<div class="my-8 space-y-2"><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-primary/10 border-primary/60">Signals for user_1</div><div class="ml-3.5 mt-1.5 border-l-2 border-border/50 pl-5 space-y-1.5 pb-0.5"><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Collaborative: Hydration Pack (via user_2)</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Category: Hydration Pack, GPS Watch, Trail Shoes</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-card border-border">Semantic: Trail Shoes (0.92 similarity to Running Shoes)</div></div></div><div class="relative"><div class="absolute left-[-22px] top-[13px] w-[18px] h-px bg-border/50"></div><div><div class="rounded-md border px-3 py-1.5 text-sm inline-block shadow-sm bg-muted/50 border-border text-muted-foreground">Accessory: (none defined in this example)</div></div></div></div></div></div>
<div class="my-8"><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-primary/20 text-primary ring-primary/40">1</div><div class="w-px flex-1 min-h-5 bg-border/60"></div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">Trail Shoes - matched by category + semantic similarity</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">strongest combined signal</p></div></div><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-primary/20 text-primary ring-primary/40">2</div><div class="w-px flex-1 min-h-5 bg-border/60"></div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">Hydration Pack - matched by collaborative + category</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">two independent signals</p></div></div><div class="flex gap-3.5"><div class="flex flex-col items-center"><div class="w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ring-2 bg-muted text-muted-foreground ring-border">3</div></div><div class="pb-5 pt-1 min-w-0"><p class="text-sm font-medium leading-snug">GPS Watch - matched by category</p><p class="text-xs text-muted-foreground mt-0.5 leading-snug">single signal</p></div></div></div>
<p>Each recommendation carries its provenance. You can explain to the user <em>why</em> each item was recommended, and you can explain to your product team which signals are driving the most engagement. Try getting that kind of transparency from a neural collaborative filtering model.</p>
<h2 id="step-5-watch-it-stay-fresh" node="[object Object]">Step 5: Watch it stay fresh</h2>
<p>Here&#x27;s where the knowledge graph approach really shines compared to model-based recommenders.</p>
<p><strong>A new purchase comes in.</strong> User_1 buys a GPS Watch. You add that fact. All recommendations update instantly - GPS Watch drops out of user_1&#x27;s recommendations (already purchased), and any collaborative filtering signals that involve GPS Watch recalculate. No model retraining needed.</p>
<p><strong>A product goes out of stock.</strong> You update the stock status for Trail Shoes. Every recommendation that included Trail Shoes disappears from results automatically. When it&#x27;s back in stock, the recommendations come back. No index rebuild needed.</p>
<p><strong>A product is discontinued.</strong> You retract it from the catalog entirely. InputLayer&#x27;s correct retraction mechanism removes it from every recommendation result, every collaborative filtering signal, every category association - automatically and immediately. No stale suggestions pointing customers to a product page that returns a 404.</p>
<div class="my-8 overflow-x-auto"><div class="flex items-center justify-center gap-0 min-w-max px-2"><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-red-50 dark:bg-red-950/30 border-red-300 dark:border-red-800 text-red-800 dark:text-red-200 font-medium">Traditional ML recommender</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Retrain model (hours)</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Rebuild index (minutes)</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Deploy (minutes)</div></div></div></div>
<div class="my-8 overflow-x-auto"><div class="flex items-center justify-center gap-0 min-w-max px-2"><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-emerald-50 dark:bg-emerald-950/30 border-emerald-300 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200">InputLayer</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Retract fact</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Recommendations update (~ms)</div><div class="flex items-center px-1"><div class="w-5 h-px bg-border"></div><div class="w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-t-transparent border-b-transparent border-l-border"></div></div></div><div class="flex items-center shrink-0"><div class="rounded-lg border px-4 py-2 text-sm shadow-sm whitespace-nowrap bg-card border-border">Done</div></div></div></div>
<h2 id="where-to-take-this-next" node="[object Object]">Where to take this next</h2>
<p>What we&#x27;ve built is the foundation. Here are the layers you&#x27;d add for production:</p>
<p><strong>Inventory-aware filtering</strong> - only recommend products that are actually in stock and available in the customer&#x27;s region. This is one more condition on the recommendation rule.</p>
<p><strong>Time decay</strong> - weight recent purchases more heavily than old ones. A customer who bought running shoes yesterday is more likely to need accessories than a customer who bought them two years ago.</p>
<p><strong>Price affinity</strong> - recommend products in the customer&#x27;s typical price range. If they buy premium products, don&#x27;t recommend budget options.</p>
<p><strong>Seasonal rules</strong> - boost winter gear in November, swimwear in May. Express seasonality as a rule rather than baking it into a training set.</p>
<p>Each of these is just another rule in the knowledge graph. The engine handles the interactions between all rules automatically - you don&#x27;t need to worry about how time decay interacts with category affinity, or how inventory filtering affects collaborative signals. Define the rules, and the engine composes them.</p>
<p>Check out the <a node="[object Object]" href="/docs/guides/core-concepts/">data modeling guide</a> for patterns that work well at scale, and the <a node="[object Object]" href="/docs/guides/python-sdk/">Python SDK</a> for integrating this into your e-commerce platform.</p></div></article><section class="border-t border-border/50"><div class="mx-auto max-w-6xl px-6 py-16"><div class="relative rounded-2xl border border-border bg-gradient-to-br from-primary/10 via-transparent to-primary/5 p-12 text-center space-y-6"><h2 class="text-3xl font-bold tracking-tight">Ready to get started?</h2><p class="text-muted-foreground text-lg max-w-xl mx-auto">InputLayer is open-source. Pull the Docker image and start building.</p><div class="flex flex-wrap justify-center gap-3 pt-2"><a class="inline-flex items-center gap-2 rounded-md bg-primary px-6 py-3 text-sm font-medium text-primary-foreground hover:bg-primary/90 transition-colors" href="/docs/">Read the docs<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right h-4 w-4"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg></a><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 rounded-md border border-border bg-background px-6 py-3 text-sm font-medium hover:bg-secondary transition-colors">View on GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3.5 w-3.5"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></div></div></div></section></main><footer class="border-t border-border/50 bg-card/50"><div class="mx-auto max-w-6xl px-6 py-12"><div class="grid grid-cols-2 gap-8 md:grid-cols-4 lg:gap-12"><div><h3 class="text-sm font-semibold text-foreground mb-3">Product</h3><ul class="space-y-2"><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/#features">Features</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/use-cases/">Use Cases</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/compare/">Compare</a></li><li><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Resources</h3><ul class="space-y-2"><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/">Documentation</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/blog/">Blog</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/guides/quickstart/">Quickstart</a></li><li><a class="text-sm text-muted-foreground hover:text-foreground transition-colors" href="/docs/guides/python-sdk/">Python SDK</a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Company</h3><ul class="space-y-2"><li><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li><li><a href="https://github.com/inputlayer/inputlayer/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">License<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div><div><h3 class="text-sm font-semibold text-foreground mb-3">Community</h3><ul class="space-y-2"><li><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Star on GitHub<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li><li><a href="https://github.com/inputlayer/inputlayer/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors">Contributing<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></li></ul></div></div><div class="mt-10 flex flex-col sm:flex-row items-center justify-between gap-4 border-t border-border/50 pt-8"><div class="flex items-center gap-4"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-base">InputLayer</span></span><span class="text-sm text-muted-foreground">AGPL-3.0 License</span></div><p class="text-xs text-muted-foreground">A symbolic reasoning engine for AI agents.</p></div></div></footer></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1942,[\"177\",\"static/chunks/app/layout-7e9963bf811be36b.js\"],\"ThemeProvider\"]\n3:I[7121,[],\"\"]\n4:I[4581,[],\"\"]\n6:I[484,[],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[484,[],\"ViewportBoundary\"]\nb:I[484,[],\"MetadataBoundary\"]\nd:I[7123,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4bd7a24b7976d4e6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"05bjYGyiAumoEMBrfWHih\",\"c\":[\"\",\"blog\",\"building-product-recommendation-engine\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"building-product-recommendation-engine\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4bd7a24b7976d4e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 font-sans antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[1268,[\"758\",\"static/chunks/758-3cb69ce377cde046.js\",\"121\",\"static/chunks/121-aece4f809b101dc1.js\",\"830\",\"static/chunks/830-dbae36b1030f3d7c.js\",\"689\",\"static/chunks/689-4fcf9680fdc90283.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-a68506d98e2282cb.js\"],\"BlogPostClient\"]\nf:T22cc,"])</script><script>self.__next_f.push([1,"\n# Building a Product Recommendation Engine with InputLayer\n\nA customer just bought a DSLR camera. Your recommendation engine suggests... more cameras. Three other DSLRs in slightly different price ranges.\n\nThe customer doesn't need another camera. They need a lens, a memory card, and a bag to carry it all in. But those items look nothing like a camera in embedding space. The connection between \"camera\" and \"camera bag\" is *logical* (one is an accessory for the other), not *semantic* (their product descriptions have little overlap).\n\nThis is the gap between similarity-based recommendations and reasoning-based recommendations. In this tutorial, we'll build an engine that handles both - and a few other things that traditional recommenders struggle with.\n\n## What we're building\n\nBy the end of this tutorial, you'll have a recommendation engine with four distinct signals:\n\n```tree\nRecommendation Engine [primary]\n  Collaborative Filtering\n    \"users who bought X also bought Y\"\n  Category Affinity (recursive)\n    \"related product categories, at any depth\"\n  Semantic Similarity\n    \"products with similar descriptions\"\n  Accessory Relationships\n    \"this product goes with that one\"\n```\n\n```note\ntype: info\nResults are combined, de-duplicated, and filtered: already purchased items are excluded, out-of-stock items are excluded, and discontinued items are removed automatically.\n```\n\nEach signal is expressed as a simple, readable rule. The engine combines them automatically. And because this runs on a knowledge graph with incremental computation, the recommendations stay fresh without model retraining or index rebuilding.\n\n## Step 1: Model your product catalog\n\nEverything starts with your product data. In InputLayer, this means storing structured facts about products, their categories, and how categories relate to each other.\n\nYou store each product with its name and direct category. Then you describe the category hierarchy - running shoes fall under athletic footwear, which falls under footwear, which falls under apparel. This hierarchy is the backbone for one of our recommendation signals.\n\nYou also store embedding vectors for each product, generated from product descriptions using a text embedding model. These power the semantic similarity signal.\n\n```tree\nSports [primary]\n  Athletic\n    Footwear\n      SKU_001 \"Running Shoes\"\n      SKU_002 \"Trail Shoes\"\n    Accessories\n      SKU_003 \"Running Socks\"\n      SKU_004 \"Hydration Pack\"\n    Electronics\n      SKU_005 \"GPS Watch\"\n```\n\n## Step 2: Feed in user behavior\n\nNext, purchase history and browsing data. Who bought what, and what have they been looking at recently. In production, you'd ingest this from your transaction database as events happen.\n\n```tree\nPurchase History\n  user_1: Running Shoes, Running Socks\n  user_2: Running Shoes, Hydration Pack\n  user_3: Trail Shoes, GPS Watch\nBrowsing Data\n  user_1 viewed: Trail Shoes, GPS Watch [muted]\n```\n\nThe important thing: these aren't just rows in a table. They're facts in a knowledge graph that the reasoning engine can combine with other facts through rules. That's the key difference from a traditional recommendation database.\n\n## Step 3: Define recommendation rules\n\nThis is where the approach diverges from traditional ML recommendations. Instead of training a model, we express recommendation logic as rules. Each rule captures a different signal, and each rule is readable in plain English.\n\n**Rule 1 - Collaborative filtering:** \"If two users bought the same product, the other products each user bought become recommendations for the other.\" This is the classic \"customers who bought X also bought Y\" pattern. But it's expressed as a rule, not a matrix factorization - which means you can read it, debug it, and explain exactly why a recommendation appeared.\n\nWhat this looks like in practice for user_1:\n\n```chain\nuser_1 bought Running Shoes\n-- who else bought Running Shoes?\nuser_2 also bought Running Shoes [primary]\n-- what else did user_2 buy?\nuser_2 also bought Hydration Pack\n=\u003e Recommend Hydration Pack to user_1 [success]\n```\n\n**Rule 2 - Category affinity (recursive):** \"If a user bought something in one category, recommend products from related categories.\" This rule is recursive - it follows the category hierarchy to find related categories at any depth.\n\n```chain\nuser_1 bought Running Shoes (in footwear)\n-- walk up the category tree\nFootwear is under Athletic [primary]\n-- what else is under Athletic?\nAccessories and Electronics are also under Athletic\n=\u003e Recommend from related categories: Hydration Pack, GPS Watch [success]\n```\n\nBuying running shoes surfaces recommendations not just from footwear, but from accessories and electronics too, because they share a parent category. And this works no matter how deep or wide your category tree goes.\n\n**Rule 3 - Semantic similarity:** Products with similar descriptions (as measured by their embedding vectors) become recommendations. This catches relationships that the category hierarchy misses - two products from completely different categories that people tend to use together.\n\n**Rule 4 - Accessory relationships:** \"When a customer buys a product, recommend its accessories - but only if they haven't already bought them and they're in stock.\" This is the explicit knowledge that a camera bag goes with a camera, expressed directly rather than inferred statistically.\n\n## Step 4: Combine and query\n\nNow you ask: \"What should we recommend to user_1?\"\n\nThe engine evaluates all four rules, combines their results, filters out products user_1 has already bought, checks stock availability, and returns the final list:\n\n```tree\nSignals for user_1 [primary]\n  Collaborative: Hydration Pack (via user_2)\n  Category: Hydration Pack, GPS Watch, Trail Shoes\n  Semantic: Trail Shoes (0.92 similarity to Running Shoes)\n  Accessory: (none defined in this example) [muted]\n```\n\n```steps\nTrail Shoes - matched by category + semantic similarity :: strongest combined signal [primary]\nHydration Pack - matched by collaborative + category :: two independent signals [primary]\nGPS Watch - matched by category :: single signal\n```\n\nEach recommendation carries its provenance. You can explain to the user *why* each item was recommended, and you can explain to your product team which signals are driving the most engagement. Try getting that kind of transparency from a neural collaborative filtering model.\n\n## Step 5: Watch it stay fresh\n\nHere's where the knowledge graph approach really shines compared to model-based recommenders.\n\n**A new purchase comes in.** User_1 buys a GPS Watch. You add that fact. All recommendations update instantly - GPS Watch drops out of user_1's recommendations (already purchased), and any collaborative filtering signals that involve GPS Watch recalculate. No model retraining needed.\n\n**A product goes out of stock.** You update the stock status for Trail Shoes. Every recommendation that included Trail Shoes disappears from results automatically. When it's back in stock, the recommendations come back. No index rebuild needed.\n\n**A product is discontinued.** You retract it from the catalog entirely. InputLayer's correct retraction mechanism removes it from every recommendation result, every collaborative filtering signal, every category association - automatically and immediately. No stale suggestions pointing customers to a product page that returns a 404.\n\n```flow\nTraditional ML recommender [highlight] -\u003e Retrain model (hours) -\u003e Rebuild index (minutes) -\u003e Deploy (minutes)\n```\n\n```flow\nInputLayer [success] -\u003e Retract fact -\u003e Recommendations update (~ms) -\u003e Done\n```\n\n## Where to take this next\n\nWhat we've built is the foundation. Here are the layers you'd add for production:\n\n**Inventory-aware filtering** - only recommend products that are actually in stock and available in the customer's region. This is one more condition on the recommendation rule.\n\n**Time decay** - weight recent purchases more heavily than old ones. A customer who bought running shoes yesterday is more likely to need accessories than a customer who bought them two years ago.\n\n**Price affinity** - recommend products in the customer's typical price range. If they buy premium products, don't recommend budget options.\n\n**Seasonal rules** - boost winter gear in November, swimwear in May. Express seasonality as a rule rather than baking it into a training set.\n\nEach of these is just another rule in the knowledge graph. The engine handles the interactions between all rules automatically - you don't need to worry about how time decay interacts with category affinity, or how inventory filtering affects collaborative signals. Define the rules, and the engine composes them.\n\nCheck out the [data modeling guide](/docs/guides/core-concepts/) for patterns that work well at scale, and the [Python SDK](/docs/guides/python-sdk/) for integrating this into your e-commerce platform."])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Le\",null,{\"post\":{\"slug\":\"building-product-recommendation-engine\",\"title\":\"Building a Product Recommendation Engine with InputLayer\",\"date\":\"2026-02-05\",\"author\":\"InputLayer Team\",\"category\":\"Tutorial\",\"excerpt\":\"A step-by-step guide to building a recommendation engine that combines collaborative filtering, product relationships, and semantic similarity in a single knowledge graph.\",\"content\":\"$f\",\"toc\":[{\"level\":2,\"text\":\"What we're building\",\"id\":\"what-were-building\"},{\"level\":2,\"text\":\"Step 1: Model your product catalog\",\"id\":\"step-1-model-your-product-catalog\"},{\"level\":2,\"text\":\"Step 2: Feed in user behavior\",\"id\":\"step-2-feed-in-user-behavior\"},{\"level\":2,\"text\":\"Step 3: Define recommendation rules\",\"id\":\"step-3-define-recommendation-rules\"},{\"level\":2,\"text\":\"Step 4: Combine and query\",\"id\":\"step-4-combine-and-query\"},{\"level\":2,\"text\":\"Step 5: Watch it stay fresh\",\"id\":\"step-5-watch-it-stay-fresh\"},{\"level\":2,\"text\":\"Where to take this next\",\"id\":\"where-to-take-this-next\"}]},\"slug\":\"building-product-recommendation-engine\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[6869,[],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"InputLayer - A symbolic reasoning engine for AI agents\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.svg\"}],[\"$\",\"$L10\",\"3\",{}]]\n8:null\n"])</script></body></html>