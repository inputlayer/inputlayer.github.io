1:"$Sreact.fragment"
2:I[1942,["177","static/chunks/app/layout-7e9963bf811be36b.js"],"ThemeProvider"]
3:I[7121,[],""]
4:I[4581,[],""]
6:I[484,[],"OutletBoundary"]
7:"$Sreact.suspense"
9:I[484,[],"ViewportBoundary"]
b:I[484,[],"MetadataBoundary"]
d:I[7123,[],""]
:HL["/_next/static/media/4cf2300e9c8272f7-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/4bd7a24b7976d4e6.css","style"]
0:{"P":null,"b":"05bjYGyiAumoEMBrfWHih","c":["","docs","guides","repl",""],"q":"","i":false,"f":[[["",{"children":["docs",{"children":[["slug","guides/repl","oc"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4bd7a24b7976d4e6.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_188709 __variable_9a8899 font-sans antialiased","children":["$","$L2",null,{"attribute":"class","defaultTheme":"dark","enableSystem":true,"disableTransitionOnChange":true,"children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$","$7",null,{"name":"Next.MetadataOutlet","children":"$@8"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],["$","$1","h",{"children":[null,["$","$L9",null,{"children":"$@a"}],["$","div",null,{"hidden":true,"children":["$","$Lb",null,{"children":["$","$7",null,{"name":"Next.Metadata","children":"$@c"}]}]}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],false]],"m":"$undefined","G":["$d",[]],"S":true}
e:I[8428,["758","static/chunks/758-3cb69ce377cde046.js","121","static/chunks/121-aece4f809b101dc1.js","502","static/chunks/502-e809071f8789437b.js","689","static/chunks/689-4fcf9680fdc90283.js","870","static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js"],"DocsPageClient"]
f:T227b,# REPL Guide

The REPL is where you define facts, rules, and queries interactively.

## Starting the Client

```bash
inputlayer-client
```

You'll see:
```
Connecting to server at http://127.0.0.1:8080...
Connected!

Server status: healthy
Authenticated as: admin
Current knowledge graph: default
```

## Command Categories

### Knowledge Graph Commands (`.kg`)

Manage your knowledge graphs:

| Command | Description |
|---------|-------------|
| `.kg` | Show current knowledge graph |
| `.kg list` | List all knowledge graphs |
| `.kg create <name>` | Create a new knowledge graph |
| `.kg use <name>` | Switch to a knowledge graph |
| `.kg drop <name>` | Delete a knowledge graph (cannot drop current) |

**Examples:**
```datalog
.kg create myproject
.kg use myproject
.kg list
.kg
```

### Relation Commands (`.rel`)

Inspect base facts:

| Command | Description |
|---------|-------------|
| `.rel` | List all relations with data |
| `.rel <name>` | Show schema and sample data for a relation |
| `.rel drop <name>` | Drop a relation and its data |

**Examples:**
```datalog
.rel
.rel edge
.rel employee
```

### Rule Commands (`.rule`)

Manage persistent rules:

| Command | Description |
|---------|-------------|
| `.rule` | List all defined rules |
| `.rule <name>` | Query a rule (show computed results) |
| `.rule def <name>` | Show the rule definition (clauses) |
| `.rule drop <name>` | Delete a rule |
| `.rule remove <name> <n>` | Remove clause #n (1-based) |
| `.rule clear <name>` | Clear clauses for re-registration |
| `.rule edit <name> <n> <clause>` | Replace clause #n |

**Examples:**
```datalog
.rule                           // List all rules
.rule path                      // Query the 'path' rule
.rule def path                  // Show path's definition
.rule drop path                 // Delete the path rule
.rule clear path                // Clear for re-definition
.rule edit path 1 +path(X,Y) <- edge(X,Y)  // Edit clause 1
```

### Session Commands (`.session`)

Manage transient session rules:

| Command | Description |
|---------|-------------|
| `.session` | List session rules |
| `.session clear` | Clear all session rules |
| `.session drop <n>` | Remove session rule #n |

**Examples:**
```datalog
temp(X) <- edge(1, X)    // Add session rule
.session                   // List session rules
.session drop 1            // Remove first rule
.session clear             // Clear all
```

### File Commands (`.load`)

Load and execute InputLayer files:

| Command | Description |
|---------|-------------|
| `.load <file>` | Execute a .idl file |

**Examples:**
```datalog
.load schema.idl
.load rules.idl
```

**Note:** The `.load` command reads the file and executes each statement in order. It continues through non-fatal errors so cleanup commands always run.

### Index Commands (`.index` / `.idx`)

Manage HNSW vector indexes:

| Command | Description |
|---------|-------------|
| `.index` or `.index list` | List all indexes |
| `.index create <name> on <rel>(<col>) [options]` | Create an HNSW index |
| `.index drop <name>` | Drop an index |
| `.index stats <name>` | Show index statistics |
| `.index rebuild <name>` | Force rebuild an index |

**Examples:**
```datalog
.index create vec_idx on docs(embedding) type hnsw metric cosine m 16 ef_construction 200
.index stats vec_idx
.index drop vec_idx
```

### User Commands (`.user`)

Manage users (requires admin):

| Command | Description |
|---------|-------------|
| `.user list` | List all users |
| `.user create <name> <password> <role>` | Create a user (`admin`, `editor`, `viewer`) |
| `.user drop <name>` | Delete a user |
| `.user password <name> <password>` | Change a user's password |
| `.user role <name> <role>` | Change a user's role |

### API Key Commands (`.apikey`)

Manage API keys for machine-to-machine auth:

| Command | Description |
|---------|-------------|
| `.apikey create <label>` | Create a new API key |
| `.apikey list` | List all API keys |
| `.apikey revoke <label>` | Revoke an API key |

### Access Control Commands (`.kg acl`)

Manage per-knowledge-graph access:

| Command | Description |
|---------|-------------|
| `.kg acl list [<kg>]` | List ACLs for a knowledge graph |
| `.kg acl grant <kg> <user> <role>` | Grant access (`owner`, `editor`, `viewer`) |
| `.kg acl revoke <kg> <user>` | Revoke access |

### System Commands

| Command | Description |
|---------|-------------|
| `.status` | Show system status |
| `.compact` | Compact WAL and consolidate storage |
| `.explain <query>` | Show query plan without executing |
| `.clear prefix <p>` | Clear all facts from relations matching prefix |
| `.help` | Show help message |
| `.quit` or `.exit` | Exit the REPL |

## Statement Types

### Insert Facts (`+`)

```datalog
// Single fact
+edge(1, 2)

// Bulk insert
+edge[(1, 2), (2, 3), (3, 4)]

// With different types
+person("alice", 30, "engineering")
```

### Delete Facts (`-`)

```datalog
// Single fact
-edge(1, 2)

// Conditional delete (must reference relation in body)
-edge(X, Y) <- edge(X, Y), X > 10

// Delete all from a relation
-edge(X, Y) <- edge(X, Y)
```

### Updates (Delete then Insert)

```datalog
// First delete old value
-counter(1, 0)
// Then insert new value
+counter(1, 5)
```

### Persistent Rules (`+head <- body`)

```datalog
// Simple rule
+adult(Name, Age) <- person(Name, Age), Age >= 18

// Recursive rule
+path(X, Y) <- edge(X, Y)
+path(X, Z) <- path(X, Y), edge(Y, Z)

// With aggregation
+dept_count(Dept, count<Id>) <- employee(Id, Dept)
```

### Session Rules (`head <- body`)

```datalog
// Transient rule (no + prefix)
temp_result(X, Y) <- edge(X, Y), X < Y
```

### Queries (`?`)

```datalog
// Simple query
?edge(1, X)

// With constraints
?person(Name, Age), Age > 25

// Query derived data
?path(1, X)
```

### Schema Declarations

```datalog
// Typed schema
+employee(id: int, name: string, dept: string)
+user(id: int, name: string, email: string)
```

## Tips and Tricks

### Multi-line Statements

In script files (`.idl`), statements can span multiple lines. In the interactive REPL, each line is sent as a separate statement:

```datalog
// In a .idl script file:
+complex_rule(X, Y, Z) <-
  first_condition(X, A),
  second_condition(A, Y),
  third_condition(Y, Z),
  X < Y,
  Y < Z

// In the interactive REPL, write it as a single line:
+complex_rule(X, Y, Z) <- first_condition(X, A), second_condition(A, Y), third_condition(Y, Z), X < Y, Y < Z
```

### Comments

```datalog
// Single line comment
+edge(1, 2)  // Inline comment

/*
   Multi-line
   block comment
*/
```

### Viewing Results

Query results are displayed as formatted tables:

```
> ?edge(X, Y)
```

| X | Y |
|---|---|
| 1 | 2 |
| 2 | 3 |
| 3 | 4 |
| 4 | 5 |
| 5 | 6 |

*5 rows*

### Using Wildcards

Use `_` to ignore columns:

```datalog
// Get all source nodes (ignore target)
?edge(X, _)

// Count unique sources
temp(count<X>) <- edge(X, _)
```

## Common Workflows

### 1. Exploratory Analysis

```datalog
.kg create exploration
.kg use exploration
.load data.idl
.rel                          // See what data exists
?some_relation(X, Y)         // Explore
temp(X) <- complex_query...  // Session rule for analysis
.session clear                // Clean up when done
```

### 2. Building a Schema

```datalog
.kg create production
.kg use production

// Define schemas first
+user(id: int, name: string, email: string)
+order(id: int, user_id: int, amount: float)

// Load data
.load users.idl
.load orders.idl

// Verify
.rel user
.rel order
```

### 3. Defining Business Rules

```datalog
// Define persistent rules
+high_value_customer(UserId) <-
  order(_, UserId, Amount),
  Amount > 1000

// Aggregate total spend per customer
+customer_spend(UserId, sum<Amount>) <-
  order(_, UserId, Amount)

// VIPs have high total spend
+vip(UserId, Total) <-
  high_value_customer(UserId),
  customer_spend(UserId, Total),
  Total > 5000

// Query
?vip(User, Spend)
```

### 4. Iterating on Rules

```datalog
// First attempt
+path(X, Y) <- edge(X, Y)

// Check results
.rule path

// Not right? Clear and redefine
.rule clear path
+path(X, Y) <- edge(X, Y)
+path(X, Z) <- path(X, Y), edge(Y, Z)

// Verify
.rule def path
.rule path
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Ctrl+C` | Cancel current input |
| `Ctrl+D` | Exit REPL (same as `.quit`) |
| `Up` / `Down` | Navigate command history |
| `Ctrl+R` | Search command history |

## Error Handling

When something goes wrong, InputLayer provides error messages:

```
> +edge(1, "two")
Type mismatch in 'edge': column 1 expected int, got string
```

```
> ?undefined_relation(X)
Relation 'undefined_relation' not found.
```

## Next Steps

- **[Recursion](recursion)** - Recursive query patterns
- **[Troubleshooting](troubleshooting)** - Common issues and solutions5:["$","$Le",null,{"page":{"title":"REPL Guide","content":"$f","toc":[{"level":2,"text":"Starting the Client","id":"starting-the-client"},{"level":2,"text":"Command Categories","id":"command-categories"},{"level":3,"text":"Knowledge Graph Commands (.kg)","id":"knowledge-graph-commands-kg"},{"level":3,"text":"Relation Commands (.rel)","id":"relation-commands-rel"},{"level":3,"text":"Rule Commands (.rule)","id":"rule-commands-rule"},{"level":3,"text":"Session Commands (.session)","id":"session-commands-session"},{"level":3,"text":"File Commands (.load)","id":"file-commands-load"},{"level":3,"text":"Index Commands (.index / .idx)","id":"index-commands-index-idx"},{"level":3,"text":"User Commands (.user)","id":"user-commands-user"},{"level":3,"text":"API Key Commands (.apikey)","id":"api-key-commands-apikey"},{"level":3,"text":"Access Control Commands (.kg acl)","id":"access-control-commands-kg-acl"},{"level":3,"text":"System Commands","id":"system-commands"},{"level":2,"text":"Statement Types","id":"statement-types"},{"level":3,"text":"Insert Facts (+)","id":"insert-facts-"},{"level":3,"text":"Delete Facts (-)","id":"delete-facts-"},{"level":3,"text":"Updates (Delete then Insert)","id":"updates-delete-then-insert"},{"level":3,"text":"Persistent Rules (+head <- body)","id":"persistent-rules-head-body"},{"level":3,"text":"Session Rules (head <- body)","id":"session-rules-head-body"},{"level":3,"text":"Queries (?)","id":"queries-"},{"level":3,"text":"Schema Declarations","id":"schema-declarations"},{"level":2,"text":"Tips and Tricks","id":"tips-and-tricks"},{"level":3,"text":"Multi-line Statements","id":"multi-line-statements"},{"level":3,"text":"Comments","id":"comments"},{"level":3,"text":"Viewing Results","id":"viewing-results"},{"level":3,"text":"Using Wildcards","id":"using-wildcards"},{"level":2,"text":"Common Workflows","id":"common-workflows"},{"level":3,"text":"1. Exploratory Analysis","id":"1-exploratory-analysis"},{"level":3,"text":"2. Building a Schema","id":"2-building-a-schema"},{"level":3,"text":"3. Defining Business Rules","id":"3-defining-business-rules"},{"level":3,"text":"4. Iterating on Rules","id":"4-iterating-on-rules"},{"level":2,"text":"Keyboard Shortcuts","id":"keyboard-shortcuts"},{"level":2,"text":"Error Handling","id":"error-handling"},{"level":2,"text":"Next Steps","id":"next-steps"}]},"slugKey":"guides/repl"}]
a:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
10:I[6869,[],"IconMark"]
c:[["$","title","0",{"children":"InputLayer - A symbolic reasoning engine for AI agents"}],["$","meta","1",{"name":"description","content":"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."}],["$","link","2",{"rel":"icon","href":"/icon.svg"}],["$","$L10","3",{}]]
8:null
