1:"$Sreact.fragment"
2:I[1942,["177","static/chunks/app/layout-7e9963bf811be36b.js"],"ThemeProvider"]
3:I[7121,[],""]
4:I[4581,[],""]
6:I[484,[],"OutletBoundary"]
7:"$Sreact.suspense"
9:I[484,[],"ViewportBoundary"]
b:I[484,[],"MetadataBoundary"]
d:I[7123,[],""]
:HL["/_next/static/media/4cf2300e9c8272f7-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/4bd7a24b7976d4e6.css","style"]
0:{"P":null,"b":"05bjYGyiAumoEMBrfWHih","c":["","docs","guides","rest-api",""],"q":"","i":false,"f":[[["",{"children":["docs",{"children":[["slug","guides/rest-api","oc"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4bd7a24b7976d4e6.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_188709 __variable_9a8899 font-sans antialiased","children":["$","$L2",null,{"attribute":"class","defaultTheme":"dark","enableSystem":true,"disableTransitionOnChange":true,"children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$","$7",null,{"name":"Next.MetadataOutlet","children":"$@8"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],["$","$1","h",{"children":[null,["$","$L9",null,{"children":"$@a"}],["$","div",null,{"hidden":true,"children":["$","$Lb",null,{"children":["$","$7",null,{"name":"Next.Metadata","children":"$@c"}]}]}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],false]],"m":"$undefined","G":["$d",[]],"S":true}
e:I[8428,["758","static/chunks/758-3cb69ce377cde046.js","121","static/chunks/121-aece4f809b101dc1.js","502","static/chunks/502-e809071f8789437b.js","689","static/chunks/689-4fcf9680fdc90283.js","870","static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js"],"DocsPageClient"]
f:T17df,# HTTP API Guide

InputLayer is a **WebSocket-first** system. All data operations (queries, inserts, rule definitions, meta commands) go through the WebSocket API. The HTTP REST endpoints provide health checks, metrics, and documentation.

For query execution, see the [WebSocket API](websocket-api) guide.

## Starting the Server

```bash
# Start the HTTP server
./target/release/inputlayer-server

# With custom port
./target/release/inputlayer-server --port 9090

# With config file
./target/release/inputlayer-server --config config.toml
```

Or enable in configuration:

```toml
[http]
enabled = true
host = "127.0.0.1"
port = 8080
```

## Base URL

All endpoints are available at both root and versioned paths:

```
http://localhost:8080/health
http://localhost:8080/v1/health
```

---

## Health & Monitoring Endpoints

### Health Check

```http
GET /health
```

Returns server health status. Returns HTTP 200 when healthy, 503 when storage is degraded.

**Response (200):**
```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "version": "0.1.0",
    "uptime_secs": 3600
  }
}
```

**Response (503) - Storage lock contended:**
```json
{
  "success": true,
  "data": {
    "status": "degraded",
    "version": "0.1.0",
    "uptime_secs": 3600
  }
}
```

### Liveness Probe

```http
GET /live
```

Always returns HTTP 200 if the process is alive. Does not check storage. Use for Kubernetes liveness probes.

### Readiness Probe

```http
GET /ready
```

Returns HTTP 200 if the server can handle requests (storage accessible). Returns 503 if storage lock is contended. Use for Kubernetes readiness probes.

### Server Statistics

```http
GET /metrics
```

**Response:**
```json
{
  "success": true,
  "data": {
    "knowledge_graphs": 3,
    "relations": 10,
    "views": 5,
    "memory_usage_bytes": 262144,
    "query_count": 15000,
    "uptime_secs": 3600,
    "sessions": {
      "total": 5,
      "clean": 3,
      "dirty": 2,
      "total_ephemeral_facts": 100,
      "total_ephemeral_rules": 10
    }
  }
}
```

### Prometheus Metrics

```http
GET /metrics/prometheus
```

Returns metrics in Prometheus text exposition format:

```
# HELP inputlayer_uptime_seconds Server uptime in seconds.
# TYPE inputlayer_uptime_seconds gauge
inputlayer_uptime_seconds 3600
# HELP inputlayer_queries_total Total queries executed.
# TYPE inputlayer_queries_total counter
inputlayer_queries_total 15000
# HELP inputlayer_knowledge_graphs Number of knowledge graphs.
# TYPE inputlayer_knowledge_graphs gauge
inputlayer_knowledge_graphs 3
# HELP inputlayer_relations_total Total base relations.
# TYPE inputlayer_relations_total gauge
inputlayer_relations_total 10
# HELP inputlayer_views_total Total derived views (rules).
# TYPE inputlayer_views_total gauge
inputlayer_views_total 5
# HELP inputlayer_sessions_total Active sessions.
# TYPE inputlayer_sessions_total gauge
inputlayer_sessions_total 5
# HELP inputlayer_sessions_clean Clean (idle) sessions.
# TYPE inputlayer_sessions_clean gauge
inputlayer_sessions_clean 3
# HELP inputlayer_sessions_dirty Dirty (active) sessions.
# TYPE inputlayer_sessions_dirty gauge
inputlayer_sessions_dirty 2
# HELP inputlayer_tuples_total Total stored tuples.
# TYPE inputlayer_tuples_total gauge
inputlayer_tuples_total 50000
# HELP inputlayer_memory_usage_bytes Estimated memory usage.
# TYPE inputlayer_memory_usage_bytes gauge
inputlayer_memory_usage_bytes 104857600
# HELP inputlayer_ephemeral_facts Ephemeral facts across sessions.
# TYPE inputlayer_ephemeral_facts gauge
inputlayer_ephemeral_facts 10
# HELP inputlayer_ephemeral_rules Ephemeral rules across sessions.
# TYPE inputlayer_ephemeral_rules gauge
inputlayer_ephemeral_rules 2
```

---

## WebSocket Endpoints

### Global WebSocket

```http
GET /ws
```

Upgrades to a WebSocket connection. Requires authentication as the first message. See [WebSocket API](websocket-api) for the full protocol.

### Session-Scoped WebSocket

```http
GET /sessions/:id/ws
```

Connects to an existing session by ID.

---

## Documentation Endpoints

### AsyncAPI Specification

```http
GET /api/asyncapi.yaml
```

Returns the AsyncAPI specification describing the WebSocket message protocol.

### OpenAPI Specification

```http
GET /api/openapi.yaml
```

Returns the OpenAPI specification describing the REST endpoints.

### WebSocket Documentation

```http
GET /api/ws-docs
```

Returns an interactive HTML page for exploring the WebSocket API.

---

## Authentication

REST endpoints (except health/live/ready) require an API key in the Authorization header:

```http
Authorization: Bearer <api-key>
```

API keys are managed via meta commands in the WebSocket session:

```datalog
.apikey create my-service-key
.apikey list
.apikey revoke my-service-key
```

See [Authentication](authentication) for details.

---

## Error Responses

All errors use a consistent format:

```json
{
  "success": false,
  "error": {
    "code": "NOT_FOUND",
    "message": "Resource not found"
  }
}
```

**Error Codes:**

| Code | HTTP Status | Description |
|------|-------------|-------------|
| `NOT_FOUND` | 404 | Resource not found |
| `BAD_REQUEST` | 400 | Invalid request |
| `INTERNAL_ERROR` | 500 | Server error |
| `SERVICE_UNAVAILABLE` | 503 | Server not ready |

---

## Client Examples

### cURL - Health Check

```bash
# Check server health
curl http://localhost:8080/health

# Get server stats
curl http://localhost:8080/metrics

# Get Prometheus metrics
curl http://localhost:8080/metrics/prometheus
```

### cURL - With Authentication

```bash
# Authenticated request
curl -H "Authorization: Bearer your-api-key" http://localhost:8080/metrics
```

### Kubernetes Probes

```yaml
livenessProbe:
  httpGet:
    path: /live
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /ready
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 5
```

---

## Next Steps

- [WebSocket API](websocket-api) - Execute queries and manage data
- [Configuration](configuration) - Server configuration options
- [Authentication](authentication) - User and API key management5:["$","$Le",null,{"page":{"title":"HTTP API Guide","content":"$f","toc":[{"level":2,"text":"Starting the Server","id":"starting-the-server"},{"level":2,"text":"Base URL","id":"base-url"},{"level":2,"text":"Health & Monitoring Endpoints","id":"health-monitoring-endpoints"},{"level":3,"text":"Health Check","id":"health-check"},{"level":3,"text":"Liveness Probe","id":"liveness-probe"},{"level":3,"text":"Readiness Probe","id":"readiness-probe"},{"level":3,"text":"Server Statistics","id":"server-statistics"},{"level":3,"text":"Prometheus Metrics","id":"prometheus-metrics"},{"level":2,"text":"WebSocket Endpoints","id":"websocket-endpoints"},{"level":3,"text":"Global WebSocket","id":"global-websocket"},{"level":3,"text":"Session-Scoped WebSocket","id":"session-scoped-websocket"},{"level":2,"text":"Documentation Endpoints","id":"documentation-endpoints"},{"level":3,"text":"AsyncAPI Specification","id":"asyncapi-specification"},{"level":3,"text":"OpenAPI Specification","id":"openapi-specification"},{"level":3,"text":"WebSocket Documentation","id":"websocket-documentation"},{"level":2,"text":"Authentication","id":"authentication"},{"level":2,"text":"Error Responses","id":"error-responses"},{"level":2,"text":"Client Examples","id":"client-examples"},{"level":3,"text":"cURL - Health Check","id":"curl-health-check"},{"level":3,"text":"cURL - With Authentication","id":"curl-with-authentication"},{"level":3,"text":"Kubernetes Probes","id":"kubernetes-probes"},{"level":2,"text":"Next Steps","id":"next-steps"}]},"slugKey":"guides/rest-api"}]
a:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
10:I[6869,[],"IconMark"]
c:[["$","title","0",{"children":"InputLayer - A symbolic reasoning engine for AI agents"}],["$","meta","1",{"name":"description","content":"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."}],["$","link","2",{"rel":"icon","href":"/icon.svg"}],["$","$L10","3",{}]]
8:null
