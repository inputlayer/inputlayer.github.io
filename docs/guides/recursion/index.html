<!DOCTYPE html><!--05bjYGyiAumoEMBrfWHih--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4bd7a24b7976d4e6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js"/><script src="/_next/static/chunks/4bd1b696-deba172d32c79f82.js" async=""></script><script src="/_next/static/chunks/794-275dc9ebd3a29fbf.js" async=""></script><script src="/_next/static/chunks/main-app-1fa5b694e5d36a75.js" async=""></script><script src="/_next/static/chunks/app/layout-7e9963bf811be36b.js" async=""></script><script src="/_next/static/chunks/758-3cb69ce377cde046.js" async=""></script><script src="/_next/static/chunks/121-aece4f809b101dc1.js" async=""></script><script src="/_next/static/chunks/502-e809071f8789437b.js" async=""></script><script src="/_next/static/chunks/689-4fcf9680fdc90283.js" async=""></script><script src="/_next/static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js" async=""></script><meta name="next-size-adjust" content=""/><title>InputLayer - A symbolic reasoning engine for AI agents</title><meta name="description" content="Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."/><link rel="icon" href="/icon.svg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="flex flex-col h-dvh"><header class="sticky top-0 z-50 w-full border-b border-border/50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="flex h-14 items-center px-6"><a class="mr-8" href="/"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-lg">InputLayer</span></span></a><nav class="hidden md:flex items-center gap-6 text-sm"><a class="text-muted-foreground transition-colors hover:text-foreground" href="/docs/">Docs</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/blog/">Blog</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/use-cases/">Use Cases</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/compare/">Compare</a><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></nav><div class="ml-auto flex items-center gap-3"><div class="inline-flex items-center gap-1.5"><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-3.5 w-3.5"><path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path></svg><span>Star</span></a><a href="https://github.com/inputlayer/inputlayer/fork" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-fork h-3.5 w-3.5"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg><span>Fork</span></a></div><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9 h-9 w-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-4 w-4"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></button><div class="md:hidden"><button class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></header><div class="flex flex-1 overflow-hidden"><div class="w-64 shrink-0 border-r border-border/50 overflow-y-auto"><div class="flex flex-col h-full"><div class="p-3 border-b border-border/50"><div class="relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><input type="text" placeholder="Search docs..." class="w-full h-8 pl-8 pr-3 text-sm rounded-md border border-border bg-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring" value=""/></div></div><nav class="flex-1 overflow-y-auto p-2 space-y-0.5"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" href="/docs/index/">Overview</a><div data-state="open" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-foreground font-medium" style="padding-left:12px" type="button" aria-controls="radix-_R_j6av5ubtb_" aria-expanded="true" data-state="open" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform rotate-90"><path d="m9 18 6-6-6-6"></path></svg>Guides</button><div data-state="open" id="radix-_R_j6av5ubtb_" data-slot="collapsible-content"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/quickstart/">Quick Start</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/installation/">Installation</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/first-program/">Your First Program</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/core-concepts/">Data Modeling</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/repl/">REPL Guide</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors bg-primary/10 text-primary font-medium" style="padding-left:24px" href="/docs/guides/recursion/">Recursion</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/vectors/">Vector Search</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/indexing/">Indexing</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/temporal/">Temporal Reasoning</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/persistence/">Persistence</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/configuration/">Configuration</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/rest-api/">REST API</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/python-sdk/">Python SDK</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/deployment/">Deployment</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/authentication/">Authentication</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/websocket-api/">WebSocket API</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/migrations/">Migrations</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/guides/troubleshooting/">Troubleshooting</a></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_r6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Reference</button><div data-state="closed" id="radix-_R_r6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_136av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Specification</button><div data-state="closed" id="radix-_R_136av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_1b6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Internals</button><div data-state="closed" id="radix-_R_1b6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div></nav></div></div><div class="flex flex-1 flex-col overflow-hidden"><div class="flex flex-1 overflow-hidden"><div class="flex-1 overflow-y-auto px-8 py-6 max-w-4xl mx-auto"><article class="docs-prose"><h1 id="tutorial-recursion" node="[object Object]">Tutorial: Recursion</h1>
<p>Recursive rules let you express transitive closure, reachability, and graph algorithms that would require loops or CTEs in SQL.</p>
<h2 id="prerequisites" node="[object Object]">Prerequisites</h2>
<ul>
<li>Completed <a href="first-program" target="_blank" rel="noopener noreferrer" node="[object Object]">Your First Program</a></li>
<li>Understanding of <a href="core-concepts" target="_blank" rel="noopener noreferrer" node="[object Object]">Core Concepts</a></li>
</ul>
<h2 id="what-is-recursion" node="[object Object]">What is Recursion?</h2>
<p>A recursive rule references itself in its body. This allows computing things that require an unknown number of steps, like:</p>
<ul>
<li>All nodes reachable from a starting point</li>
<li>Transitive relationships (ancestor/descendant)</li>
<li>Fixed-point computations</li>
</ul>
<h2 id="setup" node="[object Object]">Setup</h2>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.kg create</span> <span class="syn-identifier">recursion_tutorial</span>
<span class="syn-meta">.kg use</span> <span class="syn-identifier">recursion_tutorial</span>

<span class="syn-comment">// A simple directed graph</span>
<span class="syn-comment">//     1 -&gt; 2 -&gt; 3 -&gt; 4</span>
<span class="syn-comment">//     |   |</span>
<span class="syn-comment">//     5 -&gt; 6 -&gt; 7</span>

<span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">4</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
      <span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">5</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">6</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">5</span><span class="syn-punct">,</span> <span class="syn-number">6</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">6</span><span class="syn-punct">,</span> <span class="syn-number">7</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
</code></pre>
<h2 id="basic-recursion-transitive-closure" node="[object Object]">Basic Recursion: Transitive Closure</h2>
<h3 id="the-problem" node="[object Object]">The Problem</h3>
<p>Given edges, find all pairs (X, Y) where you can get from X to Y through any path.</p>
<h3 id="non-recursive-attempt-limited" node="[object Object]">Non-Recursive Attempt (Limited)</h3>
<p>You could try explicit path lengths:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Direct edges (length 1)</span>
<span class="syn-arith">+</span><span class="syn-identifier">path1</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// Length 2</span>
<span class="syn-arith">+</span><span class="syn-identifier">path2</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Z</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// Length 3</span>
<span class="syn-arith">+</span><span class="syn-identifier">path3</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">path2</span><span class="syn-punct">(</span><span class="syn-variable">Z</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
</code></pre>
<p>But this only works for paths up to length 3. What about longer paths?</p>
<h3 id="recursive-solution" node="[object Object]">Recursive Solution</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Base case: direct edges are paths</span>
<span class="syn-arith">+</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// Recursive case: if X can reach Z, and Z has an edge to Y, then X can reach Y</span>
<span class="syn-arith">+</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<p>Query:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-query">?</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<p>Result:</p>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">1</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">X</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">2</td></tr><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">3</td></tr><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">4</td></tr><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">5</td></tr><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">6</td></tr><tr><td class="border px-4 py-2" node="[object Object]">1</td><td class="border px-4 py-2" node="[object Object]">7</td></tr></tbody></table></div>
<p><em>6 rows</em></p>
<p>Node 1 can reach all other nodes!</p>
<h3 id="how-recursion-works" node="[object Object]">How Recursion Works</h3>
<p>InputLayer evaluates recursive rules using <em>fixpoint iteration</em>:</p>
<ol>
<li>
<p><strong>Iteration 0</strong>: Compute base case (direct edges)</p>
<ul>
<li>reachable = {(1,2), (2,3), (3,4), (1,5), (2,6), (5,6), (6,7)}</li>
</ul>
</li>
<li>
<p><strong>Iteration 1</strong>: Apply recursive rule</p>
<ul>
<li>From (1,2) and edge(2,3): add (1,3)</li>
<li>From (1,2) and edge(2,6): add (1,6)</li>
<li>From (2,3) and edge(3,4): add (2,4)</li>
<li>... and so on</li>
</ul>
</li>
<li>
<p><strong>Iteration 2</strong>: Continue until no new facts</p>
<ul>
<li>From (1,3) and edge(3,4): add (1,4)</li>
<li>...</li>
</ul>
</li>
<li>
<p><strong>Fixpoint</strong>: When no new facts are derived, we&#x27;re done</p>
</li>
</ol>
<h2 id="left-vs-right-recursion" node="[object Object]">Left vs Right Recursion</h2>
<h3 id="left-recursion-preferred" node="[object Object]">Left Recursion (Preferred)</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">reach_left</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">reach_left</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reach_left</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<p>The recursive call is on the <strong>left</strong> side of the join.</p>
<h3 id="right-recursion" node="[object Object]">Right Recursion</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">reach_right</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">reach_right</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">reach_right</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<p>The recursive call is on the <strong>right</strong> side.</p>
<p><strong>Both work</strong> in InputLayer. Choose whichever reads more naturally for your use case.</p>
<h2 id="mutual-recursion" node="[object Object]">Mutual Recursion</h2>
<p>Rules can reference each other:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Odd-length paths from node 1</span>
<span class="syn-arith">+</span><span class="syn-identifier">odd_path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">odd_path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">even_path</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// Even-length paths from node 1</span>
<span class="syn-arith">+</span><span class="syn-identifier">even_path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">odd_path</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<p>These rules depend on each other and are computed together.</p>
<h2 id="practical-examples" node="[object Object]">Practical Examples</h2>
<h3 id="example-1-ancestordescendant" node="[object Object]">Example 1: Ancestor/Descendant</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Family tree</span>
<span class="syn-arith">+</span><span class="syn-identifier">parent</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">4</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">5</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">6</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
<span class="syn-comment">// 1 is parent of 2, 3; 2 is parent of 4, 5; 3 is parent of 6</span>

<span class="syn-comment">// Ancestor relationship</span>
<span class="syn-arith">+</span><span class="syn-identifier">ancestor</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">parent</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">ancestor</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">parent</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">ancestor</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<p>Query: Who are person 1&#x27;s descendants?</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-query">?</span><span class="syn-identifier">ancestor</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-variable">Desc</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="example-2-same-generation" node="[object Object]">Example 2: Same Generation</h3>
<p>Find all pairs at the same generation level:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Root nodes (no parents)</span>
<span class="syn-arith">+</span><span class="syn-identifier">root</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">node</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">parent</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// Generation level</span>
<span class="syn-arith">+</span><span class="syn-identifier">generation</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-number">0</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">root</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">generation</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">N</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">parent</span><span class="syn-punct">(</span><span class="syn-variable">P</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">generation</span><span class="syn-punct">(</span><span class="syn-variable">P</span><span class="syn-punct">,</span> <span class="syn-variable">M</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">N</span> <span class="syn-comparison">=</span> <span class="syn-variable">M</span> <span class="syn-arith">+</span> <span class="syn-number">1</span>

<span class="syn-comment">// Same generation</span>
<span class="syn-arith">+</span><span class="syn-identifier">same_gen</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">generation</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">N</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">generation</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">N</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">!=</span> <span class="syn-variable">Y</span>
</code></pre>
<h3 id="example-3-connected-components" node="[object Object]">Example 3: Connected Components</h3>
<p>Find which nodes are in the same connected component:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Symmetric edges for undirected graph</span>
<span class="syn-arith">+</span><span class="syn-identifier">sym_edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">sym_edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// Same component (connected)</span>
<span class="syn-arith">+</span><span class="syn-identifier">same_component</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">node</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>  <span class="syn-comment">// Reflexive</span>
<span class="syn-arith">+</span><span class="syn-identifier">same_component</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">sym_edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">same_component</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">same_component</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">sym_edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="example-4-bill-of-materials" node="[object Object]">Example 4: Bill of Materials</h3>
<p>Classic manufacturing example - compute all parts needed:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Part containment: component(assembly, part, quantity)</span>
<span class="syn-arith">+</span><span class="syn-identifier">component</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">1</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">4</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">4</span><span class="syn-punct">,</span> <span class="syn-number">1</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">5</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">]</span>

<span class="syn-comment">// All parts required for an assembly (including nested)</span>
<span class="syn-arith">+</span><span class="syn-identifier">requires</span><span class="syn-punct">(</span><span class="syn-variable">Assembly</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">component</span><span class="syn-punct">(</span><span class="syn-variable">Assembly</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">requires</span><span class="syn-punct">(</span><span class="syn-variable">Assembly</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">component</span><span class="syn-punct">(</span><span class="syn-variable">Assembly</span><span class="syn-punct">,</span> <span class="syn-variable">SubAsm</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-body-id">requires</span><span class="syn-punct">(</span><span class="syn-variable">SubAsm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="recursion-with-aggregation" node="[object Object]">Recursion with Aggregation</h2>
<h3 id="recursive-sum" node="[object Object]">Recursive Sum</h3>
<p>Total quantity of each part needed (with multipliers):</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Direct quantity needed</span>
<span class="syn-arith">+</span><span class="syn-identifier">qty</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">Qty</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">component</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">Qty</span><span class="syn-punct">)</span>

<span class="syn-comment">// Transitive quantity (multiplied through levels)</span>
<span class="syn-arith">+</span><span class="syn-identifier">qty</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">TotalQty</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">component</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Sub</span><span class="syn-punct">,</span> <span class="syn-variable">SubQty</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-body-id">qty</span><span class="syn-punct">(</span><span class="syn-variable">Sub</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">PartQty</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-variable">TotalQty</span> <span class="syn-comparison">=</span> <span class="syn-variable">SubQty</span> <span class="syn-arith">*</span> <span class="syn-variable">PartQty</span>

<span class="syn-comment">// Sum all quantities per part</span>
<span class="syn-arith">+</span><span class="syn-identifier">total_qty</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-aggregate">sum</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Qty</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">qty</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">Qty</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="common-patterns" node="[object Object]">Common Patterns</h2>
<h3 id="pattern-1-transitive-closure" node="[object Object]">Pattern 1: Transitive Closure</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">base_relation</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">base_relation</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="pattern-2-reflexive-transitive-closure" node="[object Object]">Pattern 2: Reflexive-Transitive Closure</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">rt_closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">domain</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>  <span class="syn-comment">// Reflexive: X reaches itself</span>
<span class="syn-arith">+</span><span class="syn-identifier">rt_closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">base_relation</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">rt_closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">rt_closure</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">base_relation</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="pattern-3-inductive-definition" node="[object Object]">Pattern 3: Inductive Definition</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Base case</span>
<span class="syn-arith">+</span><span class="syn-identifier">inductive</span><span class="syn-punct">(</span><span class="syn-number">0</span><span class="syn-punct">,</span> <span class="syn-string">"base"</span><span class="syn-punct">)</span>

<span class="syn-comment">// Inductive step</span>
<span class="syn-arith">+</span><span class="syn-identifier">inductive</span><span class="syn-punct">(</span><span class="syn-variable">N</span><span class="syn-punct">,</span> <span class="syn-string">"derived"</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">inductive</span><span class="syn-punct">(</span><span class="syn-variable">M</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-variable">N</span> <span class="syn-comparison">=</span> <span class="syn-variable">M</span> <span class="syn-arith">+</span> <span class="syn-number">1</span><span class="syn-punct">,</span>
  <span class="syn-variable">N</span> <span class="syn-comparison">&lt;</span> <span class="syn-number">10</span>
</code></pre>
<h3 id="pattern-4-graph-algorithms" node="[object Object]">Pattern 4: Graph Algorithms</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Node with maximum reachability</span>
<span class="syn-arith">+</span><span class="syn-identifier">reach_count</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-aggregate">count</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Y</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">max_reach</span><span class="syn-punct">(</span><span class="syn-aggregate">max</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Count</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reach_count</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Count</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">most_connected</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reach_count</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">C</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">max_reach</span><span class="syn-punct">(</span><span class="syn-variable">C</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="debugging-recursion" node="[object Object]">Debugging Recursion</h2>
<h3 id="check-intermediate-results" node="[object Object]">Check Intermediate Results</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Query the recursive relation directly</span>
<span class="syn-query">?</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// See how many facts are derived</span>
<span class="syn-identifier">count_reachable</span><span class="syn-punct">(</span><span class="syn-aggregate">count</span><span class="syn-comparison">&lt;</span><span class="syn-variable">X</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
<span class="syn-query">?</span><span class="syn-identifier">count_reachable</span><span class="syn-punct">(</span><span class="syn-variable">N</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="limit-depth-for-testing" node="[object Object]">Limit Depth for Testing</h3>
<p>For debugging, you can create bounded versions:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">reach1</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">reach2</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reach1</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">reach2</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reach1</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
<span class="syn-comment">// etc.</span>
</code></pre>
<h2 id="performance-considerations" node="[object Object]">Performance Considerations</h2>
<ol>
<li><strong>Minimize joins</strong> in recursive rules when possible</li>
<li><strong>Use constraints early</strong> to prune the search space</li>
<li><strong>Magic Sets</strong> optimization automatically prunes recursive queries when constants are provided (e.g., <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">?reachable(1, X)</code>)</li>
</ol>
<h2 id="exercises" node="[object Object]">Exercises</h2>
<ol>
<li>Write a rule to find all cycles in the graph (nodes that can reach themselves)</li>
<li>Compute the length of the longest path from node 1</li>
<li>Find nodes that have exactly 2 ancestors</li>
<li>Write rules to detect if a graph is a DAG (directed acyclic graph)</li>
</ol>
<h2 id="next-steps" node="[object Object]">Next Steps</h2>
<ul>
<li><strong><a href="vectors" target="_blank" rel="noopener noreferrer" node="[object Object]">Vectors</a></strong> - Vector search and similarity queries</li>
<li><strong><a href="temporal" target="_blank" rel="noopener noreferrer" node="[object Object]">Temporal</a></strong> - Time-based reasoning and decay functions</li>
</ul></article></div><div class="hidden lg:block w-48 shrink-0 border-l border-border/50"><div class="sticky top-0 p-4"><p class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">On this page</p><nav class="space-y-1"><a href="#prerequisites" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Prerequisites</a><a href="#what-is-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">What is Recursion?</a><a href="#setup" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Setup</a><a href="#basic-recursion-transitive-closure" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Basic Recursion: Transitive Closure</a><a href="#the-problem" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">The Problem</a><a href="#non-recursive-attempt-limited" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Non-Recursive Attempt (Limited)</a><a href="#recursive-solution" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Recursive Solution</a><a href="#how-recursion-works" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">How Recursion Works</a><a href="#left-vs-right-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Left vs Right Recursion</a><a href="#left-recursion-preferred" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Left Recursion (Preferred)</a><a href="#right-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Right Recursion</a><a href="#mutual-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Mutual Recursion</a><a href="#practical-examples" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Practical Examples</a><a href="#example-1-ancestordescendant" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Example 1: Ancestor/Descendant</a><a href="#example-2-same-generation" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Example 2: Same Generation</a><a href="#example-3-connected-components" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Example 3: Connected Components</a><a href="#example-4-bill-of-materials" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Example 4: Bill of Materials</a><a href="#recursion-with-aggregation" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Recursion with Aggregation</a><a href="#recursive-sum" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Recursive Sum</a><a href="#common-patterns" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Common Patterns</a><a href="#pattern-1-transitive-closure" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Pattern 1: Transitive Closure</a><a href="#pattern-2-reflexive-transitive-closure" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Pattern 2: Reflexive-Transitive Closure</a><a href="#pattern-3-inductive-definition" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Pattern 3: Inductive Definition</a><a href="#pattern-4-graph-algorithms" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Pattern 4: Graph Algorithms</a><a href="#debugging-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Debugging Recursion</a><a href="#check-intermediate-results" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Check Intermediate Results</a><a href="#limit-depth-for-testing" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Limit Depth for Testing</a><a href="#performance-considerations" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Performance Considerations</a><a href="#exercises" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Exercises</a><a href="#next-steps" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Next Steps</a></nav></div></div></div></div></div></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1942,[\"177\",\"static/chunks/app/layout-7e9963bf811be36b.js\"],\"ThemeProvider\"]\n3:I[7121,[],\"\"]\n4:I[4581,[],\"\"]\n6:I[484,[],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[484,[],\"ViewportBoundary\"]\nb:I[484,[],\"MetadataBoundary\"]\nd:I[7123,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4bd7a24b7976d4e6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"05bjYGyiAumoEMBrfWHih\",\"c\":[\"\",\"docs\",\"guides\",\"recursion\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"guides/recursion\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4bd7a24b7976d4e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 font-sans antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[8428,[\"758\",\"static/chunks/758-3cb69ce377cde046.js\",\"121\",\"static/chunks/121-aece4f809b101dc1.js\",\"502\",\"static/chunks/502-e809071f8789437b.js\",\"689\",\"static/chunks/689-4fcf9680fdc90283.js\",\"870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js\"],\"DocsPageClient\"]\nf:T1aed,"])</script><script>self.__next_f.push([1,"# Tutorial: Recursion\n\nRecursive rules let you express transitive closure, reachability, and graph algorithms that would require loops or CTEs in SQL.\n\n## Prerequisites\n\n- Completed [Your First Program](first-program)\n- Understanding of [Core Concepts](core-concepts)\n\n## What is Recursion?\n\nA recursive rule references itself in its body. This allows computing things that require an unknown number of steps, like:\n\n- All nodes reachable from a starting point\n- Transitive relationships (ancestor/descendant)\n- Fixed-point computations\n\n## Setup\n\n```datalog\n.kg create recursion_tutorial\n.kg use recursion_tutorial\n\n// A simple directed graph\n//     1 -\u003e 2 -\u003e 3 -\u003e 4\n//     |   |\n//     5 -\u003e 6 -\u003e 7\n\n+edge[(1, 2), (2, 3), (3, 4),\n      (1, 5), (2, 6), (5, 6), (6, 7)]\n```\n\n## Basic Recursion: Transitive Closure\n\n### The Problem\n\nGiven edges, find all pairs (X, Y) where you can get from X to Y through any path.\n\n### Non-Recursive Attempt (Limited)\n\nYou could try explicit path lengths:\n\n```datalog\n// Direct edges (length 1)\n+path1(X, Y) \u003c- edge(X, Y)\n\n// Length 2\n+path2(X, Y) \u003c- edge(X, Z), edge(Z, Y)\n\n// Length 3\n+path3(X, Y) \u003c- edge(X, Z), path2(Z, Y)\n```\n\nBut this only works for paths up to length 3. What about longer paths?\n\n### Recursive Solution\n\n```datalog\n// Base case: direct edges are paths\n+reachable(X, Y) \u003c- edge(X, Y)\n\n// Recursive case: if X can reach Z, and Z has an edge to Y, then X can reach Y\n+reachable(X, Z) \u003c- reachable(X, Y), edge(Y, Z)\n```\n\nQuery:\n```datalog\n?reachable(1, X)\n```\n\nResult:\n\n| 1 | X |\n|---|---|\n| 1 | 2 |\n| 1 | 3 |\n| 1 | 4 |\n| 1 | 5 |\n| 1 | 6 |\n| 1 | 7 |\n\n*6 rows*\n\nNode 1 can reach all other nodes!\n\n### How Recursion Works\n\nInputLayer evaluates recursive rules using *fixpoint iteration*:\n\n1. **Iteration 0**: Compute base case (direct edges)\n   - reachable = {(1,2), (2,3), (3,4), (1,5), (2,6), (5,6), (6,7)}\n\n2. **Iteration 1**: Apply recursive rule\n   - From (1,2) and edge(2,3): add (1,3)\n   - From (1,2) and edge(2,6): add (1,6)\n   - From (2,3) and edge(3,4): add (2,4)\n   - ... and so on\n\n3. **Iteration 2**: Continue until no new facts\n   - From (1,3) and edge(3,4): add (1,4)\n   - ...\n\n4. **Fixpoint**: When no new facts are derived, we're done\n\n## Left vs Right Recursion\n\n### Left Recursion (Preferred)\n\n```datalog\n+reach_left(X, Y) \u003c- edge(X, Y)\n+reach_left(X, Z) \u003c- reach_left(X, Y), edge(Y, Z)\n```\n\nThe recursive call is on the **left** side of the join.\n\n### Right Recursion\n\n```datalog\n+reach_right(X, Y) \u003c- edge(X, Y)\n+reach_right(X, Z) \u003c- edge(X, Y), reach_right(Y, Z)\n```\n\nThe recursive call is on the **right** side.\n\n**Both work** in InputLayer. Choose whichever reads more naturally for your use case.\n\n## Mutual Recursion\n\nRules can reference each other:\n\n```datalog\n// Odd-length paths from node 1\n+odd_path(X) \u003c- edge(1, X)\n+odd_path(X) \u003c- even_path(Y), edge(Y, X)\n\n// Even-length paths from node 1\n+even_path(X) \u003c- odd_path(Y), edge(Y, X)\n```\n\nThese rules depend on each other and are computed together.\n\n## Practical Examples\n\n### Example 1: Ancestor/Descendant\n\n```datalog\n// Family tree\n+parent[(1, 2), (1, 3), (2, 4), (2, 5), (3, 6)]\n// 1 is parent of 2, 3; 2 is parent of 4, 5; 3 is parent of 6\n\n// Ancestor relationship\n+ancestor(X, Y) \u003c- parent(X, Y)\n+ancestor(X, Z) \u003c- parent(X, Y), ancestor(Y, Z)\n```\n\nQuery: Who are person 1's descendants?\n```datalog\n?ancestor(1, Desc)\n```\n\n### Example 2: Same Generation\n\nFind all pairs at the same generation level:\n\n```datalog\n// Root nodes (no parents)\n+root(X) \u003c- node(X), !parent(_, X)\n\n// Generation level\n+generation(X, 0) \u003c- root(X)\n+generation(X, N) \u003c- parent(P, X), generation(P, M), N = M + 1\n\n// Same generation\n+same_gen(X, Y) \u003c- generation(X, N), generation(Y, N), X != Y\n```\n\n### Example 3: Connected Components\n\nFind which nodes are in the same connected component:\n\n```datalog\n// Symmetric edges for undirected graph\n+sym_edge(X, Y) \u003c- edge(X, Y)\n+sym_edge(X, Y) \u003c- edge(Y, X)\n\n// Same component (connected)\n+same_component(X, X) \u003c- node(X)  // Reflexive\n+same_component(X, Y) \u003c- sym_edge(X, Y)\n+same_component(X, Z) \u003c- same_component(X, Y), sym_edge(Y, Z)\n```\n\n### Example 4: Bill of Materials\n\nClassic manufacturing example - compute all parts needed:\n\n```datalog\n// Part containment: component(assembly, part, quantity)\n+component[(1, 2, 1), (1, 3, 2), (2, 4, 3), (3, 4, 1), (3, 5, 2)]\n\n// All parts required for an assembly (including nested)\n+requires(Assembly, Part) \u003c- component(Assembly, Part, _)\n+requires(Assembly, Part) \u003c-\n  component(Assembly, SubAsm, _),\n  requires(SubAsm, Part)\n```\n\n## Recursion with Aggregation\n\n### Recursive Sum\n\nTotal quantity of each part needed (with multipliers):\n\n```datalog\n// Direct quantity needed\n+qty(Asm, Part, Qty) \u003c- component(Asm, Part, Qty)\n\n// Transitive quantity (multiplied through levels)\n+qty(Asm, Part, TotalQty) \u003c-\n  component(Asm, Sub, SubQty),\n  qty(Sub, Part, PartQty),\n  TotalQty = SubQty * PartQty\n\n// Sum all quantities per part\n+total_qty(Asm, Part, sum\u003cQty\u003e) \u003c- qty(Asm, Part, Qty)\n```\n\n## Common Patterns\n\n### Pattern 1: Transitive Closure\n\n```datalog\n+closure(X, Y) \u003c- base_relation(X, Y)\n+closure(X, Z) \u003c- closure(X, Y), base_relation(Y, Z)\n```\n\n### Pattern 2: Reflexive-Transitive Closure\n\n```datalog\n+rt_closure(X, X) \u003c- domain(X)  // Reflexive: X reaches itself\n+rt_closure(X, Y) \u003c- base_relation(X, Y)\n+rt_closure(X, Z) \u003c- rt_closure(X, Y), base_relation(Y, Z)\n```\n\n### Pattern 3: Inductive Definition\n\n```datalog\n// Base case\n+inductive(0, \"base\")\n\n// Inductive step\n+inductive(N, \"derived\") \u003c-\n  inductive(M, _),\n  N = M + 1,\n  N \u003c 10\n```\n\n### Pattern 4: Graph Algorithms\n\n```datalog\n// Node with maximum reachability\n+reach_count(X, count\u003cY\u003e) \u003c- reachable(X, Y)\n+max_reach(max\u003cCount\u003e) \u003c- reach_count(_, Count)\n+most_connected(X) \u003c- reach_count(X, C), max_reach(C)\n```\n\n## Debugging Recursion\n\n### Check Intermediate Results\n\n```datalog\n// Query the recursive relation directly\n?reachable(X, Y)\n\n// See how many facts are derived\ncount_reachable(count\u003cX\u003e) \u003c- reachable(X, _)\n?count_reachable(N)\n```\n\n### Limit Depth for Testing\n\nFor debugging, you can create bounded versions:\n\n```datalog\n+reach1(X, Y) \u003c- edge(X, Y)\n+reach2(X, Y) \u003c- reach1(X, Y)\n+reach2(X, Z) \u003c- reach1(X, Y), edge(Y, Z)\n// etc.\n```\n\n## Performance Considerations\n\n1. **Minimize joins** in recursive rules when possible\n2. **Use constraints early** to prune the search space\n3. **Magic Sets** optimization automatically prunes recursive queries when constants are provided (e.g., `?reachable(1, X)`)\n\n## Exercises\n\n1. Write a rule to find all cycles in the graph (nodes that can reach themselves)\n2. Compute the length of the longest path from node 1\n3. Find nodes that have exactly 2 ancestors\n4. Write rules to detect if a graph is a DAG (directed acyclic graph)\n\n## Next Steps\n\n- **[Vectors](vectors)** - Vector search and similarity queries\n- **[Temporal](temporal)** - Time-based reasoning and decay functions"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Le\",null,{\"page\":{\"title\":\"Tutorial: Recursion\",\"content\":\"$f\",\"toc\":[{\"level\":2,\"text\":\"Prerequisites\",\"id\":\"prerequisites\"},{\"level\":2,\"text\":\"What is Recursion?\",\"id\":\"what-is-recursion\"},{\"level\":2,\"text\":\"Setup\",\"id\":\"setup\"},{\"level\":2,\"text\":\"Basic Recursion: Transitive Closure\",\"id\":\"basic-recursion-transitive-closure\"},{\"level\":3,\"text\":\"The Problem\",\"id\":\"the-problem\"},{\"level\":3,\"text\":\"Non-Recursive Attempt (Limited)\",\"id\":\"non-recursive-attempt-limited\"},{\"level\":3,\"text\":\"Recursive Solution\",\"id\":\"recursive-solution\"},{\"level\":3,\"text\":\"How Recursion Works\",\"id\":\"how-recursion-works\"},{\"level\":2,\"text\":\"Left vs Right Recursion\",\"id\":\"left-vs-right-recursion\"},{\"level\":3,\"text\":\"Left Recursion (Preferred)\",\"id\":\"left-recursion-preferred\"},{\"level\":3,\"text\":\"Right Recursion\",\"id\":\"right-recursion\"},{\"level\":2,\"text\":\"Mutual Recursion\",\"id\":\"mutual-recursion\"},{\"level\":2,\"text\":\"Practical Examples\",\"id\":\"practical-examples\"},{\"level\":3,\"text\":\"Example 1: Ancestor/Descendant\",\"id\":\"example-1-ancestordescendant\"},{\"level\":3,\"text\":\"Example 2: Same Generation\",\"id\":\"example-2-same-generation\"},{\"level\":3,\"text\":\"Example 3: Connected Components\",\"id\":\"example-3-connected-components\"},{\"level\":3,\"text\":\"Example 4: Bill of Materials\",\"id\":\"example-4-bill-of-materials\"},{\"level\":2,\"text\":\"Recursion with Aggregation\",\"id\":\"recursion-with-aggregation\"},{\"level\":3,\"text\":\"Recursive Sum\",\"id\":\"recursive-sum\"},{\"level\":2,\"text\":\"Common Patterns\",\"id\":\"common-patterns\"},{\"level\":3,\"text\":\"Pattern 1: Transitive Closure\",\"id\":\"pattern-1-transitive-closure\"},{\"level\":3,\"text\":\"Pattern 2: Reflexive-Transitive Closure\",\"id\":\"pattern-2-reflexive-transitive-closure\"},{\"level\":3,\"text\":\"Pattern 3: Inductive Definition\",\"id\":\"pattern-3-inductive-definition\"},{\"level\":3,\"text\":\"Pattern 4: Graph Algorithms\",\"id\":\"pattern-4-graph-algorithms\"},{\"level\":2,\"text\":\"Debugging Recursion\",\"id\":\"debugging-recursion\"},{\"level\":3,\"text\":\"Check Intermediate Results\",\"id\":\"check-intermediate-results\"},{\"level\":3,\"text\":\"Limit Depth for Testing\",\"id\":\"limit-depth-for-testing\"},{\"level\":2,\"text\":\"Performance Considerations\",\"id\":\"performance-considerations\"},{\"level\":2,\"text\":\"Exercises\",\"id\":\"exercises\"},{\"level\":2,\"text\":\"Next Steps\",\"id\":\"next-steps\"}]},\"slugKey\":\"guides/recursion\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[6869,[],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"InputLayer - A symbolic reasoning engine for AI agents\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.svg\"}],[\"$\",\"$L10\",\"3\",{}]]\n8:null\n"])</script></body></html>