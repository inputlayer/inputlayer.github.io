<!DOCTYPE html><!--05bjYGyiAumoEMBrfWHih--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4bd7a24b7976d4e6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js"/><script src="/_next/static/chunks/4bd1b696-deba172d32c79f82.js" async=""></script><script src="/_next/static/chunks/794-275dc9ebd3a29fbf.js" async=""></script><script src="/_next/static/chunks/main-app-1fa5b694e5d36a75.js" async=""></script><script src="/_next/static/chunks/app/layout-7e9963bf811be36b.js" async=""></script><script src="/_next/static/chunks/758-3cb69ce377cde046.js" async=""></script><script src="/_next/static/chunks/121-aece4f809b101dc1.js" async=""></script><script src="/_next/static/chunks/502-e809071f8789437b.js" async=""></script><script src="/_next/static/chunks/689-4fcf9680fdc90283.js" async=""></script><script src="/_next/static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js" async=""></script><meta name="next-size-adjust" content=""/><title>InputLayer - A symbolic reasoning engine for AI agents</title><meta name="description" content="Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."/><link rel="icon" href="/icon.svg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="flex flex-col h-dvh"><header class="sticky top-0 z-50 w-full border-b border-border/50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="flex h-14 items-center px-6"><a class="mr-8" href="/"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-lg">InputLayer</span></span></a><nav class="hidden md:flex items-center gap-6 text-sm"><a class="text-muted-foreground transition-colors hover:text-foreground" href="/docs/">Docs</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/blog/">Blog</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/use-cases/">Use Cases</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/compare/">Compare</a><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></nav><div class="ml-auto flex items-center gap-3"><div class="inline-flex items-center gap-1.5"><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-3.5 w-3.5"><path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path></svg><span>Star</span></a><a href="https://github.com/inputlayer/inputlayer/fork" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-fork h-3.5 w-3.5"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg><span>Fork</span></a></div><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9 h-9 w-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-4 w-4"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></button><div class="md:hidden"><button class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></header><div class="flex flex-1 overflow-hidden"><div class="w-64 shrink-0 border-r border-border/50 overflow-y-auto"><div class="flex flex-col h-full"><div class="p-3 border-b border-border/50"><div class="relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><input type="text" placeholder="Search docs..." class="w-full h-8 pl-8 pr-3 text-sm rounded-md border border-border bg-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring" value=""/></div></div><nav class="flex-1 overflow-y-auto p-2 space-y-0.5"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" href="/docs/index/">Overview</a><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_j6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Guides</button><div data-state="closed" id="radix-_R_j6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_r6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Reference</button><div data-state="closed" id="radix-_R_r6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_136av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Specification</button><div data-state="closed" id="radix-_R_136av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="open" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-foreground font-medium" style="padding-left:12px" type="button" aria-controls="radix-_R_1b6av5ubtb_" aria-expanded="true" data-state="open" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform rotate-90"><path d="m9 18 6-6-6-6"></path></svg>Internals</button><div data-state="open" id="radix-_R_1b6av5ubtb_" data-slot="collapsible-content"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/index/">Overview</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/architecture/">Architecture</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/coding-standards/">Coding Standards</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors bg-primary/10 text-primary font-medium" style="padding-left:24px" href="/docs/internals/type-system/">Type System</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/validation/">Validation</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/record-syntax/">Record Syntax</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/internals/roadmap/">Roadmap</a></div></div></nav></div></div><div class="flex flex-1 flex-col overflow-hidden"><div class="flex flex-1 overflow-hidden"><div class="flex-1 overflow-y-auto px-8 py-6 max-w-4xl mx-auto"><article class="docs-prose"><h1 id="type-system-specification" node="[object Object]">Type System Specification</h1>
<p>This document specifies InputLayer&#x27;s type system for developers implementing or extending the language.</p>
<h2 id="overview" node="[object Object]">Overview</h2>
<p>A program is a sequence of declarations:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">Decl       <span class="syn-operator">::=</span> TypeDecl <span class="syn-operator">|</span> SchemaDecl <span class="syn-operator">|</span> RuleDecl <span class="syn-operator">|</span> FactDecl</code></pre>
<ul>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">type</code> - defines <strong>value types</strong> (aliases, refinements, record types)</li>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name(col: type, ...)</code> - defines <strong>relation schemas</strong> with typed columns</li>
<li>Facts (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name[(...)]</code>) - provide <strong>base tuples</strong> for relations</li>
<li>Rules (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name(...) &lt;- body</code>) - define <strong>derived tuples</strong> for relations</li>
</ul>
<h2 id="1-type-declarations-object-object" node="[object Object]">1. Type Declarations (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">type</code>)</h2>
<h3 id="11-grammar" node="[object Object]">1.1 Grammar</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">TypeDecl   <span class="syn-operator">::=</span> <span class="syn-string">"type"</span> TypeName <span class="syn-string">":"</span> TypeExpr <span class="syn-string">"."</span>
TypeName   <span class="syn-operator">::=</span> UIdent          // capitalized, e.g. Email, User

TypeExpr   <span class="syn-operator">::=</span> SimpleType
             <span class="syn-operator">|</span> RecordType

SimpleType <span class="syn-operator">::=</span> BaseType <span class="syn-punct">[</span>Refinements<span class="syn-punct">]</span>
BaseType   <span class="syn-operator">::=</span> <span class="syn-string">"int"</span> <span class="syn-operator">|</span> <span class="syn-string">"string"</span> <span class="syn-operator">|</span> <span class="syn-string">"bool"</span>
             <span class="syn-operator">|</span> <span class="syn-string">"list"</span> <span class="syn-string">"["</span> TypeExpr <span class="syn-string">"]"</span>
             <span class="syn-operator">|</span> TypeName         // previously declared type

RecordType <span class="syn-operator">::=</span> <span class="syn-string">"{"</span> FieldList <span class="syn-string">"}"</span>
 FieldList  <span class="syn-operator">::=</span> Field <span class="syn-punct">(</span><span class="syn-string">","</span> Field<span class="syn-punct">)</span>*
Field      <span class="syn-operator">::=</span> FieldName <span class="syn-string">":"</span> TypeExpr

 FieldName  <span class="syn-operator">::=</span> LIdent

Refinements <span class="syn-operator">::=</span> <span class="syn-string">"("</span> Refinement <span class="syn-punct">(</span><span class="syn-string">","</span> Refinement<span class="syn-punct">)</span>* <span class="syn-string">")"</span>
Refinement  <span class="syn-operator">::=</span> Ident <span class="syn-string">"("</span> ... <span class="syn-string">")"</span>   // opaque to the core language</code></pre>
<h3 id="12-semantics" node="[object Object]">1.2 Semantics</h3>
<p>A <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">type</code> declaration introduces a <strong>value type</strong>. Types describe the <strong>shape and constraints of values</strong> but <strong>do not define relations</strong> by themselves.</p>
<h3 id="13-aliases-and-refinements" node="[object Object]">1.3 Aliases and Refinements</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-keyword">type</span> <span class="syn-variable">Email</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">(</span><span class="syn-identifier">pattern</span><span class="syn-punct">(</span><span class="syn-string">"^[^@]+@[^@]+$"</span><span class="syn-punct">)</span><span class="syn-punct">)</span>
<span class="syn-keyword">type</span> <span class="syn-variable">Id</span><span class="syn-punct">:</span>    <span class="syn-keyword">int</span><span class="syn-punct">(</span><span class="syn-identifier">range</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">1000000</span><span class="syn-punct">)</span><span class="syn-punct">)</span>
<span class="syn-keyword">type</span> <span class="syn-variable">Tags</span><span class="syn-punct">:</span>  <span class="syn-keyword">list</span><span class="syn-punct">[</span><span class="syn-keyword">string</span><span class="syn-punct">]</span><span class="syn-punct">(</span><span class="syn-identifier">not_empty</span><span class="syn-punct">)</span>
</code></pre>
<p>Interpretation as refinement types:</p>
<ul>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Email</code> is a subset of <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">string</code></li>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Id</code> is a subset of <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">int</code></li>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Tags</code> is a subset of <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">list[string]</code></li>
</ul>
<p>Typing judgment:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">G |- v : Email  =&gt;  G |- v : string  and  v satisfies pattern(&quot;^[^@]+@[^@]+$&quot;)
</code></pre>
<p>The semantics of refinements (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">pattern</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">range</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">not_empty</code>, ...) are implementation-defined.</p>
<h3 id="14-record-types" node="[object Object]">1.4 Record Types</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-keyword">type</span> <span class="syn-variable">User</span><span class="syn-punct">:</span> <span class="syn-punct">{</span>
    <span class="syn-identifier">id</span><span class="syn-punct">:</span>      <span class="syn-variable">Id</span><span class="syn-punct">,</span>
    <span class="syn-identifier">name</span><span class="syn-punct">:</span>    <span class="syn-keyword">string</span><span class="syn-punct">(</span><span class="syn-identifier">not_empty</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
    <span class="syn-identifier">email</span><span class="syn-punct">:</span>   <span class="syn-variable">Email</span><span class="syn-punct">,</span>
    <span class="syn-identifier">my_tags</span><span class="syn-punct">:</span> <span class="syn-variable">Tags</span>
<span class="syn-punct">}</span>
</code></pre>
<p>A <strong>record type</strong> <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">{ f1 : t1, ..., fn : tn }</code> is the type of records with named fields <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">fi</code> of types <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">ti</code>.</p>
<p>Important:</p>
<ul>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">User</code> is a <strong>value type</strong></li>
<li>A single <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">User</code> value is a record with 4 fields</li>
<li>This is <em>not</em> yet a relation; it&#x27;s just a value type</li>
</ul>
<h2 id="2-schema-declarations" node="[object Object]">2. Schema Declarations</h2>
<p>A <strong>relation schema</strong> declares the structure of a relation (like a table).</p>
<h3 id="21-grammar" node="[object Object]">2.1 Grammar</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">SchemaDecl <span class="syn-operator">::=</span> <span class="syn-string">"+"</span> RelName <span class="syn-string">"("</span> ParamList <span class="syn-string">")"</span> <span class="syn-string">"."</span>

RelName    <span class="syn-operator">::=</span> LIdent           // e.g. user, high_spender

ParamList  <span class="syn-operator">::=</span> Param <span class="syn-punct">(</span><span class="syn-string">","</span> Param<span class="syn-punct">)</span>*
Param      <span class="syn-operator">::=</span> ParamName <span class="syn-string">":"</span> TypeExpr <span class="syn-punct">[</span>Annotations<span class="syn-punct">]</span>
ParamName  <span class="syn-operator">::=</span> LIdent

Annotations <span class="syn-operator">::=</span> Annotation+
Annotation  <span class="syn-operator">::=</span> <span class="syn-string">"@"</span> AnnotName
 AnnotName   <span class="syn-operator">::=</span> <span class="syn-string">"key"</span> <span class="syn-operator">|</span> <span class="syn-string">"unique"</span> <span class="syn-operator">|</span> <span class="syn-string">"not_empty"</span> <span class="syn-operator">|</span> ...</code></pre>
<h3 id="22-schema-declaration" node="[object Object]">2.2 Schema Declaration</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">(</span>
    <span class="syn-identifier">id</span><span class="syn-punct">:</span>      <span class="syn-keyword">int</span><span class="syn-punct">,</span>
    <span class="syn-identifier">name</span><span class="syn-punct">:</span>    <span class="syn-keyword">string</span><span class="syn-punct">,</span>
    <span class="syn-identifier">email</span><span class="syn-punct">:</span>   <span class="syn-keyword">string</span>
<span class="syn-punct">)</span>
</code></pre>
<p>This declares a 3-ary relation:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">user : int x string x string -&gt; Bool
</code></pre>
<p>i.e. <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">user</code> is a subset of <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">int x string x string</code>.</p>
<p>Each parameter is a <strong>column</strong> in the relation.</p>
<h3 id="23-schema-with-type-references" node="[object Object]">2.3 Schema with Type References</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-keyword">type</span> <span class="syn-variable">Id</span><span class="syn-punct">:</span>    <span class="syn-keyword">int</span>
<span class="syn-keyword">type</span> <span class="syn-variable">Email</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span>

<span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">(</span><span class="syn-identifier">id</span><span class="syn-punct">:</span> <span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-identifier">name</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">,</span> <span class="syn-identifier">email</span><span class="syn-punct">:</span> <span class="syn-variable">Email</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="3-terms-and-expressions" node="[object Object]">3. Terms and Expressions</h2>
<h3 id="31-grammar" node="[object Object]">3.1 Grammar</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">Term       <span class="syn-operator">::=</span> Var
             <span class="syn-operator">|</span> Constant

Var        <span class="syn-operator">::=</span> LIdent <span class="syn-operator">|</span> UIdent</code></pre>
<p>Constants are implementation-defined (ints, strings, bools, lists, ...).</p>
<h2 id="4-atoms-facts-and-rules" node="[object Object]">4. Atoms, Facts, and Rules</h2>
<h3 id="41-atoms" node="[object Object]">4.1 Atoms</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">Atom        <span class="syn-operator">::=</span> RelName <span class="syn-string">"("</span> ArgList? <span class="syn-string">")"</span>
ArgList     <span class="syn-operator">::=</span> Arg <span class="syn-punct">(</span><span class="syn-string">","</span> Arg<span class="syn-punct">)</span>*
Arg         <span class="syn-operator">::=</span> Term</code></pre>
<p>Example (positional):</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-identifier">user</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-string">"Alice"</span><span class="syn-punct">,</span> <span class="syn-string">"alice@example.com"</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="42-facts" node="[object Object]">4.2 Facts</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">FactDecl    <span class="syn-operator">::=</span> <span class="syn-string">"+"</span> Atom <span class="syn-string">"."</span>
              <span class="syn-operator">|</span> <span class="syn-string">"+"</span> RelName <span class="syn-string">"["</span> TupleList <span class="syn-string">"]"</span> <span class="syn-string">"."</span></code></pre>
<p>Example:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-string">"Alice"</span><span class="syn-punct">,</span> <span class="syn-string">"alice@example.com"</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-string">"Bob"</span><span class="syn-punct">,</span> <span class="syn-string">"bob@example.com"</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-string">"Charlie"</span><span class="syn-punct">,</span> <span class="syn-string">"charlie@example.com"</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
</code></pre>
<h3 id="43-rules" node="[object Object]">4.3 Rules</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">RuleDecl    <span class="syn-operator">::=</span> <span class="syn-punct">[</span><span class="syn-string">"+"</span> <span class="syn-punct">]</span> HeadAtom <span class="syn-string">"&lt;-"</span> Body <span class="syn-string">"."</span>
HeadAtom    <span class="syn-operator">::=</span> RelName <span class="syn-string">"("</span> HeadArgList? <span class="syn-string">")"</span>
HeadArgList <span class="syn-operator">::=</span> HeadArg <span class="syn-punct">(</span><span class="syn-string">","</span> HeadArg<span class="syn-punct">)</span>*
HeadArg     <span class="syn-operator">::=</span> Term

Body        <span class="syn-operator">::=</span> BodyAtom <span class="syn-punct">(</span><span class="syn-string">","</span> BodyAtom<span class="syn-punct">)</span>*
 BodyAtom    <span class="syn-operator">::=</span> Atom <span class="syn-operator">|</span> Condition

Condition   <span class="syn-operator">::=</span> Term RelOp Term
RelOp       <span class="syn-operator">::=</span> <span class="syn-string">"="</span> <span class="syn-operator">|</span> <span class="syn-string">"!="</span> <span class="syn-operator">|</span> <span class="syn-string">"&lt;"</span> <span class="syn-operator">|</span> <span class="syn-string">"&gt;"</span> <span class="syn-operator">|</span> <span class="syn-string">"&lt;="</span> <span class="syn-operator">|</span> <span class="syn-string">"&gt;="</span></code></pre>
<h3 id="44-persistent-vs-session-rules" node="[object Object]">4.4 Persistent vs Session Rules</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Persistent rule (with + prefix) - stored and incrementally maintained</span>
<span class="syn-arith">+</span><span class="syn-identifier">admin_email</span><span class="syn-punct">(</span><span class="syn-variable">Email</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
    <span class="syn-body-id">user</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Email</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
    <span class="syn-body-id">admin</span><span class="syn-punct">(</span><span class="syn-variable">Email</span><span class="syn-punct">)</span>

<span class="syn-comment">// Session rule (no + prefix) - computed on-demand, not stored</span>
<span class="syn-identifier">temp_result</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">source</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">10</span>
</code></pre>
<h2 id="5-base-vs-derived-relations" node="[object Object]">5. Base vs Derived Relations</h2>
<ul>
<li><strong>Base data (EDB)</strong>: Relations populated via <strong>facts only</strong></li>
<li><strong>Derived data (IDB/views)</strong>: Relations populated via <strong>rules</strong></li>
</ul>
<p>Both are still just <strong>relations</strong>:</p>
<ul>
<li>Schema gives the structure</li>
<li>Facts and rules together define the relation&#x27;s <strong>extension</strong></li>
</ul>
<p>SQL analogy:</p>
<ul>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+user(...) + facts</code> is analogous to <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">CREATE TABLE user (...) + INSERT INTO user .</code></li>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+admin_email(...) + rules</code> is analogous to <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">CREATE VIEW admin_email AS SELECT .</code></li>
</ul>
<h2 id="6-persistent-rules-and-the-object-object-prefix" node="[object Object]">6. Persistent Rules and the <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code> Prefix</h2>
<h3 id="61-design-principles" node="[object Object]">6.1 Design Principles</h3>
<p>Clear separation of concerns:</p>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Syntax</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Purpose</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">DD Materialization</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Type Checking</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">type</code></td><td class="border px-4 py-2" node="[object Object]">Value type definitions</td><td class="border px-4 py-2" node="[object Object]">No</td><td class="border px-4 py-2" node="[object Object]">N/A</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name(col: type, ...)</code></td><td class="border px-4 py-2" node="[object Object]">Schema declaration</td><td class="border px-4 py-2" node="[object Object]"><strong>No</strong></td><td class="border px-4 py-2" node="[object Object]"><strong>Yes</strong></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name(...) &lt;- body</code></td><td class="border px-4 py-2" node="[object Object]">Persistent rule (DD view)</td><td class="border px-4 py-2" node="[object Object]"><strong>Yes</strong></td><td class="border px-4 py-2" node="[object Object]">Only if schema exists</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">name(...) &lt;- body</code></td><td class="border px-4 py-2" node="[object Object]">Session rule (transient)</td><td class="border px-4 py-2" node="[object Object]"><strong>No</strong></td><td class="border px-4 py-2" node="[object Object]">Only if schema exists</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code>/<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">-</code> (facts)</td><td class="border px-4 py-2" node="[object Object]">Base data manipulation</td><td class="border px-4 py-2" node="[object Object]">No</td><td class="border px-4 py-2" node="[object Object]">Only if schema exists</td></tr></tbody></table></div>
<h3 id="62-persistent-rule-grammar" node="[object Object]">6.2 Persistent Rule Grammar</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-ebnf text-sm">PersistentRule <span class="syn-operator">::=</span> <span class="syn-string">"+"</span> RuleName <span class="syn-string">"("</span> ParamList <span class="syn-string">")"</span> <span class="syn-string">"&lt;-"</span> Body <span class="syn-string">"."</span></code></pre>
<h3 id="63-session-rules" node="[object Object]">6.3 Session Rules</h3>
<p>Rules without <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code> prefix are <strong>session rules</strong>:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-identifier">temp_result</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">source</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">10</span>
</code></pre>
<ul>
<li>Computed on-demand during evaluation</li>
<li>NOT persisted or incrementally maintained</li>
<li>Useful for ad-hoc queries</li>
</ul>
<h2 id="7-implementation-notes" node="[object Object]">7. Implementation Notes</h2>
<h3 id="71-type-persistence" node="[object Object]">7.1 Type Persistence</h3>
<p>All typing information needs to be persisted on a database level. The server implements multiple databases where same-named types could have different semantic meanings.</p>
<h3 id="72-naming-conventions" node="[object Object]">7.2 Naming Conventions</h3>
<p>To avoid confusion between types and variables:</p>
<ul>
<li><strong>Types</strong>: <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">UIdent</code> (capitalized) - <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Email</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">User</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Purchase</code></li>
<li><strong>Variables</strong>: <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">LIdent</code> or <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">UIdent</code> - <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">e</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Email</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">user_id</code></li>
<li><strong>Relations</strong>: <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">LIdent</code> (lowercase) - <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">user</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">purchase</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">admin_email</code></li>
</ul>
<h3 id="73-command-vs-keyword-distinction" node="[object Object]">7.3 Command vs Keyword Distinction</h3>
<p>Do NOT confuse:</p>
<ul>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+name(col: type)</code> - Schema declaration syntax</li>
<li><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">.rel</code> meta command - REPL command to list/describe relations</li>
</ul>
<h2 id="8-complete-example" node="[object Object]">8. Complete Example</h2>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Type definitions</span>
<span class="syn-keyword">type</span> <span class="syn-variable">Id</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">(</span><span class="syn-identifier">range</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">1000000</span><span class="syn-punct">)</span><span class="syn-punct">)</span>
<span class="syn-keyword">type</span> <span class="syn-variable">Email</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">(</span><span class="syn-identifier">pattern</span><span class="syn-punct">(</span><span class="syn-string">"^[^@]+@[^@]+$"</span><span class="syn-punct">)</span><span class="syn-punct">)</span>

<span class="syn-comment">// Schema declarations</span>
<span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">(</span><span class="syn-identifier">id</span><span class="syn-punct">:</span> <span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-identifier">name</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">,</span> <span class="syn-identifier">email</span><span class="syn-punct">:</span> <span class="syn-variable">Email</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">purchase</span><span class="syn-punct">(</span><span class="syn-identifier">user_id</span><span class="syn-punct">:</span> <span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-identifier">amount</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">)</span>

<span class="syn-comment">// Base data</span>
<span class="syn-arith">+</span><span class="syn-identifier">user</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-string">"Alice"</span><span class="syn-punct">,</span> <span class="syn-string">"alice@example.com"</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-string">"Bob"</span><span class="syn-punct">,</span> <span class="syn-string">"bob@example.com"</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
<span class="syn-arith">+</span><span class="syn-identifier">purchase</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">1500</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">200</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">300</span><span class="syn-punct">)</span><span class="syn-punct">]</span>

<span class="syn-comment">// Persistent rule (explicit DD materialization)</span>
<span class="syn-arith">+</span><span class="syn-identifier">high_spender</span><span class="syn-punct">(</span><span class="syn-variable">UserId</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
    <span class="syn-body-id">purchase</span><span class="syn-punct">(</span><span class="syn-variable">UserId</span><span class="syn-punct">,</span> <span class="syn-variable">Amount</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
    <span class="syn-variable">Amount</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">1000</span>

<span class="syn-comment">// Session rule (not materialized, just computed on query)</span>
<span class="syn-identifier">temp</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">user</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">high_spender</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">)</span>

<span class="syn-comment">// Query</span>
<span class="syn-query">?</span><span class="syn-identifier">high_spender</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="9-type-checking-algorithm" node="[object Object]">9. Type Checking Algorithm</h2>
<h3 id="91-schema-lookup" node="[object Object]">9.1 Schema Lookup</h3>
<p>Given a rule:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">admin_email</span><span class="syn-punct">(</span><span class="syn-variable">Email</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">user</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Email</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">admin</span><span class="syn-punct">(</span><span class="syn-variable">Email</span><span class="syn-punct">)</span>
</code></pre>
<p>Type checking steps:</p>
<ol>
<li>Lookup schema: if <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+admin_email(email: Email)</code> exists, check arity matches</li>
<li>Check that variable types are consistent across the rule</li>
<li>Report type errors if mismatches found</li>
</ol>
<h3 id="92-variable-type-inference" node="[object Object]">9.2 Variable Type Inference</h3>
<p>Variables get their types from:</p>
<ol>
<li>Their position in atoms with declared schemas</li>
<li>Comparison with constants</li>
<li>Aggregation context</li>
</ol></article></div><div class="hidden lg:block w-48 shrink-0 border-l border-border/50"><div class="sticky top-0 p-4"><p class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">On this page</p><nav class="space-y-1"><a href="#overview" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Overview</a><a href="#1-type-declarations-type" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">1. Type Declarations (type)</a><a href="#11-grammar" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">1.1 Grammar</a><a href="#12-semantics" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">1.2 Semantics</a><a href="#13-aliases-and-refinements" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">1.3 Aliases and Refinements</a><a href="#14-record-types" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">1.4 Record Types</a><a href="#2-schema-declarations" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">2. Schema Declarations</a><a href="#21-grammar" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">2.1 Grammar</a><a href="#22-schema-declaration" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">2.2 Schema Declaration</a><a href="#23-schema-with-type-references" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">2.3 Schema with Type References</a><a href="#3-terms-and-expressions" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">3. Terms and Expressions</a><a href="#31-grammar" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">3.1 Grammar</a><a href="#4-atoms-facts-and-rules" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">4. Atoms, Facts, and Rules</a><a href="#41-atoms" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">4.1 Atoms</a><a href="#42-facts" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">4.2 Facts</a><a href="#43-rules" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">4.3 Rules</a><a href="#44-persistent-vs-session-rules" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">4.4 Persistent vs Session Rules</a><a href="#5-base-vs-derived-relations" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">5. Base vs Derived Relations</a><a href="#6-persistent-rules-and-the-prefix" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">6. Persistent Rules and the + Prefix</a><a href="#61-design-principles" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">6.1 Design Principles</a><a href="#62-persistent-rule-grammar" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">6.2 Persistent Rule Grammar</a><a href="#63-session-rules" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">6.3 Session Rules</a><a href="#7-implementation-notes" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">7. Implementation Notes</a><a href="#71-type-persistence" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">7.1 Type Persistence</a><a href="#72-naming-conventions" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">7.2 Naming Conventions</a><a href="#73-command-vs-keyword-distinction" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">7.3 Command vs Keyword Distinction</a><a href="#8-complete-example" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">8. Complete Example</a><a href="#9-type-checking-algorithm" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">9. Type Checking Algorithm</a><a href="#91-schema-lookup" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">9.1 Schema Lookup</a><a href="#92-variable-type-inference" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">9.2 Variable Type Inference</a></nav></div></div></div></div></div></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1942,[\"177\",\"static/chunks/app/layout-7e9963bf811be36b.js\"],\"ThemeProvider\"]\n3:I[7121,[],\"\"]\n4:I[4581,[],\"\"]\n6:I[484,[],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[484,[],\"ViewportBoundary\"]\nb:I[484,[],\"MetadataBoundary\"]\nd:I[7123,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4bd7a24b7976d4e6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"05bjYGyiAumoEMBrfWHih\",\"c\":[\"\",\"docs\",\"internals\",\"type-system\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"internals/type-system\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4bd7a24b7976d4e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 font-sans antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[8428,[\"758\",\"static/chunks/758-3cb69ce377cde046.js\",\"121\",\"static/chunks/121-aece4f809b101dc1.js\",\"502\",\"static/chunks/502-e809071f8789437b.js\",\"689\",\"static/chunks/689-4fcf9680fdc90283.js\",\"870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js\"],\"DocsPageClient\"]\nf:T1e12,"])</script><script>self.__next_f.push([1,"# Type System Specification\n\nThis document specifies InputLayer's type system for developers implementing or extending the language.\n\n## Overview\n\nA program is a sequence of declarations:\n\n```ebnf\nDecl       ::= TypeDecl | SchemaDecl | RuleDecl | FactDecl\n```\n\n- `type` - defines **value types** (aliases, refinements, record types)\n- `+name(col: type, ...)` - defines **relation schemas** with typed columns\n- Facts (`+name[(...)]`) - provide **base tuples** for relations\n- Rules (`+name(...) \u003c- body`) - define **derived tuples** for relations\n\n## 1. Type Declarations (`type`)\n\n### 1.1 Grammar\n\n```ebnf\nTypeDecl   ::= \"type\" TypeName \":\" TypeExpr \".\"\nTypeName   ::= UIdent          // capitalized, e.g. Email, User\n\nTypeExpr   ::= SimpleType\n             | RecordType\n\nSimpleType ::= BaseType [Refinements]\nBaseType   ::= \"int\" | \"string\" | \"bool\"\n             | \"list\" \"[\" TypeExpr \"]\"\n             | TypeName         // previously declared type\n\nRecordType ::= \"{\" FieldList \"}\"\n FieldList  ::= Field (\",\" Field)*\nField      ::= FieldName \":\" TypeExpr\n\n FieldName  ::= LIdent\n\nRefinements ::= \"(\" Refinement (\",\" Refinement)* \")\"\nRefinement  ::= Ident \"(\" ... \")\"   // opaque to the core language\n```\n\n### 1.2 Semantics\n\nA `type` declaration introduces a **value type**. Types describe the **shape and constraints of values** but **do not define relations** by themselves.\n\n### 1.3 Aliases and Refinements\n\n```datalog\ntype Email: string(pattern(\"^[^@]+@[^@]+$\"))\ntype Id:    int(range(1, 1000000))\ntype Tags:  list[string](not_empty)\n```\n\nInterpretation as refinement types:\n\n- `Email` is a subset of `string`\n- `Id` is a subset of `int`\n- `Tags` is a subset of `list[string]`\n\nTyping judgment:\n\n```\nG |- v : Email  =\u003e  G |- v : string  and  v satisfies pattern(\"^[^@]+@[^@]+$\")\n```\n\nThe semantics of refinements (`pattern`, `range`, `not_empty`, ...) are implementation-defined.\n\n### 1.4 Record Types\n\n```datalog\ntype User: {\n    id:      Id,\n    name:    string(not_empty),\n    email:   Email,\n    my_tags: Tags\n}\n```\n\nA **record type** `{ f1 : t1, ..., fn : tn }` is the type of records with named fields `fi` of types `ti`.\n\nImportant:\n- `User` is a **value type**\n- A single `User` value is a record with 4 fields\n- This is *not* yet a relation; it's just a value type\n\n## 2. Schema Declarations\n\nA **relation schema** declares the structure of a relation (like a table).\n\n### 2.1 Grammar\n\n```ebnf\nSchemaDecl ::= \"+\" RelName \"(\" ParamList \")\" \".\"\n\nRelName    ::= LIdent           // e.g. user, high_spender\n\nParamList  ::= Param (\",\" Param)*\nParam      ::= ParamName \":\" TypeExpr [Annotations]\nParamName  ::= LIdent\n\nAnnotations ::= Annotation+\nAnnotation  ::= \"@\" AnnotName\n AnnotName   ::= \"key\" | \"unique\" | \"not_empty\" | ...\n```\n\n### 2.2 Schema Declaration\n\n```datalog\n+user(\n    id:      int,\n    name:    string,\n    email:   string\n)\n```\n\nThis declares a 3-ary relation:\n\n```\nuser : int x string x string -\u003e Bool\n```\n\ni.e. `user` is a subset of `int x string x string`.\n\nEach parameter is a **column** in the relation.\n\n### 2.3 Schema with Type References\n\n```datalog\ntype Id:    int\ntype Email: string\n\n+user(id: Id, name: string, email: Email)\n```\n\n## 3. Terms and Expressions\n\n### 3.1 Grammar\n\n```ebnf\nTerm       ::= Var\n             | Constant\n\nVar        ::= LIdent | UIdent\n```\n\nConstants are implementation-defined (ints, strings, bools, lists, ...).\n\n## 4. Atoms, Facts, and Rules\n\n### 4.1 Atoms\n\n```ebnf\nAtom        ::= RelName \"(\" ArgList? \")\"\nArgList     ::= Arg (\",\" Arg)*\nArg         ::= Term\n```\n\nExample (positional):\n\n```datalog\nuser(1, \"Alice\", \"alice@example.com\")\n```\n\n### 4.2 Facts\n\n```ebnf\nFactDecl    ::= \"+\" Atom \".\"\n              | \"+\" RelName \"[\" TupleList \"]\" \".\"\n```\n\nExample:\n\n```datalog\n+user(1, \"Alice\", \"alice@example.com\")\n+user[(2, \"Bob\", \"bob@example.com\"), (3, \"Charlie\", \"charlie@example.com\")]\n```\n\n### 4.3 Rules\n\n```ebnf\nRuleDecl    ::= [\"+\" ] HeadAtom \"\u003c-\" Body \".\"\nHeadAtom    ::= RelName \"(\" HeadArgList? \")\"\nHeadArgList ::= HeadArg (\",\" HeadArg)*\nHeadArg     ::= Term\n\nBody        ::= BodyAtom (\",\" BodyAtom)*\n BodyAtom    ::= Atom | Condition\n\nCondition   ::= Term RelOp Term\nRelOp       ::= \"=\" | \"!=\" | \"\u003c\" | \"\u003e\" | \"\u003c=\" | \"\u003e=\"\n```\n\n### 4.4 Persistent vs Session Rules\n\n```datalog\n// Persistent rule (with + prefix) - stored and incrementally maintained\n+admin_email(Email) \u003c-\n    user(_, _, Email),\n    admin(Email)\n\n// Session rule (no + prefix) - computed on-demand, not stored\ntemp_result(X, Y) \u003c- source(X, Y), X \u003e 10\n```\n\n## 5. Base vs Derived Relations\n\n- **Base data (EDB)**: Relations populated via **facts only**\n- **Derived data (IDB/views)**: Relations populated via **rules**\n\nBoth are still just **relations**:\n- Schema gives the structure\n- Facts and rules together define the relation's **extension**\n\nSQL analogy:\n- `+user(...) + facts` is analogous to `CREATE TABLE user (...) + INSERT INTO user .`\n- `+admin_email(...) + rules` is analogous to `CREATE VIEW admin_email AS SELECT .`\n\n## 6. Persistent Rules and the `+` Prefix\n\n### 6.1 Design Principles\n\nClear separation of concerns:\n\n| Syntax | Purpose | DD Materialization | Type Checking |\n|--------|---------|-------------------|---------------|\n| `type` | Value type definitions | No | N/A |\n| `+name(col: type, ...)` | Schema declaration | **No** | **Yes** |\n| `+name(...) \u003c- body` | Persistent rule (DD view) | **Yes** | Only if schema exists |\n| `name(...) \u003c- body` | Session rule (transient) | **No** | Only if schema exists |\n| `+`/`-` (facts) | Base data manipulation | No | Only if schema exists |\n\n### 6.2 Persistent Rule Grammar\n\n```ebnf\nPersistentRule ::= \"+\" RuleName \"(\" ParamList \")\" \"\u003c-\" Body \".\"\n```\n\n### 6.3 Session Rules\n\nRules without `+` prefix are **session rules**:\n\n```datalog\ntemp_result(X, Y) \u003c- source(X, Y), X \u003e 10\n```\n\n- Computed on-demand during evaluation\n- NOT persisted or incrementally maintained\n- Useful for ad-hoc queries\n\n## 7. Implementation Notes\n\n### 7.1 Type Persistence\n\nAll typing information needs to be persisted on a database level. The server implements multiple databases where same-named types could have different semantic meanings.\n\n### 7.2 Naming Conventions\n\nTo avoid confusion between types and variables:\n\n- **Types**: `UIdent` (capitalized) - `Email`, `User`, `Purchase`\n- **Variables**: `LIdent` or `UIdent` - `e`, `Email`, `user_id`\n- **Relations**: `LIdent` (lowercase) - `user`, `purchase`, `admin_email`\n\n### 7.3 Command vs Keyword Distinction\n\nDo NOT confuse:\n- `+name(col: type)` - Schema declaration syntax\n- `.rel` meta command - REPL command to list/describe relations\n\n## 8. Complete Example\n\n```datalog\n// Type definitions\ntype Id: int(range(1, 1000000))\ntype Email: string(pattern(\"^[^@]+@[^@]+$\"))\n\n// Schema declarations\n+user(id: Id, name: string, email: Email)\n+purchase(user_id: Id, amount: int)\n\n// Base data\n+user[(1, \"Alice\", \"alice@example.com\"), (2, \"Bob\", \"bob@example.com\")]\n+purchase[(1, 1500), (1, 200), (2, 300)]\n\n// Persistent rule (explicit DD materialization)\n+high_spender(UserId) \u003c-\n    purchase(UserId, Amount),\n    Amount \u003e 1000\n\n// Session rule (not materialized, just computed on query)\ntemp(Id) \u003c- user(Id, _, _), high_spender(Id)\n\n// Query\n?high_spender(X)\n```\n\n## 9. Type Checking Algorithm\n\n### 9.1 Schema Lookup\n\nGiven a rule:\n\n```datalog\n+admin_email(Email) \u003c- user(_, _, Email), admin(Email)\n```\n\nType checking steps:\n1. Lookup schema: if `+admin_email(email: Email)` exists, check arity matches\n2. Check that variable types are consistent across the rule\n3. Report type errors if mismatches found\n\n### 9.2 Variable Type Inference\n\nVariables get their types from:\n1. Their position in atoms with declared schemas\n2. Comparison with constants\n3. Aggregation context"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Le\",null,{\"page\":{\"title\":\"Type System Specification\",\"content\":\"$f\",\"toc\":[{\"level\":2,\"text\":\"Overview\",\"id\":\"overview\"},{\"level\":2,\"text\":\"1. Type Declarations (type)\",\"id\":\"1-type-declarations-type\"},{\"level\":3,\"text\":\"1.1 Grammar\",\"id\":\"11-grammar\"},{\"level\":3,\"text\":\"1.2 Semantics\",\"id\":\"12-semantics\"},{\"level\":3,\"text\":\"1.3 Aliases and Refinements\",\"id\":\"13-aliases-and-refinements\"},{\"level\":3,\"text\":\"1.4 Record Types\",\"id\":\"14-record-types\"},{\"level\":2,\"text\":\"2. Schema Declarations\",\"id\":\"2-schema-declarations\"},{\"level\":3,\"text\":\"2.1 Grammar\",\"id\":\"21-grammar\"},{\"level\":3,\"text\":\"2.2 Schema Declaration\",\"id\":\"22-schema-declaration\"},{\"level\":3,\"text\":\"2.3 Schema with Type References\",\"id\":\"23-schema-with-type-references\"},{\"level\":2,\"text\":\"3. Terms and Expressions\",\"id\":\"3-terms-and-expressions\"},{\"level\":3,\"text\":\"3.1 Grammar\",\"id\":\"31-grammar\"},{\"level\":2,\"text\":\"4. Atoms, Facts, and Rules\",\"id\":\"4-atoms-facts-and-rules\"},{\"level\":3,\"text\":\"4.1 Atoms\",\"id\":\"41-atoms\"},{\"level\":3,\"text\":\"4.2 Facts\",\"id\":\"42-facts\"},{\"level\":3,\"text\":\"4.3 Rules\",\"id\":\"43-rules\"},{\"level\":3,\"text\":\"4.4 Persistent vs Session Rules\",\"id\":\"44-persistent-vs-session-rules\"},{\"level\":2,\"text\":\"5. Base vs Derived Relations\",\"id\":\"5-base-vs-derived-relations\"},{\"level\":2,\"text\":\"6. Persistent Rules and the + Prefix\",\"id\":\"6-persistent-rules-and-the-prefix\"},{\"level\":3,\"text\":\"6.1 Design Principles\",\"id\":\"61-design-principles\"},{\"level\":3,\"text\":\"6.2 Persistent Rule Grammar\",\"id\":\"62-persistent-rule-grammar\"},{\"level\":3,\"text\":\"6.3 Session Rules\",\"id\":\"63-session-rules\"},{\"level\":2,\"text\":\"7. Implementation Notes\",\"id\":\"7-implementation-notes\"},{\"level\":3,\"text\":\"7.1 Type Persistence\",\"id\":\"71-type-persistence\"},{\"level\":3,\"text\":\"7.2 Naming Conventions\",\"id\":\"72-naming-conventions\"},{\"level\":3,\"text\":\"7.3 Command vs Keyword Distinction\",\"id\":\"73-command-vs-keyword-distinction\"},{\"level\":2,\"text\":\"8. Complete Example\",\"id\":\"8-complete-example\"},{\"level\":2,\"text\":\"9. Type Checking Algorithm\",\"id\":\"9-type-checking-algorithm\"},{\"level\":3,\"text\":\"9.1 Schema Lookup\",\"id\":\"91-schema-lookup\"},{\"level\":3,\"text\":\"9.2 Variable Type Inference\",\"id\":\"92-variable-type-inference\"}]},\"slugKey\":\"internals/type-system\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[6869,[],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"InputLayer - A symbolic reasoning engine for AI agents\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.svg\"}],[\"$\",\"$L10\",\"3\",{}]]\n8:null\n"])</script></body></html>