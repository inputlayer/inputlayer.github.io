<!DOCTYPE html><!--05bjYGyiAumoEMBrfWHih--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4cf2300e9c8272f7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4bd7a24b7976d4e6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js"/><script src="/_next/static/chunks/4bd1b696-deba172d32c79f82.js" async=""></script><script src="/_next/static/chunks/794-275dc9ebd3a29fbf.js" async=""></script><script src="/_next/static/chunks/main-app-1fa5b694e5d36a75.js" async=""></script><script src="/_next/static/chunks/app/layout-7e9963bf811be36b.js" async=""></script><script src="/_next/static/chunks/758-3cb69ce377cde046.js" async=""></script><script src="/_next/static/chunks/121-aece4f809b101dc1.js" async=""></script><script src="/_next/static/chunks/502-e809071f8789437b.js" async=""></script><script src="/_next/static/chunks/689-4fcf9680fdc90283.js" async=""></script><script src="/_next/static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js" async=""></script><meta name="next-size-adjust" content=""/><title>InputLayer - A symbolic reasoning engine for AI agents</title><meta name="description" content="Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system."/><link rel="icon" href="/icon.svg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_188709 __variable_9a8899 font-sans antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><div class="flex flex-col h-dvh"><header class="sticky top-0 z-50 w-full border-b border-border/50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="flex h-14 items-center px-6"><a class="mr-8" href="/"><span class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg><span class="font-extrabold tracking-tight text-lg">InputLayer</span></span></a><nav class="hidden md:flex items-center gap-6 text-sm"><a class="text-muted-foreground transition-colors hover:text-foreground" href="/docs/">Docs</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/blog/">Blog</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/use-cases/">Use Cases</a><a class="text-muted-foreground transition-colors hover:text-foreground" href="/compare/">Compare</a><a href="https://demo.inputlayer.ai" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground">Demo<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link h-3 w-3"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a></nav><div class="ml-auto flex items-center gap-3"><div class="inline-flex items-center gap-1.5"><a href="https://github.com/inputlayer/inputlayer" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-star h-3.5 w-3.5"><path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"></path></svg><span>Star</span></a><a href="https://github.com/inputlayer/inputlayer/fork" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-md border border-border bg-secondary/50 px-2.5 py-1 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground hover:bg-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-fork h-3.5 w-3.5"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg><span>Fork</span></a></div><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9 h-9 w-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-4 w-4"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg></button><div class="md:hidden"><button class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></header><div class="flex flex-1 overflow-hidden"><div class="w-64 shrink-0 border-r border-border/50 overflow-y-auto"><div class="flex flex-col h-full"><div class="p-3 border-b border-border/50"><div class="relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><input type="text" placeholder="Search docs..." class="w-full h-8 pl-8 pr-3 text-sm rounded-md border border-border bg-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring" value=""/></div></div><nav class="flex-1 overflow-y-auto p-2 space-y-0.5"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" href="/docs/index/">Overview</a><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_j6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Guides</button><div data-state="closed" id="radix-_R_j6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="open" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-foreground font-medium" style="padding-left:12px" type="button" aria-controls="radix-_R_r6av5ubtb_" aria-expanded="true" data-state="open" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform rotate-90"><path d="m9 18 6-6-6-6"></path></svg>Reference</button><div data-state="open" id="radix-_R_r6av5ubtb_" data-slot="collapsible-content"><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/reference/index/">Overview</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/reference/commands/">Commands</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/reference/functions/">Functions</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors bg-primary/10 text-primary font-medium" style="padding-left:24px" href="/docs/reference/syntax/">Syntax</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/reference/syntax-cheatsheet/">Syntax Cheatsheet</a><a class="block py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:24px" href="/docs/reference/aggregations/">Aggregations</a></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_136av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Specification</button><div data-state="closed" id="radix-_R_136av5ubtb_" hidden="" data-slot="collapsible-content"></div></div><div data-state="closed" data-slot="collapsible"><button class="w-full flex items-center w-full py-1.5 px-3 text-sm rounded-md transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" style="padding-left:12px" type="button" aria-controls="radix-_R_1b6av5ubtb_" aria-expanded="false" data-state="closed" data-slot="collapsible-trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3.5 w-3.5 mr-1 shrink-0 transition-transform"><path d="m9 18 6-6-6-6"></path></svg>Internals</button><div data-state="closed" id="radix-_R_1b6av5ubtb_" hidden="" data-slot="collapsible-content"></div></div></nav></div></div><div class="flex flex-1 flex-col overflow-hidden"><div class="flex flex-1 overflow-hidden"><div class="flex-1 overflow-y-auto px-8 py-6 max-w-4xl mx-auto"><article class="docs-prose"><h1 id="syntax-reference" node="[object Object]">Syntax Reference</h1>
<p>Complete syntax reference for InputLayer&#x27;s query language.</p>
<h2 id="grammar-overview" node="[object Object]">Grammar Overview</h2>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">program     ::= statement*
statement   ::= fact | rule | query | meta_command | schema_decl

fact        ::= &#x27;+&#x27; atom
              | &#x27;+&#x27; relation &#x27;[&#x27; tuple_list &#x27;]&#x27;
              | &#x27;-&#x27; atom

rule        ::= &#x27;+&#x27; atom &#x27;&lt;-&#x27; body           // Persistent rule
              | atom &#x27;&lt;-&#x27; body               // Session rule

query       ::= &#x27;?&#x27; body

body        ::= goal (&#x27;,&#x27; goal)*
goal        ::= atom | constraint | negated_atom

atom        ::= relation &#x27;(&#x27; term_list &#x27;)&#x27;
negated_atom::= &#x27;!&#x27; atom

term        ::= variable | constant | expression
term_list   ::= term (&#x27;,&#x27; term)*

constraint  ::= term op term
op          ::= &#x27;=&#x27; | &#x27;!=&#x27; | &#x27;&lt;&#x27; | &#x27;&lt;=&#x27; | &#x27;&gt;&#x27; | &#x27;&gt;=&#x27;
</code></pre>
<h2 id="lexical-elements" node="[object Object]">Lexical Elements</h2>
<h3 id="identifiers" node="[object Object]">Identifiers</h3>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Type</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Pattern</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Examples</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]">Relation</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">[a-z][a-z0-9_]*</code></td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">edge</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">my_relation</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">path2</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]">Variable</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">[A-Z][a-zA-Z0-9_]*</code></td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">X</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">Name</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">PersonId</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]">Placeholder</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">_</code></td><td class="border px-4 py-2" node="[object Object]">Matches any value, discarded</td></tr></tbody></table></div>
<h3 id="literals" node="[object Object]">Literals</h3>
<h4 id="integers" node="[object Object]">Integers</h4>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-number">42</span>        <span class="syn-comment">// Decimal</span>
<span class="syn-arith">-</span><span class="syn-number">17</span>       <span class="syn-comment">// Negative</span>
<span class="syn-number">0</span>         <span class="syn-comment">// Zero</span>
</code></pre>
<h4 id="floats" node="[object Object]">Floats</h4>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-number">3.14</span>      <span class="syn-comment">// Decimal float</span>
<span class="syn-arith">-</span><span class="syn-number">0.5</span>      <span class="syn-comment">// Negative float</span>
<span class="syn-number">1.0e10</span>    <span class="syn-comment">// Scientific notation</span>
</code></pre>
<h4 id="strings" node="[object Object]">Strings</h4>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-string">"hello"</span>           <span class="syn-comment">// Basic string</span>
<span class="syn-string">"hello world"</span>     <span class="syn-comment">// With spaces</span>
<span class="syn-string">"line1\nline2"</span>    <span class="syn-comment">// Escape sequences</span>
<span class="syn-string">"say \"hi\""</span>      <span class="syn-comment">// Escaped quotes</span>
</code></pre>
<p><strong>Escape sequences:</strong></p>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Sequence</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Meaning</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">\n</code></td><td class="border px-4 py-2" node="[object Object]">Newline</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">\t</code></td><td class="border px-4 py-2" node="[object Object]">Tab</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">\\</code></td><td class="border px-4 py-2" node="[object Object]">Backslash</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">\&quot;</code></td><td class="border px-4 py-2" node="[object Object]">Quote</td></tr></tbody></table></div>
<h4 id="vectors" node="[object Object]">Vectors</h4>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-punct">[</span><span class="syn-number">1.0</span><span class="syn-punct">,</span> <span class="syn-number">2.0</span><span class="syn-punct">,</span> <span class="syn-number">3.0</span><span class="syn-punct">]</span>           <span class="syn-comment">// Float vector</span>
<span class="syn-punct">[</span><span class="syn-number">0.1</span><span class="syn-punct">,</span> <span class="syn-number">0.2</span><span class="syn-punct">,</span> <span class="syn-number">0.3</span><span class="syn-punct">,</span> <span class="syn-number">0.4</span><span class="syn-punct">]</span>      <span class="syn-comment">// Embedding</span>
</code></pre>
<h3 id="comments" node="[object Object]">Comments</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Single line comment</span>

<span class="syn-comment">/* Multi-line
   block comment */</span>

<span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span>  <span class="syn-comment">// Inline comment</span>
</code></pre>
<h2 id="statements" node="[object Object]">Statements</h2>
<h3 id="fact-insertion-object-object" node="[object Object]">Fact Insertion (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code>)</h3>
<p>Insert base data into relations.</p>
<p><strong>Single fact:</strong></p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">person</span><span class="syn-punct">(</span><span class="syn-string">"alice"</span><span class="syn-punct">,</span> <span class="syn-number">30</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">location</span><span class="syn-punct">(</span><span class="syn-string">"NYC"</span><span class="syn-punct">,</span> <span class="syn-number">40.7</span><span class="syn-punct">,</span> <span class="syn-arith">-</span><span class="syn-number">74.0</span><span class="syn-punct">)</span>
</code></pre>
<p><strong>Bulk insert:</strong></p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">4</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">4</span><span class="syn-punct">,</span> <span class="syn-number">5</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
<span class="syn-arith">+</span><span class="syn-identifier">person</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-string">"alice"</span><span class="syn-punct">,</span> <span class="syn-number">30</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-string">"bob"</span><span class="syn-punct">,</span> <span class="syn-number">25</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-string">"carol"</span><span class="syn-punct">,</span> <span class="syn-number">35</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
</code></pre>
<h3 id="fact-deletion-object-object" node="[object Object]">Fact Deletion (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">-</code>)</h3>
<p>Remove base data from relations.</p>
<p><strong>Single fact:</strong></p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">-</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span>
</code></pre>
<p><strong>Conditional delete (based on another relation):</strong></p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Delete all edges where source node is in the 'banned' relation</span>
<span class="syn-arith">-</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">banned</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// Delete all edges where X is greater than 5</span>
<span class="syn-arith">-</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">5</span>

<span class="syn-comment">// Delete edges that form triangles</span>
<span class="syn-arith">-</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Z</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<p><strong>Note:</strong> Conditional delete finds all tuples matching the condition and removes them from the target relation. The target relation is automatically included in the query body to bind all head variables.</p>
<h3 id="persistent-rules-object-object" node="[object Object]">Persistent Rules (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+head &lt;- body</code>)</h3>
<p>Define derived relations that persist across sessions.</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Simple derivation</span>
<span class="syn-arith">+</span><span class="syn-identifier">adult</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span> <span class="syn-comparison">&gt;=</span> <span class="syn-number">18</span>

<span class="syn-comment">// Join</span>
<span class="syn-arith">+</span><span class="syn-identifier">works_in</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Building</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">employee</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Dept</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-body-id">department</span><span class="syn-punct">(</span><span class="syn-variable">Dept</span><span class="syn-punct">,</span> <span class="syn-variable">Building</span><span class="syn-punct">)</span>

<span class="syn-comment">// Recursive</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>

<span class="syn-comment">// With negation</span>
<span class="syn-arith">+</span><span class="syn-identifier">orphan</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">parent</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// With aggregation</span>
<span class="syn-arith">+</span><span class="syn-identifier">dept_size</span><span class="syn-punct">(</span><span class="syn-variable">Dept</span><span class="syn-punct">,</span> <span class="syn-aggregate">count</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Emp</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">employee</span><span class="syn-punct">(</span><span class="syn-variable">Emp</span><span class="syn-punct">,</span> <span class="syn-variable">Dept</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="session-rules-no-object-object-prefix" node="[object Object]">Session Rules (no <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code> prefix)</h3>
<p>Transient rules that exist only for the current session.</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Not persisted</span>
<span class="syn-identifier">temp</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">&lt;</span> <span class="syn-variable">Y</span>
<span class="syn-identifier">debug</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">some_complex_condition</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="queries-object-object" node="[object Object]">Queries (<code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">?</code>)</h3>
<p>Ask questions about the data.</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Simple query</span>
<span class="syn-query">?</span> <span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// With constants</span>
<span class="syn-query">?</span> <span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// With constraints</span>
<span class="syn-query">?</span> <span class="syn-identifier">person</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">25</span>

<span class="syn-comment">// Join query</span>
<span class="syn-query">?</span> <span class="syn-identifier">person</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-identifier">purchase</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">Item</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="schema-declarations" node="[object Object]">Schema Declarations</h3>
<p>Define typed schemas for relations.</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Basic schema</span>
<span class="syn-arith">+</span><span class="syn-identifier">employee</span><span class="syn-punct">(</span><span class="syn-identifier">id</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">name</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">,</span> <span class="syn-identifier">dept</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">)</span>

<span class="syn-comment">// All types</span>
<span class="syn-arith">+</span><span class="syn-identifier">example</span><span class="syn-punct">(</span>
  <span class="syn-identifier">a</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span>
  <span class="syn-identifier">b</span><span class="syn-punct">:</span> <span class="syn-keyword">float</span><span class="syn-punct">,</span>
  <span class="syn-identifier">c</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">,</span>
  <span class="syn-identifier">d</span><span class="syn-punct">:</span> <span class="syn-keyword">vector</span>
<span class="syn-punct">)</span>
</code></pre>
<p><strong>Supported types:</strong></p>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Type</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Description</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Example Values</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">int</code></td><td class="border px-4 py-2" node="[object Object]">64-bit integer</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">42</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">-17</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">0</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">float</code></td><td class="border px-4 py-2" node="[object Object]">64-bit float</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">3.14</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">-0.5</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">string</code></td><td class="border px-4 py-2" node="[object Object]">UTF-8 string</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&quot;hello&quot;</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&quot;world&quot;</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">bool</code></td><td class="border px-4 py-2" node="[object Object]">Boolean</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">true</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">false</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">timestamp</code></td><td class="border px-4 py-2" node="[object Object]">Unix timestamp (ms)</td><td class="border px-4 py-2" node="[object Object]">Aliases: <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">time</code>, <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">datetime</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">vector</code></td><td class="border px-4 py-2" node="[object Object]">Float array</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">[0.1, 0.2, 0.3]</code></td></tr></tbody></table></div>
<h2 id="expressions" node="[object Object]">Expressions</h2>
<h3 id="arithmetic" node="[object Object]">Arithmetic</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">computed</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">input</span><span class="syn-punct">(</span><span class="syn-variable">A</span><span class="syn-punct">,</span> <span class="syn-variable">B</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">X</span> <span class="syn-comparison">=</span> <span class="syn-variable">A</span> <span class="syn-arith">+</span> <span class="syn-variable">B</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span> <span class="syn-comparison">=</span> <span class="syn-variable">A</span> <span class="syn-arith">*</span> <span class="syn-variable">B</span>
</code></pre>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Operator</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Description</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">+</code></td><td class="border px-4 py-2" node="[object Object]">Addition</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">-</code></td><td class="border px-4 py-2" node="[object Object]">Subtraction</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">*</code></td><td class="border px-4 py-2" node="[object Object]">Multiplication</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">/</code></td><td class="border px-4 py-2" node="[object Object]">Division</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">%</code></td><td class="border px-4 py-2" node="[object Object]">Modulo</td></tr></tbody></table></div>
<h3 id="comparison" node="[object Object]">Comparison</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-query">?</span> <span class="syn-identifier">person</span><span class="syn-punct">(</span><span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span> <span class="syn-comparison">&gt;=</span> <span class="syn-number">18</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span> <span class="syn-comparison">&lt;</span> <span class="syn-number">65</span>
</code></pre>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Operator</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Description</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">=</code></td><td class="border px-4 py-2" node="[object Object]">Equal</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">!=</code></td><td class="border px-4 py-2" node="[object Object]">Not equal</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&lt;</code></td><td class="border px-4 py-2" node="[object Object]">Less than</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&lt;=</code></td><td class="border px-4 py-2" node="[object Object]">Less or equal</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Greater than</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">&gt;=</code></td><td class="border px-4 py-2" node="[object Object]">Greater or equal</td></tr></tbody></table></div>
<h3 id="built-in-functions" node="[object Object]">Built-in Functions</h3>
<p><strong>Vector functions:</strong></p>
<p>InputLayer provides built-in vector distance and similarity functions:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Compute cosine similarity between embeddings</span>
<span class="syn-query">?</span> <span class="syn-identifier">embedding</span><span class="syn-punct">(</span><span class="syn-variable">Id1</span><span class="syn-punct">,</span> <span class="syn-variable">V1</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-identifier">embedding</span><span class="syn-punct">(</span><span class="syn-variable">Id2</span><span class="syn-punct">,</span> <span class="syn-variable">V2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Id1</span> <span class="syn-comparison">&lt;</span> <span class="syn-variable">Id2</span><span class="syn-punct">,</span>
   <span class="syn-variable">Sim</span> <span class="syn-comparison">=</span> <span class="syn-builtin">cosine</span><span class="syn-punct">(</span><span class="syn-variable">V1</span><span class="syn-punct">,</span> <span class="syn-variable">V2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Sim</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">0.9</span>

<span class="syn-comment">// Compute Euclidean distance between points</span>
<span class="syn-query">?</span> <span class="syn-identifier">point</span><span class="syn-punct">(</span><span class="syn-variable">Id1</span><span class="syn-punct">,</span> <span class="syn-variable">V1</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-identifier">point</span><span class="syn-punct">(</span><span class="syn-variable">Id2</span><span class="syn-punct">,</span> <span class="syn-variable">V2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Id1</span> <span class="syn-comparison">&lt;</span> <span class="syn-variable">Id2</span><span class="syn-punct">,</span>
   <span class="syn-variable">Dist</span> <span class="syn-comparison">=</span> <span class="syn-builtin">euclidean</span><span class="syn-punct">(</span><span class="syn-variable">V1</span><span class="syn-punct">,</span> <span class="syn-variable">V2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Dist</span> <span class="syn-comparison">&lt;</span> <span class="syn-number">1.0</span>
</code></pre>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Function</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Description</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">euclidean(v1, v2)</code></td><td class="border px-4 py-2" node="[object Object]">Euclidean distance</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">cosine(v1, v2)</code></td><td class="border px-4 py-2" node="[object Object]">Cosine similarity</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">dot(v1, v2)</code></td><td class="border px-4 py-2" node="[object Object]">Dot product</td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">manhattan(v1, v2)</code></td><td class="border px-4 py-2" node="[object Object]">Manhattan distance</td></tr></tbody></table></div>
<p>Vector functions work in both query bodies and rule heads (via computed head variables). See <a href="functions" target="_blank" rel="noopener noreferrer" node="[object Object]">functions</a> for the complete list (55 functions including vector, temporal, math, string, LSH, and quantization).</p>
<h2 id="aggregations" node="[object Object]">Aggregations</h2>
<p>Compute aggregate values over groups.</p>
<h3 id="syntax" node="[object Object]">Syntax</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">result</span><span class="syn-punct">(</span><span class="syn-variable">GroupBy1</span><span class="syn-punct">,</span> <span class="syn-variable">GroupBy2</span><span class="syn-punct">,</span> <span class="syn-identifier">agg</span><span class="syn-comparison">&lt;</span><span class="syn-variable">AggColumn</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">source</span><span class="syn-punct">(</span><span class="syn-variable">GroupBy1</span><span class="syn-punct">,</span> <span class="syn-variable">GroupBy2</span><span class="syn-punct">,</span> <span class="syn-variable">AggColumn</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
</code></pre>
<p>Variables in the head that are not aggregated become group-by columns.</p>
<h3 id="aggregate-functions" node="[object Object]">Aggregate Functions</h3>
<div class="my-4 overflow-x-auto"><table class="w-full border-collapse" node="[object Object]"><thead><tr><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Function</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Description</th><th class="border px-4 py-2 text-left font-semibold bg-muted/50" node="[object Object]">Example</th></tr></thead><tbody><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">count&lt;X&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Count rows</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">count&lt;Id&gt;</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">sum&lt;X&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Sum values</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">sum&lt;Amount&gt;</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">min&lt;X&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Minimum</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">min&lt;Age&gt;</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">max&lt;X&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Maximum</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">max&lt;Score&gt;</code></td></tr><tr><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">avg&lt;X&gt;</code></td><td class="border px-4 py-2" node="[object Object]">Average</td><td class="border px-4 py-2" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">avg&lt;Salary&gt;</code></td></tr></tbody></table></div>
<h3 id="examples" node="[object Object]">Examples</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Count per group</span>
<span class="syn-arith">+</span><span class="syn-identifier">city_count</span><span class="syn-punct">(</span><span class="syn-variable">City</span><span class="syn-punct">,</span> <span class="syn-aggregate">count</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Id</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">City</span><span class="syn-punct">)</span>

<span class="syn-comment">// Sum</span>
<span class="syn-arith">+</span><span class="syn-identifier">total_sales</span><span class="syn-punct">(</span><span class="syn-variable">Product</span><span class="syn-punct">,</span> <span class="syn-aggregate">sum</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Amount</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">sale</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Product</span><span class="syn-punct">,</span> <span class="syn-variable">Amount</span><span class="syn-punct">)</span>

<span class="syn-comment">// Multiple aggregates (separate rules)</span>
<span class="syn-arith">+</span><span class="syn-identifier">stats_min</span><span class="syn-punct">(</span><span class="syn-aggregate">min</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Age</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">stats_max</span><span class="syn-punct">(</span><span class="syn-aggregate">max</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Age</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Age</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>

<span class="syn-comment">// Global aggregate (no group-by)</span>
<span class="syn-arith">+</span><span class="syn-identifier">total</span><span class="syn-punct">(</span><span class="syn-aggregate">sum</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Amount</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">purchase</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">Amount</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="negation" node="[object Object]">Negation</h2>
<p>Express &quot;does not exist&quot; conditions.</p>
<h3 id="syntax" node="[object Object]">Syntax</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-negation">!</span><span class="syn-identifier">atom</span><span class="syn-punct">(</span><span class="syn-identifier">args</span><span class="syn-punct">)</span>     <span class="syn-comment">// Negated atom</span>
</code></pre>
<h3 id="rules" node="[object Object]">Rules</h3>
<ol>
<li><strong>Safety</strong>: Variables in negation must appear positively elsewhere</li>
<li><strong>Stratification</strong>: No circular dependencies through negation</li>
</ol>
<h3 id="examples" node="[object Object]">Examples</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// People without purchases</span>
<span class="syn-arith">+</span><span class="syn-identifier">non_buyer</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">Name</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">person</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">Name</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-negation">!</span><span class="syn-body-id">purchase</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>

<span class="syn-comment">// Nodes with no outgoing edges</span>
<span class="syn-arith">+</span><span class="syn-identifier">sink</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">node</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>

<span class="syn-comment">// Set difference</span>
<span class="syn-arith">+</span><span class="syn-identifier">only_in_a</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">a</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">b</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="invalid-unsafe" node="[object Object]">Invalid (Unsafe)</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// WRONG - X only appears in negation</span>
<span class="syn-arith">+</span><span class="syn-identifier">bad</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-negation">!</span><span class="syn-body-id">some_rel</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// CORRECT - X appears positively</span>
<span class="syn-arith">+</span><span class="syn-identifier">good</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">domain</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">some_rel</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="meta-commands" node="[object Object]">Meta Commands</h2>
<p>Commands that control the REPL environment.</p>
<h3 id="knowledge-graph-commands" node="[object Object]">Knowledge Graph Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.kg</span>                     <span class="syn-comment">// Show current knowledge graph</span>
<span class="syn-meta">.kg list</span>                <span class="syn-comment">// List all knowledge graphs</span>
<span class="syn-meta">.kg create</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>       <span class="syn-comment">// Create knowledge graph</span>
<span class="syn-meta">.kg use</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>          <span class="syn-comment">// Switch to knowledge graph</span>
<span class="syn-meta">.kg drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>         <span class="syn-comment">// Delete knowledge graph</span>
</code></pre>
<h3 id="relation-commands" node="[object Object]">Relation Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.rel</span>                    <span class="syn-comment">// List relations with data</span>
<span class="syn-meta">.rel</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>             <span class="syn-comment">// Show schema and sample data</span>
<span class="syn-meta">.rel</span> <span class="syn-identifier">drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>        <span class="syn-comment">// Drop a relation and its data</span>
</code></pre>
<h3 id="rule-commands" node="[object Object]">Rule Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.rule</span>                   <span class="syn-comment">// List all rules</span>
<span class="syn-meta">.rule</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>            <span class="syn-comment">// Query a rule</span>
<span class="syn-meta">.rule def</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>        <span class="syn-comment">// Show rule definition</span>
<span class="syn-meta">.rule drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>       <span class="syn-comment">// Delete all clauses of a rule</span>
<span class="syn-meta">.rule remove</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">n</span><span class="syn-comparison">&gt;</span> <span class="syn-comment">// Remove clause #n (1-based)</span>
<span class="syn-meta">.rule clear</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>      <span class="syn-comment">// Clear for re-registration</span>
<span class="syn-meta">.rule edit</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">n</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">clause</span><span class="syn-comparison">&gt;</span>  <span class="syn-comment">// Edit clause</span>
</code></pre>
<h3 id="session-commands" node="[object Object]">Session Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.session</span>                <span class="syn-comment">// List session rules</span>
<span class="syn-meta">.session clear</span>          <span class="syn-comment">// Clear all session rules</span>
<span class="syn-meta">.session drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">n</span><span class="syn-comparison">&gt;</span>       <span class="syn-comment">// Remove session rule #n</span>
</code></pre>
<h3 id="file-commands" node="[object Object]">File Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.load</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">file</span><span class="syn-comparison">&gt;</span>            <span class="syn-comment">// Execute a .idl file</span>
</code></pre>
<h3 id="index-commands" node="[object Object]">Index Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.index</span>                  <span class="syn-comment">// List all indexes</span>
<span class="syn-meta">.index list</span>             <span class="syn-comment">// List all indexes (explicit)</span>
<span class="syn-meta">.index create</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-identifier">on</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">relation</span><span class="syn-comparison">&gt;</span><span class="syn-punct">(</span><span class="syn-comparison">&lt;</span><span class="syn-identifier">column</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-punct">[</span><span class="syn-identifier">options</span><span class="syn-punct">]</span>
<span class="syn-meta">.index drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>      <span class="syn-comment">// Drop an index</span>
<span class="syn-meta">.index stats</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>     <span class="syn-comment">// Show index statistics</span>
<span class="syn-meta">.index rebuild</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>   <span class="syn-comment">// Rebuild an index</span>
</code></pre>
<h3 id="user-auth-commands" node="[object Object]">User &amp; Auth Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.user list</span>              <span class="syn-comment">// List all users</span>
<span class="syn-meta">.user create</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">password</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">role</span><span class="syn-comparison">&gt;</span>  <span class="syn-comment">// Create user</span>
<span class="syn-meta">.user drop</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span>       <span class="syn-comment">// Delete user</span>
<span class="syn-meta">.user password</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">password</span><span class="syn-comparison">&gt;</span>       <span class="syn-comment">// Change password</span>
<span class="syn-meta">.user role</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">name</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">role</span><span class="syn-comparison">&gt;</span>               <span class="syn-comment">// Change role</span>
<span class="syn-meta">.apikey create</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">label</span><span class="syn-comparison">&gt;</span>  <span class="syn-comment">// Create API key</span>
<span class="syn-meta">.apikey list</span>            <span class="syn-comment">// List API keys</span>
<span class="syn-meta">.apikey revoke</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">label</span><span class="syn-comparison">&gt;</span>  <span class="syn-comment">// Revoke API key</span>
<span class="syn-meta">.kg</span> <span class="syn-identifier">acl</span> <span class="syn-keyword">list</span> <span class="syn-punct">[</span><span class="syn-comparison">&lt;</span><span class="syn-identifier">kg</span><span class="syn-comparison">&gt;</span><span class="syn-punct">]</span>     <span class="syn-comment">// List ACLs</span>
<span class="syn-meta">.kg</span> <span class="syn-identifier">acl</span> <span class="syn-identifier">grant</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">kg</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">user</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">role</span><span class="syn-comparison">&gt;</span>  <span class="syn-comment">// Grant access</span>
<span class="syn-meta">.kg</span> <span class="syn-identifier">acl</span> <span class="syn-identifier">revoke</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">kg</span><span class="syn-comparison">&gt;</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">user</span><span class="syn-comparison">&gt;</span>        <span class="syn-comment">// Revoke access</span>
</code></pre>
<h3 id="system-commands" node="[object Object]">System Commands</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.status</span>                 <span class="syn-comment">// System status</span>
<span class="syn-meta">.compact</span>                <span class="syn-comment">// Compact storage</span>
<span class="syn-meta">.explain</span> <span class="syn-comparison">&lt;</span><span class="syn-identifier">query</span><span class="syn-comparison">&gt;</span>        <span class="syn-comment">// Show query plan</span>
<span class="syn-meta">.help</span>                   <span class="syn-comment">// Help message</span>
<span class="syn-meta">.quit</span>                   <span class="syn-comment">// Exit REPL</span>
<span class="syn-meta">.exit</span>                   <span class="syn-comment">// Exit REPL (alias)</span>
</code></pre>
<h2 id="recursion" node="[object Object]">Recursion</h2>
<h3 id="basic-pattern" node="[object Object]">Basic Pattern</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Base case</span>
<span class="syn-arith">+</span><span class="syn-identifier">derived</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">base</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>

<span class="syn-comment">// Recursive case</span>
<span class="syn-arith">+</span><span class="syn-identifier">derived</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">derived</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">base</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="transitive-closure" node="[object Object]">Transitive Closure</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">reachable</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="mutual-recursion" node="[object Object]">Mutual Recursion</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-arith">+</span><span class="syn-identifier">odd</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Start</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">start</span><span class="syn-punct">(</span><span class="syn-variable">Start</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">odd</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">even</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">even</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">odd</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="restrictions" node="[object Object]">Restrictions</h3>
<ul>
<li>Negation through recursion is not allowed (non-stratifiable)</li>
<li>Must have a base case that terminates</li>
</ul>
<h2 id="complete-examples" node="[object Object]">Complete Examples</h2>
<h3 id="social-network" node="[object Object]">Social Network</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Schema</span>
<span class="syn-arith">+</span><span class="syn-identifier">person</span><span class="syn-punct">(</span><span class="syn-identifier">id</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">name</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">,</span> <span class="syn-identifier">age</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">follows</span><span class="syn-punct">(</span><span class="syn-identifier">follower</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">followed</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">)</span>

<span class="syn-comment">// Data</span>
<span class="syn-arith">+</span><span class="syn-identifier">person</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-string">"alice"</span><span class="syn-punct">,</span> <span class="syn-number">30</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-string">"bob"</span><span class="syn-punct">,</span> <span class="syn-number">25</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-string">"carol"</span><span class="syn-punct">,</span> <span class="syn-number">35</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
<span class="syn-arith">+</span><span class="syn-identifier">follows</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">)</span><span class="syn-punct">]</span>

<span class="syn-comment">// Rules</span>
<span class="syn-arith">+</span><span class="syn-identifier">mutual_follow</span><span class="syn-punct">(</span><span class="syn-variable">A</span><span class="syn-punct">,</span> <span class="syn-variable">B</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">follows</span><span class="syn-punct">(</span><span class="syn-variable">A</span><span class="syn-punct">,</span> <span class="syn-variable">B</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-body-id">follows</span><span class="syn-punct">(</span><span class="syn-variable">B</span><span class="syn-punct">,</span> <span class="syn-variable">A</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-variable">A</span> <span class="syn-comparison">&lt;</span> <span class="syn-variable">B</span>

<span class="syn-arith">+</span><span class="syn-identifier">influencer</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-aggregate">count</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Follower</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">follows</span><span class="syn-punct">(</span><span class="syn-variable">Follower</span><span class="syn-punct">,</span> <span class="syn-variable">Id</span><span class="syn-punct">)</span>

<span class="syn-comment">// Query</span>
<span class="syn-query">?</span> <span class="syn-identifier">influencer</span><span class="syn-punct">(</span><span class="syn-variable">Id</span><span class="syn-punct">,</span> <span class="syn-variable">Count</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">Count</span> <span class="syn-comparison">&gt;</span> <span class="syn-number">10</span>
</code></pre>
<h3 id="graph-analysis" node="[object Object]">Graph Analysis</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Transitive closure</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>

<span class="syn-comment">// Cycle detection</span>
<span class="syn-arith">+</span><span class="syn-identifier">in_cycle</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>

<span class="syn-comment">// Connected components (undirected)</span>
<span class="syn-arith">+</span><span class="syn-identifier">bidir</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">bidir</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">connected</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">bidir</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">connected</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">connected</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">bidir</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">)</span>

<span class="syn-comment">// Sink nodes (no outgoing)</span>
<span class="syn-arith">+</span><span class="syn-identifier">sink</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">node</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>

<span class="syn-comment">// Source nodes (no incoming)</span>
<span class="syn-arith">+</span><span class="syn-identifier">source</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">node</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-negation">!</span><span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">_</span><span class="syn-punct">,</span> <span class="syn-variable">X</span><span class="syn-punct">)</span>
</code></pre>
<h3 id="bill-of-materials" node="[object Object]">Bill of Materials</h3>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// Part hierarchy</span>
<span class="syn-arith">+</span><span class="syn-identifier">contains</span><span class="syn-punct">(</span><span class="syn-identifier">assembly</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">part</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">qty</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">)</span>

<span class="syn-comment">// All parts needed (recursive)</span>
<span class="syn-arith">+</span><span class="syn-identifier">requires</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">contains</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">requires</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">contains</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Sub</span><span class="syn-punct">,</span> <span class="syn-variable">_</span><span class="syn-punct">)</span><span class="syn-punct">,</span>
  <span class="syn-body-id">requires</span><span class="syn-punct">(</span><span class="syn-variable">Sub</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">)</span>

<span class="syn-comment">// Total quantity calculation</span>
<span class="syn-arith">+</span><span class="syn-identifier">total_qty</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-aggregate">sum</span><span class="syn-comparison">&lt;</span><span class="syn-variable">Qty</span><span class="syn-comparison">&gt;</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span>
  <span class="syn-body-id">contains</span><span class="syn-punct">(</span><span class="syn-variable">Asm</span><span class="syn-punct">,</span> <span class="syn-variable">Part</span><span class="syn-punct">,</span> <span class="syn-variable">Qty</span><span class="syn-punct">)</span>
</code></pre>
<h2 id="reserved-words" node="[object Object]">Reserved Words</h2>
<p>The following are reserved and cannot be used as relation names:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">true, false
count, sum, min, max, avg
int, float, string, vector
</code></pre>
<h2 id="file-format" node="[object Object]">File Format</h2>
<p>InputLayer files use the <code class="bg-muted rounded px-1.5 py-0.5 font-mono text-sm" node="[object Object]">.idl</code> extension and contain valid InputLayer statements:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-comment">// my_program.idl</span>

<span class="syn-comment">// Schema declarations</span>
<span class="syn-arith">+</span><span class="syn-identifier">node</span><span class="syn-punct">(</span><span class="syn-identifier">id</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">label</span><span class="syn-punct">:</span> <span class="syn-keyword">string</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">(</span><span class="syn-identifier">src</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">dst</span><span class="syn-punct">:</span> <span class="syn-keyword">int</span><span class="syn-punct">,</span> <span class="syn-identifier">weight</span><span class="syn-punct">:</span> <span class="syn-keyword">float</span><span class="syn-punct">)</span>

<span class="syn-comment">// Data</span>
<span class="syn-arith">+</span><span class="syn-identifier">node</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-string">"a"</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-string">"b"</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-string">"c"</span><span class="syn-punct">)</span><span class="syn-punct">]</span>
<span class="syn-arith">+</span><span class="syn-identifier">edge</span><span class="syn-punct">[</span><span class="syn-punct">(</span><span class="syn-number">1</span><span class="syn-punct">,</span> <span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">1.0</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-punct">(</span><span class="syn-number">2</span><span class="syn-punct">,</span> <span class="syn-number">3</span><span class="syn-punct">,</span> <span class="syn-number">2.0</span><span class="syn-punct">)</span><span class="syn-punct">]</span>

<span class="syn-comment">// Rules</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">W</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">W</span><span class="syn-punct">)</span>
<span class="syn-arith">+</span><span class="syn-identifier">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">,</span> <span class="syn-variable">W</span><span class="syn-punct">)</span> <span class="syn-arrow">&lt;-</span> <span class="syn-body-id">path</span><span class="syn-punct">(</span><span class="syn-variable">X</span><span class="syn-punct">,</span> <span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">W1</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-body-id">edge</span><span class="syn-punct">(</span><span class="syn-variable">Y</span><span class="syn-punct">,</span> <span class="syn-variable">Z</span><span class="syn-punct">,</span> <span class="syn-variable">W2</span><span class="syn-punct">)</span><span class="syn-punct">,</span> <span class="syn-variable">W</span> <span class="syn-comparison">=</span> <span class="syn-variable">W1</span> <span class="syn-arith">+</span> <span class="syn-variable">W2</span>
</code></pre>
<p>Load with:</p>
<pre class="rounded-lg bg-[var(--code-bg)] p-4 overflow-x-auto mb-4 text-sm font-mono" node="[object Object]"><code class="language-datalog text-sm"><span class="syn-meta">.load</span> <span class="syn-identifier">my_program</span><span class="syn-meta">.</span><span class="syn-identifier">idl</span>
</code></pre></article></div><div class="hidden lg:block w-48 shrink-0 border-l border-border/50"><div class="sticky top-0 p-4"><p class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">On this page</p><nav class="space-y-1"><a href="#grammar-overview" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Grammar Overview</a><a href="#lexical-elements" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Lexical Elements</a><a href="#identifiers" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Identifiers</a><a href="#literals" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Literals</a><a href="#comments" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Comments</a><a href="#statements" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Statements</a><a href="#fact-insertion-" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Fact Insertion (+)</a><a href="#fact-deletion-" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Fact Deletion (-)</a><a href="#persistent-rules-head-body" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Persistent Rules (+head &lt;- body)</a><a href="#session-rules-no-prefix" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Session Rules (no + prefix)</a><a href="#queries-" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Queries (?)</a><a href="#schema-declarations" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Schema Declarations</a><a href="#expressions" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Expressions</a><a href="#arithmetic" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Arithmetic</a><a href="#comparison" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Comparison</a><a href="#built-in-functions" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Built-in Functions</a><a href="#aggregations" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Aggregations</a><a href="#syntax" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Syntax</a><a href="#aggregate-functions" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Aggregate Functions</a><a href="#examples" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Examples</a><a href="#negation" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Negation</a><a href="#syntax" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Syntax</a><a href="#rules" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Rules</a><a href="#examples" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Examples</a><a href="#invalid-unsafe" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Invalid (Unsafe)</a><a href="#meta-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Meta Commands</a><a href="#knowledge-graph-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Knowledge Graph Commands</a><a href="#relation-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Relation Commands</a><a href="#rule-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Rule Commands</a><a href="#session-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Session Commands</a><a href="#file-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">File Commands</a><a href="#index-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Index Commands</a><a href="#user-auth-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">User &amp; Auth Commands</a><a href="#system-commands" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">System Commands</a><a href="#recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Recursion</a><a href="#basic-pattern" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Basic Pattern</a><a href="#transitive-closure" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Transitive Closure</a><a href="#mutual-recursion" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Mutual Recursion</a><a href="#restrictions" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Restrictions</a><a href="#complete-examples" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Complete Examples</a><a href="#social-network" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Social Network</a><a href="#graph-analysis" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Graph Analysis</a><a href="#bill-of-materials" class="block text-xs py-0.5 transition-colors hover:text-foreground pl-3 text-muted-foreground">Bill of Materials</a><a href="#reserved-words" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">Reserved Words</a><a href="#file-format" class="block text-xs py-0.5 transition-colors hover:text-foreground text-muted-foreground">File Format</a></nav></div></div></div></div></div></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-bd6546b43ab2ecbf.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1942,[\"177\",\"static/chunks/app/layout-7e9963bf811be36b.js\"],\"ThemeProvider\"]\n3:I[7121,[],\"\"]\n4:I[4581,[],\"\"]\n6:I[484,[],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[484,[],\"ViewportBoundary\"]\nb:I[484,[],\"MetadataBoundary\"]\nd:I[7123,[],\"\"]\n:HL[\"/_next/static/media/4cf2300e9c8272f7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4bd7a24b7976d4e6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"05bjYGyiAumoEMBrfWHih\",\"c\":[\"\",\"docs\",\"reference\",\"syntax\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"reference/syntax\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4bd7a24b7976d4e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_188709 __variable_9a8899 font-sans antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[8428,[\"758\",\"static/chunks/758-3cb69ce377cde046.js\",\"121\",\"static/chunks/121-aece4f809b101dc1.js\",\"502\",\"static/chunks/502-e809071f8789437b.js\",\"689\",\"static/chunks/689-4fcf9680fdc90283.js\",\"870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-004ec69e3c86920a.js\"],\"DocsPageClient\"]\nf:T2ee9,"])</script><script>self.__next_f.push([1,"# Syntax Reference\n\nComplete syntax reference for InputLayer's query language.\n\n## Grammar Overview\n\n```\nprogram     ::= statement*\nstatement   ::= fact | rule | query | meta_command | schema_decl\n\nfact        ::= '+' atom\n              | '+' relation '[' tuple_list ']'\n              | '-' atom\n\nrule        ::= '+' atom '\u003c-' body           // Persistent rule\n              | atom '\u003c-' body               // Session rule\n\nquery       ::= '?' body\n\nbody        ::= goal (',' goal)*\ngoal        ::= atom | constraint | negated_atom\n\natom        ::= relation '(' term_list ')'\nnegated_atom::= '!' atom\n\nterm        ::= variable | constant | expression\nterm_list   ::= term (',' term)*\n\nconstraint  ::= term op term\nop          ::= '=' | '!=' | '\u003c' | '\u003c=' | '\u003e' | '\u003e='\n```\n\n## Lexical Elements\n\n### Identifiers\n\n| Type | Pattern | Examples |\n|------|---------|----------|\n| Relation | `[a-z][a-z0-9_]*` | `edge`, `my_relation`, `path2` |\n| Variable | `[A-Z][a-zA-Z0-9_]*` | `X`, `Name`, `PersonId` |\n| Placeholder | `_` | Matches any value, discarded |\n\n### Literals\n\n#### Integers\n```datalog\n42        // Decimal\n-17       // Negative\n0         // Zero\n```\n\n#### Floats\n```datalog\n3.14      // Decimal float\n-0.5      // Negative float\n1.0e10    // Scientific notation\n```\n\n#### Strings\n```datalog\n\"hello\"           // Basic string\n\"hello world\"     // With spaces\n\"line1\\nline2\"    // Escape sequences\n\"say \\\"hi\\\"\"      // Escaped quotes\n```\n\n**Escape sequences:**\n| Sequence | Meaning |\n|----------|---------|\n| `\\n` | Newline |\n| `\\t` | Tab |\n| `\\\\` | Backslash |\n| `\\\"` | Quote |\n\n#### Vectors\n```datalog\n[1.0, 2.0, 3.0]           // Float vector\n[0.1, 0.2, 0.3, 0.4]      // Embedding\n```\n\n### Comments\n\n```datalog\n// Single line comment\n\n/* Multi-line\n   block comment */\n\n+edge(1, 2)  // Inline comment\n```\n\n## Statements\n\n### Fact Insertion (`+`)\n\nInsert base data into relations.\n\n**Single fact:**\n```datalog\n+edge(1, 2)\n+person(\"alice\", 30)\n+location(\"NYC\", 40.7, -74.0)\n```\n\n**Bulk insert:**\n```datalog\n+edge[(1, 2), (2, 3), (3, 4), (4, 5)]\n+person[(\"alice\", 30), (\"bob\", 25), (\"carol\", 35)]\n```\n\n### Fact Deletion (`-`)\n\nRemove base data from relations.\n\n**Single fact:**\n```datalog\n-edge(1, 2)\n```\n\n**Conditional delete (based on another relation):**\n```datalog\n// Delete all edges where source node is in the 'banned' relation\n-edge(X, Y) \u003c- banned(X)\n\n// Delete all edges where X is greater than 5\n-edge(X, Y) \u003c- edge(X, Y), X \u003e 5\n\n// Delete edges that form triangles\n-edge(X, Y) \u003c- edge(X, Y), edge(Y, Z), edge(Z, X)\n```\n\n**Note:** Conditional delete finds all tuples matching the condition and removes them from the target relation. The target relation is automatically included in the query body to bind all head variables.\n\n### Persistent Rules (`+head \u003c- body`)\n\nDefine derived relations that persist across sessions.\n\n```datalog\n// Simple derivation\n+adult(Name, Age) \u003c- person(Name, Age), Age \u003e= 18\n\n// Join\n+works_in(Name, Building) \u003c-\n  employee(Name, Dept),\n  department(Dept, Building)\n\n// Recursive\n+path(X, Y) \u003c- edge(X, Y)\n+path(X, Z) \u003c- path(X, Y), edge(Y, Z)\n\n// With negation\n+orphan(X) \u003c- person(X), !parent(_, X)\n\n// With aggregation\n+dept_size(Dept, count\u003cEmp\u003e) \u003c- employee(Emp, Dept)\n```\n\n### Session Rules (no `+` prefix)\n\nTransient rules that exist only for the current session.\n\n```datalog\n// Not persisted\ntemp(X, Y) \u003c- edge(X, Y), X \u003c Y\ndebug(X) \u003c- some_complex_condition(X)\n```\n\n### Queries (`?`)\n\nAsk questions about the data.\n\n```datalog\n// Simple query\n? edge(X, Y)\n\n// With constants\n? edge(1, X)\n\n// With constraints\n? person(Name, Age), Age \u003e 25\n\n// Join query\n? person(Id, Name, _, _), purchase(Id, Item, _)\n```\n\n### Schema Declarations\n\nDefine typed schemas for relations.\n\n```datalog\n// Basic schema\n+employee(id: int, name: string, dept: string)\n\n// All types\n+example(\n  a: int,\n  b: float,\n  c: string,\n  d: vector\n)\n```\n\n**Supported types:**\n| Type | Description | Example Values |\n|------|-------------|----------------|\n| `int` | 64-bit integer | `42`, `-17`, `0` |\n| `float` | 64-bit float | `3.14`, `-0.5` |\n| `string` | UTF-8 string | `\"hello\"`, `\"world\"` |\n| `bool` | Boolean | `true`, `false` |\n| `timestamp` | Unix timestamp (ms) | Aliases: `time`, `datetime` |\n| `vector` | Float array | `[0.1, 0.2, 0.3]` |\n\n## Expressions\n\n### Arithmetic\n\n```datalog\n+computed(X, Y) \u003c- input(A, B), X = A + B, Y = A * B\n```\n\n| Operator | Description |\n|----------|-------------|\n| `+` | Addition |\n| `-` | Subtraction |\n| `*` | Multiplication |\n| `/` | Division |\n| `%` | Modulo |\n\n### Comparison\n\n```datalog\n? person(Name, Age), Age \u003e= 18, Age \u003c 65\n```\n\n| Operator | Description |\n|----------|-------------|\n| `=` | Equal |\n| `!=` | Not equal |\n| `\u003c` | Less than |\n| `\u003c=` | Less or equal |\n| `\u003e` | Greater than |\n| `\u003e=` | Greater or equal |\n\n### Built-in Functions\n\n**Vector functions:**\n\nInputLayer provides built-in vector distance and similarity functions:\n\n```datalog\n// Compute cosine similarity between embeddings\n? embedding(Id1, V1), embedding(Id2, V2), Id1 \u003c Id2,\n   Sim = cosine(V1, V2), Sim \u003e 0.9\n\n// Compute Euclidean distance between points\n? point(Id1, V1), point(Id2, V2), Id1 \u003c Id2,\n   Dist = euclidean(V1, V2), Dist \u003c 1.0\n```\n\n| Function | Description |\n|----------|-------------|\n| `euclidean(v1, v2)` | Euclidean distance |\n| `cosine(v1, v2)` | Cosine similarity |\n| `dot(v1, v2)` | Dot product |\n| `manhattan(v1, v2)` | Manhattan distance |\n\nVector functions work in both query bodies and rule heads (via computed head variables). See [functions](functions) for the complete list (55 functions including vector, temporal, math, string, LSH, and quantization).\n\n## Aggregations\n\nCompute aggregate values over groups.\n\n### Syntax\n\n```datalog\n+result(GroupBy1, GroupBy2, agg\u003cAggColumn\u003e) \u003c-\n  source(GroupBy1, GroupBy2, AggColumn, _)\n```\n\nVariables in the head that are not aggregated become group-by columns.\n\n### Aggregate Functions\n\n| Function | Description | Example |\n|----------|-------------|---------|\n| `count\u003cX\u003e` | Count rows | `count\u003cId\u003e` |\n| `sum\u003cX\u003e` | Sum values | `sum\u003cAmount\u003e` |\n| `min\u003cX\u003e` | Minimum | `min\u003cAge\u003e` |\n| `max\u003cX\u003e` | Maximum | `max\u003cScore\u003e` |\n| `avg\u003cX\u003e` | Average | `avg\u003cSalary\u003e` |\n\n### Examples\n\n```datalog\n// Count per group\n+city_count(City, count\u003cId\u003e) \u003c- person(Id, _, _, City)\n\n// Sum\n+total_sales(Product, sum\u003cAmount\u003e) \u003c- sale(_, Product, Amount)\n\n// Multiple aggregates (separate rules)\n+stats_min(min\u003cAge\u003e) \u003c- person(_, _, Age, _)\n+stats_max(max\u003cAge\u003e) \u003c- person(_, _, Age, _)\n\n// Global aggregate (no group-by)\n+total(sum\u003cAmount\u003e) \u003c- purchase(_, _, Amount)\n```\n\n## Negation\n\nExpress \"does not exist\" conditions.\n\n### Syntax\n\n```datalog\n!atom(args)     // Negated atom\n```\n\n### Rules\n\n1. **Safety**: Variables in negation must appear positively elsewhere\n2. **Stratification**: No circular dependencies through negation\n\n### Examples\n\n```datalog\n// People without purchases\n+non_buyer(Id, Name) \u003c-\n  person(Id, Name, _, _),\n  !purchase(Id, _, _)\n\n// Nodes with no outgoing edges\n+sink(X) \u003c- node(X), !edge(X, _)\n\n// Set difference\n+only_in_a(X) \u003c- a(X), !b(X)\n```\n\n### Invalid (Unsafe)\n\n```datalog\n// WRONG - X only appears in negation\n+bad(X) \u003c- !some_rel(X)\n\n// CORRECT - X appears positively\n+good(X) \u003c- domain(X), !some_rel(X)\n```\n\n## Meta Commands\n\nCommands that control the REPL environment.\n\n### Knowledge Graph Commands\n\n```datalog\n.kg                     // Show current knowledge graph\n.kg list                // List all knowledge graphs\n.kg create \u003cname\u003e       // Create knowledge graph\n.kg use \u003cname\u003e          // Switch to knowledge graph\n.kg drop \u003cname\u003e         // Delete knowledge graph\n```\n\n### Relation Commands\n\n```datalog\n.rel                    // List relations with data\n.rel \u003cname\u003e             // Show schema and sample data\n.rel drop \u003cname\u003e        // Drop a relation and its data\n```\n\n### Rule Commands\n\n```datalog\n.rule                   // List all rules\n.rule \u003cname\u003e            // Query a rule\n.rule def \u003cname\u003e        // Show rule definition\n.rule drop \u003cname\u003e       // Delete all clauses of a rule\n.rule remove \u003cname\u003e \u003cn\u003e // Remove clause #n (1-based)\n.rule clear \u003cname\u003e      // Clear for re-registration\n.rule edit \u003cname\u003e \u003cn\u003e \u003cclause\u003e  // Edit clause\n```\n\n### Session Commands\n\n```datalog\n.session                // List session rules\n.session clear          // Clear all session rules\n.session drop \u003cn\u003e       // Remove session rule #n\n```\n\n### File Commands\n\n```datalog\n.load \u003cfile\u003e            // Execute a .idl file\n```\n\n### Index Commands\n\n```datalog\n.index                  // List all indexes\n.index list             // List all indexes (explicit)\n.index create \u003cname\u003e on \u003crelation\u003e(\u003ccolumn\u003e) [options]\n.index drop \u003cname\u003e      // Drop an index\n.index stats \u003cname\u003e     // Show index statistics\n.index rebuild \u003cname\u003e   // Rebuild an index\n```\n\n### User \u0026 Auth Commands\n\n```datalog\n.user list              // List all users\n.user create \u003cname\u003e \u003cpassword\u003e \u003crole\u003e  // Create user\n.user drop \u003cname\u003e       // Delete user\n.user password \u003cname\u003e \u003cpassword\u003e       // Change password\n.user role \u003cname\u003e \u003crole\u003e               // Change role\n.apikey create \u003clabel\u003e  // Create API key\n.apikey list            // List API keys\n.apikey revoke \u003clabel\u003e  // Revoke API key\n.kg acl list [\u003ckg\u003e]     // List ACLs\n.kg acl grant \u003ckg\u003e \u003cuser\u003e \u003crole\u003e  // Grant access\n.kg acl revoke \u003ckg\u003e \u003cuser\u003e        // Revoke access\n```\n\n### System Commands\n\n```datalog\n.status                 // System status\n.compact                // Compact storage\n.explain \u003cquery\u003e        // Show query plan\n.help                   // Help message\n.quit                   // Exit REPL\n.exit                   // Exit REPL (alias)\n```\n\n## Recursion\n\n### Basic Pattern\n\n```datalog\n// Base case\n+derived(X, Y) \u003c- base(X, Y)\n\n// Recursive case\n+derived(X, Z) \u003c- derived(X, Y), base(Y, Z)\n```\n\n### Transitive Closure\n\n```datalog\n+reachable(X, Y) \u003c- edge(X, Y)\n+reachable(X, Z) \u003c- reachable(X, Y), edge(Y, Z)\n```\n\n### Mutual Recursion\n\n```datalog\n+odd(X) \u003c- edge(Start, X), start(Start)\n+odd(X) \u003c- even(Y), edge(Y, X)\n+even(X) \u003c- odd(Y), edge(Y, X)\n```\n\n### Restrictions\n\n- Negation through recursion is not allowed (non-stratifiable)\n- Must have a base case that terminates\n\n## Complete Examples\n\n### Social Network\n\n```datalog\n// Schema\n+person(id: int, name: string, age: int)\n+follows(follower: int, followed: int)\n\n// Data\n+person[(1, \"alice\", 30), (2, \"bob\", 25), (3, \"carol\", 35)]\n+follows[(1, 2), (2, 3), (1, 3)]\n\n// Rules\n+mutual_follow(A, B) \u003c-\n  follows(A, B),\n  follows(B, A),\n  A \u003c B\n\n+influencer(Id, count\u003cFollower\u003e) \u003c-\n  follows(Follower, Id)\n\n// Query\n? influencer(Id, Count), Count \u003e 10\n```\n\n### Graph Analysis\n\n```datalog\n// Transitive closure\n+path(X, Y) \u003c- edge(X, Y)\n+path(X, Z) \u003c- path(X, Y), edge(Y, Z)\n\n// Cycle detection\n+in_cycle(X) \u003c- path(X, X)\n\n// Connected components (undirected)\n+bidir(X, Y) \u003c- edge(X, Y)\n+bidir(X, Y) \u003c- edge(Y, X)\n+connected(X, Y) \u003c- bidir(X, Y)\n+connected(X, Z) \u003c- connected(X, Y), bidir(Y, Z)\n\n// Sink nodes (no outgoing)\n+sink(X) \u003c- node(X), !edge(X, _)\n\n// Source nodes (no incoming)\n+source(X) \u003c- node(X), !edge(_, X)\n```\n\n### Bill of Materials\n\n```datalog\n// Part hierarchy\n+contains(assembly: int, part: int, qty: int)\n\n// All parts needed (recursive)\n+requires(Asm, Part) \u003c- contains(Asm, Part, _)\n+requires(Asm, Part) \u003c-\n  contains(Asm, Sub, _),\n  requires(Sub, Part)\n\n// Total quantity calculation\n+total_qty(Asm, Part, sum\u003cQty\u003e) \u003c-\n  contains(Asm, Part, Qty)\n```\n\n## Reserved Words\n\nThe following are reserved and cannot be used as relation names:\n\n```\ntrue, false\ncount, sum, min, max, avg\nint, float, string, vector\n```\n\n## File Format\n\nInputLayer files use the `.idl` extension and contain valid InputLayer statements:\n\n```datalog\n// my_program.idl\n\n// Schema declarations\n+node(id: int, label: string)\n+edge(src: int, dst: int, weight: float)\n\n// Data\n+node[(1, \"a\"), (2, \"b\"), (3, \"c\")]\n+edge[(1, 2, 1.0), (2, 3, 2.0)]\n\n// Rules\n+path(X, Y, W) \u003c- edge(X, Y, W)\n+path(X, Z, W) \u003c- path(X, Y, W1), edge(Y, Z, W2), W = W1 + W2\n```\n\nLoad with:\n```datalog\n.load my_program.idl\n```"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Le\",null,{\"page\":{\"title\":\"Syntax Reference\",\"content\":\"$f\",\"toc\":[{\"level\":2,\"text\":\"Grammar Overview\",\"id\":\"grammar-overview\"},{\"level\":2,\"text\":\"Lexical Elements\",\"id\":\"lexical-elements\"},{\"level\":3,\"text\":\"Identifiers\",\"id\":\"identifiers\"},{\"level\":3,\"text\":\"Literals\",\"id\":\"literals\"},{\"level\":3,\"text\":\"Comments\",\"id\":\"comments\"},{\"level\":2,\"text\":\"Statements\",\"id\":\"statements\"},{\"level\":3,\"text\":\"Fact Insertion (+)\",\"id\":\"fact-insertion-\"},{\"level\":3,\"text\":\"Fact Deletion (-)\",\"id\":\"fact-deletion-\"},{\"level\":3,\"text\":\"Persistent Rules (+head \u003c- body)\",\"id\":\"persistent-rules-head-body\"},{\"level\":3,\"text\":\"Session Rules (no + prefix)\",\"id\":\"session-rules-no-prefix\"},{\"level\":3,\"text\":\"Queries (?)\",\"id\":\"queries-\"},{\"level\":3,\"text\":\"Schema Declarations\",\"id\":\"schema-declarations\"},{\"level\":2,\"text\":\"Expressions\",\"id\":\"expressions\"},{\"level\":3,\"text\":\"Arithmetic\",\"id\":\"arithmetic\"},{\"level\":3,\"text\":\"Comparison\",\"id\":\"comparison\"},{\"level\":3,\"text\":\"Built-in Functions\",\"id\":\"built-in-functions\"},{\"level\":2,\"text\":\"Aggregations\",\"id\":\"aggregations\"},{\"level\":3,\"text\":\"Syntax\",\"id\":\"syntax\"},{\"level\":3,\"text\":\"Aggregate Functions\",\"id\":\"aggregate-functions\"},{\"level\":3,\"text\":\"Examples\",\"id\":\"examples\"},{\"level\":2,\"text\":\"Negation\",\"id\":\"negation\"},{\"level\":3,\"text\":\"Syntax\",\"id\":\"syntax\"},{\"level\":3,\"text\":\"Rules\",\"id\":\"rules\"},{\"level\":3,\"text\":\"Examples\",\"id\":\"examples\"},{\"level\":3,\"text\":\"Invalid (Unsafe)\",\"id\":\"invalid-unsafe\"},{\"level\":2,\"text\":\"Meta Commands\",\"id\":\"meta-commands\"},{\"level\":3,\"text\":\"Knowledge Graph Commands\",\"id\":\"knowledge-graph-commands\"},{\"level\":3,\"text\":\"Relation Commands\",\"id\":\"relation-commands\"},{\"level\":3,\"text\":\"Rule Commands\",\"id\":\"rule-commands\"},{\"level\":3,\"text\":\"Session Commands\",\"id\":\"session-commands\"},{\"level\":3,\"text\":\"File Commands\",\"id\":\"file-commands\"},{\"level\":3,\"text\":\"Index Commands\",\"id\":\"index-commands\"},{\"level\":3,\"text\":\"User \u0026 Auth Commands\",\"id\":\"user-auth-commands\"},{\"level\":3,\"text\":\"System Commands\",\"id\":\"system-commands\"},{\"level\":2,\"text\":\"Recursion\",\"id\":\"recursion\"},{\"level\":3,\"text\":\"Basic Pattern\",\"id\":\"basic-pattern\"},{\"level\":3,\"text\":\"Transitive Closure\",\"id\":\"transitive-closure\"},{\"level\":3,\"text\":\"Mutual Recursion\",\"id\":\"mutual-recursion\"},{\"level\":3,\"text\":\"Restrictions\",\"id\":\"restrictions\"},{\"level\":2,\"text\":\"Complete Examples\",\"id\":\"complete-examples\"},{\"level\":3,\"text\":\"Social Network\",\"id\":\"social-network\"},{\"level\":3,\"text\":\"Graph Analysis\",\"id\":\"graph-analysis\"},{\"level\":3,\"text\":\"Bill of Materials\",\"id\":\"bill-of-materials\"},{\"level\":2,\"text\":\"Reserved Words\",\"id\":\"reserved-words\"},{\"level\":2,\"text\":\"File Format\",\"id\":\"file-format\"}]},\"slugKey\":\"reference/syntax\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[6869,[],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"InputLayer - A symbolic reasoning engine for AI agents\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Store facts, define rules, and derive everything that logically follows. Vector search, graph traversal, and incremental computation in one system.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/icon.svg\"}],[\"$\",\"$L10\",\"3\",{}]]\n8:null\n"])</script></body></html>